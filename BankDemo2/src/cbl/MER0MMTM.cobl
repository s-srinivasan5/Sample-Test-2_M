000002* ***
000004* CR_TAG_BEGIN
000006* © Copyright 1981-2019 Micro Focus or one of its affiliates.
000008* The only warranties for products and services of Micro Focus
000010* and its affiliates and licensors (“Micro Focus”) are set 
000012* forth
000014* in the express warranty statements accompanying such products
000016* and services. Nothing herein should be construed as
000018* constituting an additional warranty. Micro Focus shall not be
000020* liable for technical or editorial errors or omissions
000022* contained herein. The information contained herein is subject
000024* to change without notice.
000026*
000028* Contains Confidential Information. Except as specifically
000030* indicated otherwise, a valid license is required for
000032* possession, use or copying. Consistent with FAR 12.211 and
000034* 12.212, Commercial Computer Software, Computer Software
000036* Documentation, and Technical Data for Commercial Items are
000038* licensed to the U.S. Government under vendor's standard
000040* commercial license.
000042* CR_TAG_END
000044* ***
000046***--------------------------------------------------------------*
000048*** Revision History                                             *
000050***--------------------------------------------------------------*
000052***------------------------------------------------------------
000054***
000056*** Program name: MER0MMTM
000058***
000060*** Description: Micro Focus Component Generator
000062***              MQSeries Message Trigger Monitor
000064***
000066* ***
000068* CR_TAG_BEGIN
000070* © Copyright 1981-2019 Micro Focus or one of its affiliates.
000072* The only warranties for products and services of Micro Focus
000074* and its affiliates and licensors (“Micro Focus”) are set 
000076* forth
000078* in the express warranty statements accompanying such products
000080* and services. Nothing herein should be construed as
000082* constituting an additional warranty. Micro Focus shall not be
000084* liable for technical or editorial errors or omissions
000086* contained herein. The information contained herein is subject
000088* to change without notice.
000090*
000092* Contains Confidential Information. Except as specifically
000094* indicated otherwise, a valid license is required for
000096* possession, use or copying. Consistent with FAR 12.211 and
000098* 12.212, Commercial Computer Software, Computer Software
000100* Documentation, and Technical Data for Commercial Items are
000102* licensed to the U.S. Government under vendor's standard
000104* commercial license.
000106* CR_TAG_END
000108* ***
000110***---------------------------------------------------------------
000112***
000114*** Function:
000116***
000118***
000120***   MER0MMTM is the SOA Express MQSeries Trigger
000122***   Monitor.  It retrieves the application queue from the
000124***   MQTM structure.  It then:
000126***
000128***      -- opens the queue under browse
000130***
000132***      For each message on the queue:
000134***
000136***      -- gets a message non destructively
000138***
000140***      -- STARTS a middleware interface instance (passing
000142***         the application queue name in start data)
000144***
000146***      The queue is closed after all messages on the queue
000148***      have been browsed
000150***
000152***      *** DEPLOYMENT NOTE ***
000154***
000156***         This program specifies a wait interval of 30000
000158***         milliseconds (30 seconds)
000160***
000162***         Users may want to tune this parameter as needed.
000164***         Please refer to the comment block just prior
000166***         to the get-message section for more information
000168***         on tuning this parameter.
000170***
000172***    Program logic:
000174***      Retrieve  the input queue name from start data
000176***      MQOPEN queue for BROWSE
000178***      MQGET first message
000180***      while no MQI failures or not at end of queue
000182***        For Large > 32 non-screen transactions
000184***          . Start transaction MQ01 passing it the NWIF
000186***            structure
000188***        For screen and < 32k non-screen transactions
000190***          . START transaction MQMW passing it the MQTM
000192***            structure
000194***        MQGET next message
000196***      MQCLOSE the input queue
000198***
000200***   Diagnostic Information:
000202***
000204***     Diagnostic information is written to TS queue
000206***     CEBR concatenated with the transaction id (3)
000208***     if the shipped transaction code (MMTM) is used
000210***     in the event of a MQSeries API call failure or
000212***     failure to start transaction MQMW
000214***
000216***---------------------------------------------------------------
000218 IDENTIFICATION DIVISION.
000220 Program-id.                           MER0MMTM.
000222 ENVIRONMENT DIVISION.
000224 DATA DIVISION.
000226
000228 WORKING-STORAGE SECTION.
000230 01  ws-mmtm-trace-misc.
000232     05 mmtm-trace-level               pic 9(01) value zero.
000234     05 mmtm-trace-queue-name          pic x(08) value spaces.
000236
000238 01  ws-static-fields.
000240     05 nwif-strucid                   pic x(04) value 'NWIF'.
000242     05 this-version                   pic 9(04) value 1.
000244     05 this-release                   pic 9(04) value 1.
000246     05 this-program                   pic x(08) value 'MER0MMTM'.
000248     05 default-traceq                 pic x(08) value 'CEBRMMTM'.
000250     05 wait-interval                  pic s9(08) comp value 
000252         30000.
000254     05 commax                         pic x(01) value ','.
000256     05 hex-32                         pic x(01) value x'32'.
000258     05 hex-f2                         pic x(01) value x'f2'.
000260     05 left-paren                     pic x(01) value '('.
000262     05 uppercase-nnn                  pic x(03) value 'NNN'.
000264     05 uppercase-pnn                  pic x(03) value 'PNN'.
000266     05 uppercase-bnn                  pic x(03) value 'BNN'.
000268     05 uppercase-ann                  pic x(03) value 'ANN'.
000270     05 uppercase-zzz                  pic x(03) value 'ZZZ'.
000272     05 right-paren                    pic x(01) value ')'.
000274     05 seventy-five                   pic 9(02) value 75.
000276     05 user-exit-program              pic x(08) value 'MER0MEXT'.
000278     05 uppercase-y                    pic x(01) value 'Y'.
000280     05 invalid-msg-1                  pic x(80)
000282        value 'Invalid message encountered and shown on next line'
000284            .
000286     05 verify-bypassed-msg            pic x(21)
000288        value 'CICS Verify bypassed'.
000290 01  ws-mmtm-abends.
000292     05 bad-dfhcommarea-length         pic x(04)
000294        value '9101'.
000296     05 bad-nwih-header                pic x(04)
000298        value '9102'.
000300     05 mqclose-failure                pic x(04)
000302        value '9120'.
000304     05 mqget-failure                  pic x(04)
000306        value '9121'.
000308     05 mqopen-failure                 pic x(04)
000310        value '9122'.
000312     05 mqput1-failure                 pic x(04)
000314        value '9123'.
000316 01  ws-misc-fields.
000318     05 pntr-p                         usage pointer value null.
000320     05 pntr-x                         redefines
000322        pntr-p                         pic x(04).
000324     05 pntr-9                         redefines
000326        pntr-p                         pic s9(08) comp.
000328     05 basepntr-p                     usage pointer value null.
000330     05 basepntr-x                     redefines
000332        basepntr-p                     pic x(04).
000334     05 basepntr-9                     redefines
000336        basepntr-p                     pic s9(08) comp.
000338     05 last-request-type-ind          pic 9(01) value zero.
000340        88 first-request-88              value zero.
000342        88 last-request-was-classic-88   value 1.
000344        88 last-request-was-large-88     value 2.
000346     05 num1                           pic s9(08) comp value 0.
000348     05 appl-msg-len-num               pic 9(10) value 0.
000350     05 pw-save-area.
000352        15 pw-from-msg-hdr             pic x(16) value spaces.
000354        15 pw-from-req-hdr             pic x(08) value spaces.
000356        15 pw-start-pos                pic s9(04) value 0.
000358        15 pw-len                      pic s9(04) value 0.
000360
000362 01  ws-footprint                pic x(100)
000364      value '$mf_footprint$: MER0MMTM ED-STRB        2.003.0024   
000366-         '     2019-02-13 18:51:21 950890    '.
000368
000370***--------------------------------------------------------------*
000372*** Compilation:                                                 *
000374***                                                              *
000376***  Compiled on:      20 APR 22 23.54.04                        *
000378***  Micro Focus Generator: GA 4 0                               *
000380***                                                              *
000382*** ebiz source modules                                          *
000384***                                                              *
000386*** Rulefile(s):                                                 *
000388***  mer0mmtm.igl         2019-02-13 18:51:21   950890           *
000390***  mersetup.igl         2015-12-08 13:52:44   727343           *
000392***  merfoot.igl          2019-02-08 13:14:37   949994           *
000394***  release.igl          2019-02-12 16:12:34   950598           *
000396***  merbrule.igl         2019-02-08 13:14:37   949994           *
000398***  merbipc.igl          2019-02-08 13:14:37   949994           *
000400***  merntrac.igl         2018-12-09 18:44:39   727692           *
000402***  mer0macs.igl         2019-02-08 13:14:37   949994           *
000404***  mer0exit.igl         2019-02-08 13:14:37   949994           *
000406***                                                              *
000408*** Cntlfile(s):                                                 *
000410***                                                              *
000412*** Project Symbol File(s):                                      *
000414***                                                              *
000416*** Program Symbol File(s):                                      *
000418***                                                              *
000420*** Map Symbol File(s):                                          *
000422***                                                              *
000424***--------------------------------------------------------------*
000426
000428 01  ebiz-mfg-release                  pic x(30)
000430     value 'Micro Focus Generator: GA 4 0'.
000432
000434 01  ebiz-source-modules.
000436     02  filler                        pic x(12)
000438     value 'Rulefile(s):'.
000440     02  filler                        pic x(41)
000442     value '  mer0mmtm.igl 2019-02-13 18:51:21 950890'.
000444     02  filler                        pic x(41)
000446     value '  mersetup.igl 2015-12-08 13:52:44 727343'.
000448     02  filler                        pic x(41)
000450     value '  merfoot.igl  2019-02-08 13:14:37 949994'.
000452     02  filler                        pic x(41)
000454     value '  release.igl  2019-02-12 16:12:34 950598'.
000456     02  filler                        pic x(41)
000458     value '  merbrule.igl 2019-02-08 13:14:37 949994'.
000460     02  filler                        pic x(41)
000462     value '  merbipc.igl  2019-02-08 13:14:37 949994'.
000464     02  filler                        pic x(41)
000466     value '  merntrac.igl 2018-12-09 18:44:39 727692'.
000468     02  filler                        pic x(41)
000470     value '  mer0macs.igl 2019-02-08 13:14:37 949994'.
000472     02  filler                        pic x(41)
000474     value '  mer0exit.igl 2019-02-08 13:14:37 949994'.
000476     02  filler                        pic x(12)
000478     value 'Cntlfile(s):'.
000480
000482 01  ws-msg-offsets-c.
000484     05 msg-hdr-offset-i               pic s9(08) comp
000486        value 1.
000488     05 fmt-hdr-offset-i               pic s9(08) comp
000490        value 213.
000492     05 ebiz-req-hdr-offset-i          pic s9(08) comp
000494        value 245.
000496     05 ebiz-req-data-offset-i         pic s9(08) comp
000498        value 271.
000500     05 msg-hdr-offset-o               pic s9(08) comp
000502        value 1.
000504     05 fmt-hdr-offset-o               pic s9(08) comp
000506        value 213.
000508     05 ebiz-rep-hdr-offset-o          pic s9(08) comp
000510        value 245.
000512     05 ebiz-rep-data-offset-o         pic s9(08) comp
000514        value 373.
000516 01  ws-msg-offsets-l.
000518     05 msg-hdr-offset-i               pic s9(08) comp
000520        value 1.
000522     05 msg-hdr-ext-offset-i           pic s9(08) comp
000524        value 213.
000526     05 fmt-hdr-offset-i               pic s9(08) comp
000528        value 513.
000530     05 ebiz-req-hdr-offset-i          pic s9(08) comp
000532        value 550.
000534     05 ebiz-req-data-offset-i         pic s9(08) comp
000536        value 576.
000538     05 msg-hdr-offset-o               pic s9(08) comp
000540        value 1.
000542     05 fmt-hdr-offset-o               pic s9(08) comp
000544        value 213.
000546     05 ebiz-rep-hdr-offset-o          pic s9(08) comp
000548        value 250.
000550     05 ebiz-rep-data-offset-o         pic s9(08) comp
000552        value 378.
000554
000556
000558 01  ws-mf-ti-misc.
000560     05 ws-mf-ti-trace-cat             pic x(04).
000562     05 ws-mf-ti-para-tag              pic x(06) value 'para--'.
000564     05 ws-mf-ti-info-tag              pic x(06) value 'info--'.
000566     05 ws-mf-ti-step-tag              pic x(06) value 'step--'.
000568     05 ws-mf-ti-data-tag              pic x(06) value 'data--'.
000570     05 ws-mf-ti-getmain-flag          pic x(01).
000572        88 ws-mf-ti-getmain-done-88      value 't'.
000574        88 ws-mf-ti-getmain-not-done-88  value 'f'.
000576     05 ws-mf-ti-fld-zero              pic 9(01) value 0.
000578     05 ws-mf-ti-ascii-numeric         pic x(10)
000580        value x'30313233343536373839'.
000582     05 ws-mf-ti-ebcdic-numeric        pic x(10)
000584        value x'f0f1f2f3f4f5f6f7f8f9'.
000586     05 ws-mf-ti-eibresp-save          pic s9(08) comp.
000588     05 ws-mf-ti-eibresp2-save         pic s9(08) comp.
000590     05 ws-mf-ti-eibresp-disp          pic +9(08).
000592     05 ws-mf-ti-eibresp2-disp         pic +9(08).
000594     05 ws-mf-ti-length-1-disp         pic +9(08).
000596     05 ws-mf-ti-length-2-disp         pic +9(08).
000598     05 ws-mf-ti-length-3-disp         pic +9(08).
000600     05 ws-mf-ti-length-4-disp         pic +9(08).
000602     05 ws-mf-ti-n2-1-disp             pic 9(02).
000604     05 ws-mf-ti-n5-1-disp             pic +9(05).
000606     05 ws-mf-ti-n5-2-disp             pic +9(05).
000608     05 ws-mf-ti-n5-3-disp             pic +9(05).
000610     05 ws-mf-ti-n5-4-disp             pic +9(05).
000612     05 ws-ti-de-edit-status           pic x(26).
000614     05 ws-ti-scr-sub                  pic 9(04).
000616     05 ws-mf-ti-string-len            pic s9(04) comp.
000618     05 ws-mf-ti-comp4-disp            pic +9(05).
000620     05 ws-mf-ti-comp8-disp            pic +9(09).
000622     05 ws-mf-ti-pointer-temp          pointer.
000624     05 ws-mf-ti-pointer-disp redefines ws-mf-ti-pointer-temp
000626                                       pic 9(04).
000628     05 ws-mf-ti-setup-status          pic x(01) value 'F'.
000630       88 ws-mf-ti-setup-done-88         value 'T'.
000632     05 ws-mf-ti-ebcdic-values.
000634        10 ws-mf-ti-ebcdic-0           pic x(01) value x'f0'.
000636        10 ws-mf-ti-ebcdic-5           pic x(01) value x'f5'.
000638        10 ws-mf-ti-ebcdic-9           pic x(01) value x'f9'.
000640        10 ws-mf-ti-ebcdic-uc-n        pic x(01) value x'd5'.
000642        10 ws-mf-ti-ebcdic-uc-y        pic x(01) value x'e8'.
000644        10 ws-mf-ti-ebcdic-lc-n        pic x(01) value x'95'.
000646        10 ws-mf-ti-ebcdic-lc-y        pic x(01) value x'a8'.
000648     05 ws-mf-ti-ascii-values.
000650        10 ws-mf-ti-ascii-0            pic x(01) value x'30'.
000652        10 ws-mf-ti-ascii-5            pic x(01) value x'35'.
000654        10 ws-mf-ti-ascii-9            pic x(01) value x'39'.
000656        10 ws-mf-ti-ascii-uc-n         pic x(01) value x'4e'.
000658        10 ws-mf-ti-ascii-uc-y         pic x(01) value x'59'.
000660        10 ws-mf-ti-ascii-lc-n         pic x(01) value x'6e'.
000662        10 ws-mf-ti-ascii-lc-y         pic x(01) value x'79'.
000664     05 ws-mf-ti-info-lit              pic x(04) value 'info'.
000666     05 ws-mf-ti-erro-lit              pic x(04) value 'erro'.
000668 01  ws-mf-ti-verbose-mode             pic x(15).
000670 01  ws-mf-ti-hash-accum               pic z(9)9-.
000672 01  ws-mf-ti-hash-number              pic z(9)9-.
000674 01  ws-mf-ti-hash-sub                 pic zzz9.
000676
000678 01  ws-mf-ti-element-position         pic zzz9.
000680 01  ws-mf-ti-field-position           pic zzz9.
000682 01  ws-mf-ti-element-length           pic zzz9.
000684 01  ws-mf-ti-lengthx                  pic s9(04) comp.
000686 01  ws-mf-ti-handle1-disp             pic +9(08).
000688 01  ws-mf-ti-handle2-disp             pic +9(08).
000690 01  ws-mf-ti-num1-disp                pic +9(04).
000692 01  ws-mf-ti-num2-disp                pic +9(04).
000694 01  ws-mf-ti-num3-disp                pic +9(04).
000696 01  ws-mf-ti-num4-disp                pic +9(04).
000698 01  ws-mf-ti-verify-daysleft-x        pic +9(04).
000700
000702 01  ws-mf-ti-short-record.
000704     05  ws-mf-ti-short-trace-level    pic 9(01).
000706     05  ws-mf-ti-short-queue-name     pic X(16).
000708 01  ws-mf-ti-msg-nbr-tmp              pic 9(04) value zero.
000710 01  ws-mf-ti-record.
000712     05 ws-mf-ti-version.
000714        10 ws-mf-ti-major-version      pic 9(02) value zero.
000716        10 ws-mf-ti-minor-version      pic 9(02) value zero.
000718        10 ws-mf-ti-trace-level-x      pic x(01) value zero.
000720        10 ws-mf-ti-trace-level        redefines
000722           ws-mf-ti-trace-level-x      pic 9(01).
000724*    Allow future support of QNAME option where a
000726*    16 byte queue name can be specified
000728     05 ws-mf-ti-queue-name-long.
000730        10 ws-mf-ti-queue-name-short.
000732          15 ws-mf-ti-queue-name-1-4   pic x(04) value spaces.
000734          15 ws-mf-ti-queue-name-5-8   pic x(04) value spaces.
000736        10 ws-mf-ti-queue-name-9-16    pic x(08) value spaces.
000738     05 ws-mf-ti-ebiz-program          pic x(08) value spaces.
000740     05 ws-mf-ti-calling-program       pic x(08) value spaces.
000742     05 ws-mf-ti-trace-program         pic x(08) value spaces.
000744     05 ws-mf-ti-assign-values.
000746        10 ws-mf-ti-sysid              pic x(04) value spaces.
000748        10 ws-mf-ti-userid             pic x(08) value spaces.
000750     05 ws-mf-ti-eib-values.
000752        10 ws-mf-ti-eibtaskn           pic 9(09) value zero.
000754     05 ws-mf-ti-program-status        pic x(01) value spaces.
000756        88 ws-mf-ti-program-normal-88    value 'n'.
000758        88 ws-mf-ti-program-error-88     value 'e'.
000760        88 ws-mf-ti-program-abend-88     value 'a'.
000762     05 ws-mf-ti-msg-nbr               pic 9(04) value zero.
000764     05 ws-mf-ti-user-data-len         pic 9(08) value zero.
000766     05 ws-mf-ti-user-data-pntr        pointer.
000768     05 ws-mf-ti-return-values.
000770        10 ws-mf-ti-return-code        pic 9(04) value zero.
000772        10 ws-mf-ti-reason-code        pic 9(04) value zero.
000774     05 ws-mf-ti-abend-code            pic x(04) value spaces.
000776     05 ws-mf-reserved                 pic x(128) value spaces.
000778     05 ws-customer-reserved           pic x(128) value spaces.
000780
000782 01  ws-mf-ti-data-rec                 pic x(1000).
000784 01  ws-mf-ti-data-rec-r               redefines
000786     ws-mf-ti-data-rec.
000788     05 ws-mf-ti-data-rec-header-r     pic x(24).
000790     05 ws-mf-ti-data-rec-data-r       pic x(976).
000792
000794***--------------------------------------------------------------*
000796 01  ws-inspect-input-t.
000798     02  pic x(16) value x'000102030405060708090a0b0c0d0e0f'.
000800     02  pic x(16) value x'101112131415161718191a1b1c1d1e1f'.
000802     02  pic x(16) value x'202122232425262728292a2b2c2d2e2f'.
000804     02  pic x(16) value x'303132333435363738393a3b3c3d3e3f'.
000806     02  pic x(16) value x'404142434445464748494a4b4c4d4e4f'.
000808     02  pic x(16) value x'505152535455565758595a5b5c5d5e5f'.
000810     02  pic x(16) value x'606162636465666768696a6b6c6d6e6f'.
000812     02  pic x(16) value x'707172737475767778797a7b7c7d7e7f'.
000814     02  pic x(16) value x'808182838485868788898a8b8c8d8e8f'.
000816     02  pic x(16) value x'909192939495969798999a9b9c9d9e9f'.
000818     02  pic x(16) value x'a0a1a2a3a4a5a6a7a8a9aaabacadaeaf'.
000820     02  pic x(16) value x'b0b1b2b3b4b5b6b7b8b9babbbcbdbebf'.
000822     02  pic x(16) value x'c0c1c2c3c4c5c6c7c8c9cacbcccdcecf'.
000824     02  pic x(16) value x'd0d1d2d3d4d5d6d7d8d9dadbdcdddedf'.
000826     02  pic x(16) value x'e0e1e2e3e4e5e6e7e8e9eaebecedeeef'.
000828     02  pic x(16) value x'f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff'.
000830 01  ws-inspect-input redefines
000832     ws-inspect-input-t              pic x(256).
000834***--------------------------------------------------------------*
000836***  437 US Ansi/EBCDIC 1252/1140 Euro  to EBCDIC
000838***--------------------------------------------------------------*
000840 01  ws-inspect-to-ebcdic-t.
000842     02  pic x(16) value x'00010203372d2e2f1605250b0c0d0e0f'.
000844     02  pic x(16) value x'101112133c3d322618193f271c1d1e1f'.
000846     02  pic x(16) value x'405a7f7b5b6c507d4d5d5c4e6b604b61'.
000848     02  pic x(16) value x'f0f1f2f3f4f5f6f7f8f97a5e4c7e6e6f'.
000850     02  pic x(16) value x'7cc1c2c3c4c5c6c7c8c9d1d2d3d4d5d6'.
000852     02  pic x(16) value x'd7d8d9e2e3e4e5e6e7e8e9bae0bbb06d'.
000854     02  pic x(16) value x'79818283848586878889919293949596'.
000856     02  pic x(16) value x'979899a2a3a4a5a6a7a8a9c04fd0a107'.
000858     02  pic x(16) value x'9f2122232415061728292a2b2c090a1b'.
000860     02  pic x(16) value x'30311a333435360838393a3b04143eff'.
000862     02  pic x(16) value x'41aa4ab120b26ab5bdb49a8a5fcaafbc'.
000864     02  pic x(16) value x'908feafabea0b6b39dda9b8bb7b8b9ab'.
000866     02  pic x(16) value x'6465626663679e687471727378757677'.
000868     02  pic x(16) value x'ac69edeeebefecbf80fdfefbfcadae59'.
000870     02  pic x(16) value x'4445424643479c485451525358555657'.
000872     02  pic x(16) value x'8c49cdcecbcfcce170dddedbdc8d8edf'.
000874 01  ws-inspect-to-ebcdic redefines
000876     ws-inspect-to-ebcdic-t          pic x(256).
000878***--------------------------------------------------------------*
000880
000882*    *********************************************************
000884*    *
000886*    * ws-se-trace-ts-q (ebcdic value)
000888*    *     Name of ebiz specified trace queue
000890*    *
000892*    * ws-se-public-key (ASCII value)
000894*    *     Public key value
000896*    *
000898*    * ws-se-userid (ASCII value)
000900*    *     Userid passed up from client
000902*    *     Value returned from this module must be uppercase
000904*    *       EBCDIC
000906*    *
000908*    * ws-se-password (ASCII value)
000910*    *     Password passed up from client
000912*    *
000914*    * ws-ue-encryption-indicator (EBCDIC value)
000916*    *     Indicates the encryption status of ws-ue-userid
000918*    *                                        ws-ue-password
000920*    *                                        ws-ue-user-data
000922*    *
000924*    *     value 'N'   - None are encrypted
000926*    *     value 'P'   - The password is encrypted
000928*    *     value 'B'   - The userid and pasword are encrypted
000930*    *     value 'A'   - All are encrypted
000932*    *
000934*    * ws-se-processing-direction (EBDCIC value)
000936*    *     Indicates direction
000938*    *     value 'C'   - Client to host
000940*    *     value 'H'   - Host to client
000942*    * ws-se-return-code
000944*    *     Non-zero return-code returns control to client
000946*    *
000948*    * ws-se-abend-code
000950*    *     Abend code returned to client (EBCDIC value)
000952*    *
000954*    * ws-se-message
000956*    *     Status/error message returned to client (EBCDIC value)
000958*    *
000960*    *********************************************************
000962
000964 01  ws-se-record.
000966     03 ws-se-trace-ts-q         pic x(08).
000968     03 ws-se-mainframe-codepage pic x(04).
000970     03 ws-se-public-key         pic x(16).
000972     03 ws-se-userid-password.
000974        05 ws-se-userid          pic x(08).
000976        05 ws-se-password        pic x(08).
000978     03 ws-se-user-data-length   pic 9(05).
000980     03 ws-se-encryption-indicator.
000982        05 ws-se-portion-encrypted
000984                                 pic x(01).
000986           88 ws-se-none-encrypted-88
000988                                   value 'N'.
000990           88 ws-se-pass-encrypted-88
000992                                   value 'P'.
000994           88 ws-se-id-pass-encrypted-88
000996                                   value 'B'.
000998           88 ws-se-all-encrypted-88
001000                                   value 'A'.
001002     03 ws-se-processing-direction
001004                                 pic x(01).
001006        88 ws-se-client-to-host-88 value 'C'.
001008        88 ws-se-host-to-client-88 value 'H'.
001010     03 ws-se-return-code        pic 9(04).
001012     03 ws-se-abend-code         pic x(04).
001014     03 ws-se-message            pic x(80).
001016
001018 01  ws-cmqgmov-copybook.
001020     copy cmqgmov.
001022
001024 01  ws-cmqmdv-copybook.
001026     copy cmqmdv.
001028
001030 01  ws-cmqodv-copybook.
001032     copy cmqodv.
001034
001036 01  ws-cmqpmov-copybook.
001038     copy cmqpmov.
001040
001042 01  ws-cmqtml-copybook.
001044     copy cmqtml.
001046
001048 01  ws-cmqv-copybook.
001050     copy cmqv suppress.
001052
001054 01  ws-clif.
001056     03 clif.
001058        05  trace-levelx               pic x(01).
001060        05  trace-level                redefines
001062            trace-levelx               pic 9(01).
001064        05  trace-queue-name           pic x(16).
001066        05  cmqmdv-copybook.
001068            copy cmqmdv.
001070        05  cmqtml-copybook.
001072            copy cmqtml.
001074
001076 01  ws-nwif.
001078     03 nwif.
001080*       1,160 bytes in this group
001082        05 nwif-fields.
001084*          16 bytes in this group
001086*          Next field should start on a fullword boundary
001088           10 this-pntr                usage pointer.
001090           10 strucid                  pic x(04).
001092           10 version                  pic s9(08) comp.
001094           10 struclen                 pic s9(08) comp.
001096        05 micro-focus-fields.
001098*          172 bytes in this group
001100           10 mq03-alt-name            pic x(08).
001102           10 trace-level              pic 9(01).
001104           10 trace-level-unused       pic x(03).
001106           10 trace-queue-name         pic x(16).
001108           10 useridx                  pic x(08).
001110           10 ebiz-name                pic x(08).
001112           10 upgm-name                pic x(08).
001114           10 copybook-mode            pic x(04).
001116              88 copybook-mode-is-unk-88     value 'unk '.
001118              88 copybook-mode-is-sam-88     value 'sam '.
001120              88 copybook-mode-is-sep-88     value 'sep '.
001122              88 copybook-mode-is-amb-88     value 'amb '.
001124           10 processing-mode          pic x(04).
001126              88 mode-is-ld-88               value 'lcom'.
001128              88 mode-is-rc-88               value 'rcom'.
001130              88 mode-is-cics-88             value 'cics'.
001132              88 mode-is-ims-88              value 'ims'.
001134           10 security-status          pic x(04).
001136              88 mode-is-security-ok-88      value 'ok'.
001138              88 mode-is-security-error-88   value 'sece'.
001140           10 mf-processing-mode       pic x(04).
001142              88 mf-mode-is-normal-88        value spaces.
001144              88 mf-mode-is-error-88         value 'erro'.
001146           10 mf-abend-program         pic x(08).
001148           10 mf-abend-code            pic x(04).
001150           10 mf-return-code           pic 9(04).
001152           10 mf-reason                pic x(04).
001154           10 mf-msg                   pic x(80).
001156           10 filler                   pic x(04).
001158        05 mqtm-fields.
001160*          128 bytes in this group
001162           10 mqtm-userdata            pic x(128).
001164        05 req-msg-fields.
001166*          196 bytes in this group
001168*          Next field should start on a fullword boundary
001170           10 req-msg-pntr             usage pointer.
001172           10 req-msg-hdr-lenf         pic s9(08) comp.
001174           10 req-msg-hdr-ext-lenf     pic s9(08) comp.
001176           10 req-fmt-hdr-lenf         pic s9(08) comp.
001178           10 req-ebiz-hdr-lenf        pic s9(08) comp.
001180           10 req-ebiz-data-full-lenf  pic s9(08) comp.
001182           10 req-ebiz-data-used-lenf  pic s9(08) comp.
001184           10 req-msg-total-full-lenf  pic s9(08) comp.
001186           10 req-msg-total-used-lenf  pic s9(08) comp.
001188           10 req-msg-mq.
001190              15 req-qmgr-name         pic x(48).
001192              15 req-qname             pic x(48).
001194              15 req-queue-nbr         pic x(04).
001196              15 req-expiry            pic s9(08) comp.
001198              15 req-wait-interval     pic s9(08) comp.
001200              15 req-persistent        pic x(04).
001202              15 req-msgid             pic x(24).
001204              15 req-correlid          pic x(24).
001206        05 rep-msg-fields.
001208*          200 bytes in this group
001210*          Next field should start on a fullword boundary
001212           10 rep-msg-pntr             usage pointer.
001214           10 rep-msg-lenf             pic s9(08) comp.
001216           10 rep-msg-hdr-lenf         pic s9(08) comp.
001218           10 rep-fmt-hdr-lenf         pic s9(08) comp.
001220           10 rep-ebiz-hdr-lenf        pic s9(08) comp.
001222           10 rep-ebiz-data-full-lenf  pic s9(08) comp.
001224           10 rep-ebiz-data-used-lenf  pic s9(08) comp.
001226           10 rep-msg-total-full-lenf  pic s9(08) comp.
001228           10 rep-msg-total-used-lenf  pic s9(08) comp.
001230           10 rep-msg-mq.
001232              15 rep-qmgr-name         pic x(48).
001234              15 rep-qname             pic x(48).
001236              15 rep-queue-nbr         pic x(04).
001238              15 rep-expiry            pic s9(08) comp.
001240              15 rep-wait-interval     pic s9(08) comp.
001242              15 rep-persistent        pic x(04).
001244              15 rep-msgid             pic x(24).
001246              15 rep-correlid          pic x(24).
001248           10 filler                   pic x(04).
001250        05 to-upgm-fields.
001252*          176 bytes in this group
001254*          Next field should start on a fullword boundary
001256           10 to-upgm-bfr-pntr         usage pointer.
001258           10 to-upgm-bfr-full-lenf    pic s9(08) comp.
001260           10 to-upgm-bfr-used-lenf    pic s9(08) comp.
001262           10 to-upgm-mq.
001264              15 to-upgm-qmgr-name     pic x(48).
001266              15 to-upgm-qname         pic x(48).
001268              15 to-upgm-queue-nbr     pic x(04).
001270              15 to-upgm-expiry        pic s9(08) comp.
001272              15 to-upgm-wait-interval pic s9(08) comp.
001274              15 to-upgm-persistent    pic x(04).
001276              15 to-upgm-msgid         pic x(24).
001278              15 to-upgm-correlid      pic x(24).
001280           10 filler                   pic x(04).
001282        05 from-upgm-fields.
001284*          272 bytes in this group
001286*          Next field should start on a fullword boundary
001288           10 from-upgm-bfr-pntr       usage pointer.
001290           10 from-upgm-bfr-full-lenf  pic s9(08) comp.
001292           10 from-upgm-bfr-used-lenf  pic s9(08) comp.
001294           10 from-upgm-mq.
001296              15 from-upgm-qmgr-name   pic x(48).
001298              15 from-upgm-qname       pic x(48).
001300              15 from-upgm-queue-nbr   pic x(04).
001302              15 from-upgm-expiry      pic s9(08) comp.
001304              15 from-upgm-wait-interval
001306                                       pic s9(08) comp.
001308              15 from-upgm-persistent  pic x(04).
001310              15 from-upgm-msgid       pic x(24).
001312              15 from-upgm-correlid    pic x(24).
001314           10 from-upgm-fields-aux.
001316              15 from-upgm-processing-mode
001318                                       pic x(04).
001320                 88 from-upgm-mode-is-normal-88  value spaces.
001322                 88 from-upgm-mode-is-error-88   value 'erro'.
001324              15 from-upgm-abend-program
001326                                       pic x(04).
001328              15 from-upgm-abend-code  pic x(04).
001330              15 from-upgm-return-code pic 9(04).
001332              15 from-upgm-reason      pic x(04).
001334              15 from-upgm-msg         pic x(80).
001336
001338 01  ws-msg-partial                    pic x(1000) value spaces.
001340
001342 01  ws-footprint-header-len           pic 9(04) comp value 17.
001344 01  ws-retrieve-misc.
001346     05 retrieve-resp                  pic s9(08) comp.
001348     05 retrieve-resp2                 pic s9(08) comp.
001350     05 retrieve-set                   pic x(30).
001352     05 retrieve-into                  pic x(30).
001354     05 retrieve-length                pic s9(04) comp.
001356     05 retrieve-resp-disp             pic +9(08).
001358     05 retrieve-resp2-disp            pic +9(08).
001360
001362 01  ws-start-misc.
001364     05 start-resp                     pic s9(08) comp.
001366     05 start-resp2                    pic s9(08) comp.
001368     05 start-from                     pic x(30).
001370     05 start-length                   pic s9(04) comp.
001372     05 start-transid                  pic x(04).
001374     05 start-userid                   pic x(08).
001376     05 start-resp-disp                pic +9(08).
001378     05 start-resp2-disp               pic +9(08).
001380
001382 01  ws-verify-misc.
001384     05 verify-resp                    pic s9(08) comp.
001386     05 verify-resp2                   pic s9(08) comp.
001388     05 verify-userid                  pic x(08).
001390     05 verify-password                pic x(08).
001392     05 verify-daysleft                pic s9(04) comp.
001394        88 verifyy-pw-never-exp-88           value  -1.
001396        88 verify-pw-zero-days-88            value   0.
001398     05 verify-error-flag              redefines
001400        verify-daysleft                pic s9(4) comp.
001402        88 verify-id-security-er-88          value -13
001404                                                   -18
001406                                                   -29
001408                                                   -32
001410                                                   -02
001412                                                   -03
001414                                                   -19
001416                                                   -08.
001418        88 verify-id-invreq-88               value -13
001420                                                   -18
001422                                                   -29
001424                                                   -32.
001426        88 verify-id-notauth-88              value -02
001428                                                   -03
001430                                                   -19.
001432        88 verify-id-useriderr-88            value -08.
001434        88 verify-id-sm-error-88             value -13.
001436        88 verify-id-sm-not-init-88          value -18.
001438        88 verify-id-sm-no-resp-88           value -29.
001440        88 verify-id-id-invalid-88           value -32.
001442        88 verify-id-pw-invalid-88           value -02.
001444        88 verify-id-pw-expired-88           value -03.
001446        88 verify-id-id-revoked-88           value -19.
001448        88 verify-id-id-unknown-88           value -08.
001450     05 ws-return-values.
001452        10 ws-abend-error.
001454           15 ws-abend-codex           pic x(04) value 'MXAB'.
001456           15 ws-return-codex          pic 9(04) value 20.
001458           15 ws-messagex              pic x(80)
001460              value 'CICS abend in program MER0MMTM'.
001462        10 ws-useriderr-error.
001464           15 ws-abend-codex           pic x(04) value '9002'.
001466           15 ws-return-codex          pic 9(04) value 20.
001468           15 ws-messagex              pic x(80)
001470              value 'User id error'.
001472        10 ws-sm-error-error.
001474           15 ws-abend-codex           pic x(04) value '9002'.
001476           15 ws-return-codex          pic 9(04) value 20.
001478           15 ws-messagex              pic x(80)
001480              value 'SM error'.
001482        10 ws-sm-not-init-error.
001484           15 ws-abend-codex           pic x(04) value '9002'.
001486           15 ws-return-codex          pic 9(04) value 20.
001488           15 ws-messagex              pic x(80)
001490              value 'SM not initialized'.
001492        10 ws-sm-no-resp-error.
001494           15 ws-abend-codex           pic x(04) value '9002'.
001496           15 ws-return-codex          pic 9(04) value 20.
001498           15 ws-messagex              pic x(80)
001500              value 'SM no response'.
001502        10 ws-id-invalid-error.
001504           15 ws-abend-codex           pic x(04) value '9002'.
001506           15 ws-return-codex          pic 9(04) value 20.
001508           15 ws-messagex              pic x(80)
001510              value 'User ID invalid'.
001512        10 ws-pw-invalid-error.
001514           15 ws-abend-codex           pic x(04) value '9002'.
001516           15 ws-return-codex          pic 9(04) value 20.
001518           15 ws-messagex              pic x(80)
001520              value 'Password invalid'.
001522        10 ws-pw-expired-error.
001524           15 ws-abend-codex           pic x(04) value '9002'.
001526           15 ws-return-codex          pic 9(04) value 20.
001528           15 ws-messagex              pic x(80)
001530              value 'Password expired'.
001532        10 ws-id-revoked-error.
001534           15 ws-abend-codex           pic x(04) value '9002'.
001536           15 ws-return-codex          pic 9(04) value 20.
001538           15 ws-messagex              pic x(80)
001540              value 'User ID revoked'.
001542        10 ws-id-unknown-error.
001544           15 ws-abend-codex           pic x(04) value '9002'.
001546           15 ws-return-codex          pic 9(04) value 20.
001548           15 ws-messagex              pic x(80)
001550              value 'User ID unknown'.
001552        10 ws-verify-error.
001554           15 ws-abend-codex           pic x(04) value '9002'.
001556           15 ws-return-codex          pic 9(04) value 20.
001558           15 ws-messagex.
001560              20 filler                pic x(31)
001562                 value 'CICS verify error, eibrcode is '.
001564              20 ws-verify-eibresp         pic +++9.
001566              20 filler                    pic x(18)
001568                 value ' and eibrcode2 is '.
001570              20 ws-verify-eibresp2    pic +++9.
001572
001574 01  ws-mqclose-misc.
001576     05 mqclose-hconn                  pic s9(09) binary.
001578     05 mqclose-q-handle               pic s9(09) binary.
001580     05 mqclose-options                pic s9(09) binary.
001582     05 mqclose-comp-code              pic s9(09) binary.
001584     05 mqclose-reason                 pic s9(09) binary.
001586     05 mqclose-comp-code-disp         pic +9(02).
001588     05 mqclose-reason-disp            pic +9(04).
001590
001592 01  ws-mqget-misc.
001594     05 mqget-wait-interval            pic s9(09) binary
001596        value 30000.
001598     05 mqget-hconn                    pic s9(09) binary.
001600     05 mqget-q-handle                 pic s9(09) binary.
001602*             mqget-msg-desc
001604     05 mqget-options                  pic s9(09) binary.
001606     05 mqget-buffer-lenf              pic s9(09) binary.
001608*             lk-mq-msg
001610     05 mqget-data-lenf                pic s9(09) binary.
001612     05 mqget-comp-code                pic s9(09) binary.
001614     05 mqget-reason                   pic s9(09) binary.
001616     05 mqget-browse-first             pic s9(09) binary.
001618     05 mqget-browse-next              pic s9(09) binary.
001620     05 mqget-comp-code-disp           pic +9(02).
001622     05 mqget-reason-disp              pic +9(04).
001624     05 mqget-ind                      pic 9(01) value zero.
001626        88 mqget-continue-88                 value zero.
001628        88 mqget-stop-88                     value 1.
001630
001632 01  ws-mqopen-misc.
001634     05 mqopen-hconn                   pic s9(09) binary.
001636*             mqopen-object-descriptor
001638     05 mqopen-options                 pic s9(09) binary.
001640     05 mqopen-q-handle                pic s9(09) binary.
001642     05 mqopen-comp-code               pic s9(09) binary.
001644     05 mqopen-reason                  pic s9(09) binary.
001646     05 mqopen-comp-code-disp          pic +9(02).
001648     05 mqopen-reason-disp             pic +9(04).
001650
001652 01  ws-offsets-misc.
001654     10 offsets-misc.
001656        15 filler                      pic x(01).
001658
001660 01  ws-clif-misc.
001662     10 clif-misc.
001664        15 filler                      pic x(01).
001666
001668 01  ws-program-recs-t.
001670     05 ws-footprint-t.
001672        10 footprint-t.
001674           15 filler                   pic x(11)
001676              value 'Footprint '.
001678           15 footprint-data           pic x(96).
001680     05 ws-section-t.
001682        10 ws-trace-section-rec.
001684           15 filler                   pic x(05)
001686              value 'Sect '.
001688           15 ws-trace-section-name    pic x(30).
001690     05 ws-info-t.
001692        10 filler                      pic x(05)
001694           value 'Info '.
001696        10 textx                       pic x(200).
001698     05 ws-error-t.
001700        10 filler                      pic x(16)
001702           value '**** ERROR ****'.
001704        10 filler                      pic x(16)
001706           value '**** ERROR ****'.
001708 01  ws-intf-recs-t.
001710     05 filler                         pic x(01) value spaces.
001712     05 ws-clif-t.
001714        10 clif-t.
001716           15 filler                   pic x(16)
001718              value 'Stru CLIF'.
001720           15 filler                   pic x(16)
001722              value 'version'.
001724           15 version                  pic +999,999,999.
001726           15 filler                   pic x(04) value spaces.
001728           15 filler                   pic x(16)
001730              value 'struclen'.
001732           15 struclen                 pic +999,999,999.
001734           15 filler                   pic x(04) value spaces.
001736           15 filler                   pic x(16)
001738              value 'this-pntr'.
001740           15 this-pntr                usage pointer.
001742           15 filler                   pic x(12) value spaces.
001744           15 filler                   pic x(16)
001746              value 'trace-level'.
001748           15 trace-level              pic x(01).
001750           15 filler                   pic x(15) value spaces.
001752           15 filler                   pic x(16)
001754              value 'trace-name'.
001756           15 trace-queue-name         pic x(16).
001758     05 ws-nwif-t.
001760        10 nwif-t.
001762           15 filler                   pic x(16)
001764              value 'Stru NWIF'.
001766           15 filler                   pic x(16)
001768              value 'this-pntr'.
001770           15 this-pntr                usage pointer.
001772           15 filler                   pic x(12) value spaces.
001774           15 filler                   pic x(16)
001776              value 'version'.
001778           15 version                  pic +999,999,999.
001780           15 filler                   pic x(04) value spaces.
001782           15 filler                   pic x(16)
001784              value 'struclen'.
001786           15 struclen                 pic +999,999,999.
001788           15 filler                   pic x(04) value spaces.
001790           15 filler                   pic x(16)
001792              value 'req-pntr'.
001794           15 req-msg-pntr             usage pointer.
001796           15 filler                   pic x(12) value spaces.
001798           15 filler                   pic x(16)
001800              value 'rep-pntr'.
001802           15 rep-msg-pntr             usage pointer.
001804           15 filler                   pic x(12) value spaces.
001806           15 filler                   pic x(16)
001808              value 'mq03-alt-name'.
001810           15 mq03-alt-name            pic x(08).
001812           15 filler                   pic x(08) value spaces.
001814           15 filler                   pic x(16)
001816              value 'trace-level'.
001818           15 trace-level              pic +9(01).
001820           15 filler                   pic x(14) value spaces.
001822           15 filler                   pic x(16)
001824              value 'trace-leve-un'.
001826           15 trace-level-unused       pic x(03).
001828           15 filler                   pic x(13) value spaces.
001830           15 filler                   pic x(16)
001832              value 'trace-queue'.
001834           15 trace-queue-name         pic x(16).
001836           15 filler                   pic x(16)
001838              value 'userid'.
001840           15 useridx                  pic x(08).
001842           15 filler                   pic x(08) value spaces.
001844           15 filler                   pic x(16)
001846              value 'ebiz-name'.
001848           15 ebiz-name                pic x(08).
001850           15 filler                   pic x(08) value spaces.
001852           15 filler                   pic x(16)
001854              value 'upgm-name'.
001856           15 upgm-name                pic x(08).
001858           15 filler                   pic x(08) value spaces.
001860           15 filler                   pic x(16)
001862              value 'copybook-mode'.
001864           15 copybook-mode            pic x(04).
001866           15 filler                   pic x(12) value spaces.
001868           15 filler                   pic x(16)
001870              value 'processing-mode'.
001872           15 processing-mode          pic x(04).
001874           15 filler                   pic x(12) value spaces.
001876           15 filler                   pic x(16)
001878              value 'security-status'.
001880           15 security-status          pic x(04).
001882           15 filler                   pic x(12) value spaces.
001884           15 filler                   pic x(16)
001886              value 'mf-mode'.
001888           15 mf-processing-mode       pic x(04).
001890           15 filler                   pic x(12) value spaces.
001892           15 filler                   pic x(16)
001894              value 'mf-abend-program'.
001896           15 mf-abend-program         pic x(08).
001898           15 filler                   pic x(08) value spaces.
001900           15 filler                   pic x(16)
001902              value 'mf-abend-code'.
001904           15 mf-abend-code            pic x(04).
001906           15 filler                   pic x(12) value spaces.
001908           15 filler                   pic x(16)
001910              value 'mf-return-code'.
001912           15 mf-return-code           pic +9(04).
001914           15 filler                   pic x(11) value spaces.
001916           15 filler                   pic x(16)
001918              value 'mf-reason'.
001920           15 mf-reason                pic x(04).
001922           15 filler                   pic x(12) value spaces.
001924           15 filler                   pic x(16)
001926              value 'mf-msg'.
001928           15 mf-msg                   pic x(256).
001930           15 filler                   pic x(16) value spaces.
001932           15 filler                   pic x(16)
001934              value 'mqtm-userdata'.
001936           15 mqtm-userdata            pic x(128).
001938           15 filler                   pic x(16) value spaces.
001940           15 filler                   pic x(16)
001942              value 'req-msg-hdr-len'.
001944           15 req-msg-hdr-lenf         pic +999,999,999.
001946           15 filler                   pic x(04) value spaces.
001948           15 filler                   pic x(16)
001950              value 'req-msg-hdre-len'.
001952           15 req-msg-hdr-ext-lenf     pic +999,999,999.
001954           15 filler                   pic x(04) value spaces.
001956           15 filler                   pic x(16)
001958              value 'req-fmt-hdr-len'.
001960           15 req-fmt-hdr-lenf         pic +999,999,999.
001962           15 filler                   pic x(04) value spaces.
001964           15 filler                   pic x(16)
001966              value 'req-req-hdr-len'.
001968           15 req-ebiz-hdr-lenf        pic +999,999,999.
001970           15 filler                   pic x(04) value spaces.
001972           15 filler                   pic x(16)
001974              value 'req-data-flen'.
001976           15 req-ebiz-data-full-lenf  pic +999,999,999.
001978           15 filler                   pic x(04) value spaces.
001980           15 filler                   pic x(16)
001982              value 'req-data-ulen'.
001984           15 req-ebiz-data-used-lenf  pic +999,999,999.
001986           15 filler                   pic x(04) value spaces.
001988           15 filler                   pic x(16)
001990              value 'req-msg-t-flen'.
001992           15 req-msg-total-full-lenf  pic +999,999,999.
001994           15 filler                   pic x(04) value spaces.
001996           15 filler                   pic x(16)
001998              value 'req-msg-t-alen'.
002000           15 req-msg-total-used-lenf  pic +999,999,999.
002002           15 filler                   pic x(04) value spaces.
002004           15 filler                   pic x(16)
002006              value 'req-qmgr'.
002008           15 req-qmgr-name            pic x(48).
002010           15 filler                   pic x(16) value spaces.
002012           15 filler                   pic x(16)
002014              value 'req-qname'.
002016           15 req-qname                pic x(48).
002018           15 filler                   pic x(16) value spaces.
002020           15 filler                   pic x(16)
002022              value 'req-q-nbr'.
002024           15 req-queue-nbr            pic x(48).
002026           15 filler                   pic x(16) value spaces.
002028           15 filler                   pic x(16)
002030              value 'req-expiry'.
002032           15 req-expiry               pic x(48).
002034           15 filler                   pic x(16) value spaces.
002036           15 filler                   pic x(16)
002038              value 'req-wait'.
002040           15 req-wait-interval        pic x(48).
002042           15 filler                   pic x(16) value spaces.
002044           15 filler                   pic x(16)
002046              value 'req-persist'.
002048           15 req-persistent           pic x(48).
002050           15 filler                   pic x(16) value spaces.
002052           15 filler                   pic x(16)
002054              value 'req-msgid'.
002056           15 req-msgid                pic x(24).
002058           15 filler                   pic x(08) value spaces.
002060           15 filler                   pic x(16)
002062              value 'req-correlid'.
002064           15 req-correlid             pic x(24).
002066           15 filler                   pic x(08) value spaces.
002068           15 filler                   pic x(16)
002070              value 'rep-msg-hdr-len'.
002072           15 rep-msg-hdr-lenf         pic +999,999,999.
002074           15 filler                   pic x(04) value spaces.
002076           15 filler                   pic x(16)
002078              value 'rep-fmt-hdr-len'.
002080           15 rep-fmt-hdr-lenf         pic +999,999,999.
002082           15 filler                   pic x(04) value spaces.
002084           15 filler                   pic x(16)
002086              value 'rep-ebiz-hdr-len'.
002088           15 rep-ebiz-hdr-lenf        pic +999,999,999.
002090           15 filler                   pic x(04) value spaces.
002092           15 filler                   pic x(16)
002094              value 'rep-ebiz-d-flen'.
002096           15 rep-ebiz-data-full-lenf  pic +999,999,999.
002098           15 filler                   pic x(04) value spaces.
002100           15 filler                   pic x(16)
002102              value 'rep-ebiz-d-ulen'.
002104           15 rep-ebiz-data-used-lenf  pic +999,999,999.
002106           15 filler                   pic x(04) value spaces.
002108           15 filler                   pic x(16)
002110              value 'rep-msg-to-flen'.
002112           15 rep-msg-total-full-lenf  pic +999,999,999.
002114           15 filler                   pic x(04) value spaces.
002116           15 filler                   pic x(16)
002118              value 'rep-msg-to-ulen'.
002120           15 rep-msg-total-used-lenf  pic +999,999,999.
002122           15 filler                   pic x(04) value spaces.
002124           15 filler                   pic x(16)
002126              value 'rep-qmgr'.
002128           15 rep-qmgr-name            pic x(48).
002130           15 filler                   pic x(16) value spaces.
002132           15 filler                   pic x(16)
002134              value 'rep-qname'.
002136           15 rep-qname                pic x(48).
002138           15 filler                   pic x(16) value spaces.
002140           15 filler                   pic x(16)
002142              value 'rep-q-nbr'.
002144           15 rep-queue-nbr            pic x(48).
002146           15 filler                   pic x(16) value spaces.
002148           15 filler                   pic x(16)
002150              value 'rep-expiry'.
002152           15 rep-expiry               pic x(48).
002154           15 filler                   pic x(16) value spaces.
002156           15 filler                   pic x(16)
002158              value 'rep-wait'.
002160           15 rep-wait-interval        pic x(48).
002162           15 filler                   pic x(16) value spaces.
002164           15 filler                   pic x(16)
002166              value 'rep-persist'.
002168           15 rep-persistent           pic x(48).
002170           15 filler                   pic x(16) value spaces.
002172           15 filler                   pic x(16)
002174              value 'rep-msgid'.
002176           15 rep-msgid                pic x(24).
002178           15 filler                   pic x(08) value spaces.
002180           15 filler                   pic x(16)
002182              value 'rep-correlid'.
002184           15 rep-correlid             pic x(24).
002186           15 filler                   pic x(08) value spaces.
002188           15 filler                   pic x(16)
002190              value 'to-upgm-bfr-pntr'.
002192           15 to-upgm-bfr-pntr         usage pointer.
002194           15 filler                   pic x(12) value spaces.
002196           15 filler                   pic x(16)
002198              value 'to-upgm-bfr-fl'.
002200           15 to-upgm-bfr-full-lenf    pic +999,999,999.
002202           15 filler                   pic x(04) value spaces.
002204           15 filler                   pic x(16)
002206              value 'to-upgm-bfr-ul'.
002208           15 to-upgm-bfr-used-lenf    pic +999,999,999.
002210           15 filler                   pic x(04) value spaces.
002212           15 filler                   pic x(16)
002214              value 'to-upgm-qmgr'.
002216           15 to-upgm-qmgr-name        pic x(48).
002218           15 filler                   pic x(16) value spaces.
002220           15 filler                   pic x(16)
002222              value 'to-upgm-qname'.
002224           15 to-upgm-qname            pic x(48).
002226           15 filler                   pic x(16) value spaces.
002228           15 filler                   pic x(16)
002230              value 'to-upgm-qnbr'.
002232           15 to-upgm-queue-nbr        pic x(03).
002234           15 filler                   pic x(13) value spaces.
002236           15 filler                   pic x(16)
002238              value 'to-upgm-expiry'.
002240           15 to-upgm-expiry           pic x(01).
002242           15 filler                   pic x(15) value spaces.
002244           15 filler                   pic x(16)
002246              value 'to-upgm-wait'.
002248           15 to-upgm-wait-interval    pic +999,999,999.
002250           15 filler                   pic x(04) value spaces.
002252           15 filler                   pic x(16)
002254              value 'to-upgm-persis'.
002256           15 to-upgm-persistent       pic x(01).
002258           15 filler                   pic x(15) value spaces.
002260           15 filler                   pic x(16)
002262              value 'to-upgm-msgid'.
002264           15 to-upgm-msgid            pic x(24).
002266           15 filler                   pic x(08) value spaces.
002268           15 filler                   pic x(16)
002270              value 'to-upgm-correlid'.
002272           15 to-upgm-correlid         pic x(24).
002274           15 filler                   pic x(08) value spaces.
002276           15 filler                   pic x(16)
002278              value 'fr-upgm-bfr-pntr'.
002280           15 from-upgm-bfr-pntr       usage pointer.
002282           15 filler                   pic x(12) value spaces.
002284           15 filler                   pic x(16)
002286              value 'fr-upgm-bfr-fl'.
002288           15 from-upgm-bfr-full-lenf  pic +999,999,999.
002290           15 filler                   pic x(04) value spaces.
002292           15 filler                   pic x(16)
002294              value 'fr-upgm-bfr-ul'.
002296           15 from-upgm-bfr-used-lenf  pic +999,999,999.
002298           15 filler                   pic x(04) value spaces.
002300           15 filler                   pic x(16)
002302              value 'fr-upgm-qmgr'.
002304           15 from-upgm-qmgr-name      pic x(48).
002306           15 filler                   pic x(16) value spaces.
002308           15 filler                   pic x(16)
002310              value 'fr-upgm-qname'.
002312           15 from-upgm-qname          pic x(48).
002314           15 filler                   pic x(16) value spaces.
002316           15 filler                   pic x(16)
002318              value 'fr-upgm-qnbr'.
002320           15 from-upgm-queue-nbr      pic x(03).
002322           15 filler                   pic x(13) value spaces.
002324           15 filler                   pic x(16)
002326              value 'fr-upgm-expiry'.
002328           15 from-upgm-expiry         pic x(01).
002330           15 filler                   pic x(15) value spaces.
002332           15 filler                   pic x(16)
002334              value 'fr-upgm-wait'.
002336           15 from-upgm-wait-interval  pic +999,999,999.
002338           15 filler                   pic x(04) value spaces.
002340           15 filler                   pic x(16)
002342              value 'fr-upgm-persis'.
002344           15 from-upgm-persistent     pic x(01).
002346           15 filler                   pic x(15) value spaces.
002348           15 filler                   pic x(16)
002350              value 'fr-upgm-msgid'.
002352           15 from-upgm-msgid          pic x(24).
002354           15 filler                   pic x(08) value spaces.
002356           15 filler                   pic x(16)
002358              value 'fr-upgm-correlid'.
002360           15 from-upgm-correlid       pic x(24).
002362           15 filler                   pic x(08) value spaces.
002364           15 filler                   pic x(16)
002366              value 'up-mode'.
002368           15 from-upgm-processing-mode
002370                                       pic x(04).
002372           15 filler                   pic x(12) value spaces.
002374           15 filler                   pic x(16)
002376              value 'up-abend-program'.
002378           15 from-upgm-abend-program  pic x(08).
002380           15 filler                   pic x(08) value spaces.
002382           15 filler                   pic x(16)
002384              value 'up-abend-code'.
002386           15 from-upgm-abend-code     pic x(04).
002388           15 filler                   pic x(12) value spaces.
002390           15 filler                   pic x(16)
002392              value 'up-return-code'.
002394           15 from-upgm-return-code    pic +9(04).
002396           15 filler                   pic x(11) value spaces.
002398           15 filler                   pic x(16)
002400              value 'up-reason'.
002402           15 from-upgm-reason         pic x(04).
002404           15 filler                   pic x(12) value spaces.
002406           15 filler                   pic x(16)
002408              value 'up-msg'.
002410           15 from-upgm-msg            pic x(256).
002412           15 filler                   pic x(16) value spaces.
002414 01 ws-msg-hdr-t.
002416    05 msg-hdr-t.
002418       10 msg-hdr.
002420          15 filler                    pic x(16)
002422             value 'Stru MWIH'.
002424          15 filler                    pic x(16)
002426             value 'base-pntr'.
002428          15 base-pntr                 pic x(04).
002430          15 filler                    pic x(12) value spaces.
002432          15 filler                    pic x(16)
002434             value 'this-pntr'.
002436          15 this-pntr                 pic x(04).
002438          15 filler                    pic x(12) value spaces.
002440          15 filler                    pic x(16)
002442             value 'this-length'.
002444          15 this-length               pic +999,999,999.
002446          15 filler                    pic x(04) value spaces.
002448          15 filler                    pic x(16)
002450             value 'Vector follows'.
002452          15 filler                    pic x(16)
002454             value 'message-encoding'.
002456          15 message-encoding          pic x(04).
002458          15 filler                    pic x(12) value spaces.
002460          15 filler                    pic x(16)
002462             value 'msg-sequence-num'.
002464          15 msg-sequence-num          pic x(04).
002466          15 filler                    pic x(12) value spaces.
002468          15 filler                    pic x(16)
002470             value 'msg-xmit-time'.
002472          15 msg-xmit-time             pic x(18).
002474          15 filler                    pic x(14) value spaces.
002476          15 filler                    pic x(16)
002478             value 'trace-flags'.
002480          15 trace-flags               pic x(02).
002482          15 filler                    pic x(14) value spaces.
002484          15 filler                    pic x(16)
002486             value 'msg-max-length'.
002488          15 msg-max-length            pic x(10).
002490          15 filler                    pic x(06) value spaces.
002492          15 filler                    pic x(16)
002494             value 'appl-msg-length'.
002496          15 appl-msg-length           pic x(10).
002498          15 filler                    pic x(06) value spaces.
002500          15 filler                    pic x(16)
002502             value 'trace-ts-q'.
002504          15 trace-ts-q                pic x(08).
002506          15 filler                    pic x(08) value spaces.
002508          15 filler                    pic x(16)
002510             value 'useridx'.
002512          15 useridx                   pic x(08).
002514          15 filler                    pic x(08) value spaces.
002516          15 filler                    pic x(16)
002518             value 'passwordx'.
002520          15 passwordx                 pic x(16).
002522          15 filler                    pic x(16)
002524             value 'public-key'.
002526          15 public-key                pic x(16).
002528          15 filler                    pic x(16)
002530             value 'sessionid'.
002532          15 sessionid                 pic x(24).
002534          15 filler                    pic x(08) value spaces.
002536          15 filler                    pic x(16)
002538             value 'function-code'.
002540          15 function-code             pic x(02).
002542          15 filler                    pic x(14) value spaces.
002544          15 filler                    pic x(16)
002546             value 'secondary-code'.
002548          15 secondary-func-code       pic x(02).
002550          15 filler                    pic x(14) value spaces.
002552          15 filler                    pic x(16)
002554             value 'resource-url'.
002556          15 resource-url              pic x(32).
002558          15 filler                    pic x(16) value spaces.
002560          15 filler                    pic x(16)
002562             value 'mq-put-msg-expir'.
002564          15 mq-put-msg-expiry         pic x(09).
002566          15 filler                    pic x(07) value spaces.
002568          15 filler                    pic x(16)
002570             value 'mq-get-msg-wait'.
002572          15 mq-get-msg-wait           pic x(09).
002574          15 filler                    pic x(07) value spaces.
002576          15 filler                    pic x(16)
002578             value 'mq-persistence'.
002580          15 mq-persistence-flag       pic x(01).
002582          15 filler                    pic x(15) value spaces.
002584          15 filler                    pic x(16)
002586             value 'filler13'.
002588          15 filler13                  pic x(13).
002590          15 filler                    pic x(03) value spaces.
002592          15 filler                    pic x(16)
002594             value 'cics-verify'.
002596          15 cics-verify               pic x(01).
002598          15 filler                    pic x(15) value spaces.
002600          15 filler                    pic x(16)
002602             value 'message-exit'.
002604          15 message-exit              pic x(01).
002606          15 filler                    pic x(15) value spaces.
002608          15 filler                    pic x(16)
002610             value 'ebiz-type'.
002612          15 ebiz-type                 pic x(01).
002614          15 filler                    pic x(15) value spaces.
002616          15 filler                    pic x(16)
002618             value 'reserved'.
002620          15 reserved                  pic x(13).
002622          15 filler                    pic x(03) value spaces.
002624          15 filler                    pic x(16)
002626             value 'return-codex'.
002628          15 return-codex              pic x(04).
002630          15 filler                    pic x(12) value spaces.
002632          15 filler                    pic x(16)
002634             value 'reason-codex'.
002636          15 reason-codex              pic x(04).
002638          15 filler                    pic x(12) value spaces.
002640 01 ws-msg-hdr-ext-t.
002642    05 msg-hdr-ext-t.
002644       10 msg-hdr-ext.
002646          15 filler                    pic x(16)
002648             value 'Stru MWIH-e'.
002650          15 filler                    pic x(16)
002652             value 'base-pntr'.
002654          15 base-pntr                 pic x(04).
002656          15 filler                    pic x(12) value spaces.
002658          15 filler                    pic x(16)
002660             value 'this-pntr'.
002662          15 this-pntr                 pic x(04).
002664          15 filler                    pic x(12) value spaces.
002666          15 filler                    pic x(16)
002668             value 'this-length'.
002670          15 this-length               pic +999,999,999.
002672          15 filler                    pic x(04) value spaces.
002674          15 filler                    pic x(16)
002676             value 'Vector follows'.
002678          15 filler                    pic x(16)
002680             value 'to-qmgr-name'.
002682          15 to-upgm-qmgr-name         pic x(48).
002684          15 filler                    pic x(16) value spaces.
002686          15 filler                    pic x(16)
002688             value 'to-upgm-qname'.
002690          15 to-upgm-qname             pic x(48).
002692          15 filler                    pic x(16) value spaces.
002694          15 filler                    pic x(16)
002696             value 'from-upgm-nbr'.
002698          15 to-upgm-queue-nbr         pic x(03).
002700          15 filler                    pic x(13) value spaces.
002702          15 filler                    pic x(16)
002704             value 'to-upgm-expiry'.
002706          15 to-upgm-expiry            pic x(08).
002708          15 filler                    pic x(08) value spaces.
002710          15 filler                    pic x(16)
002712             value 'to-upgm-wait'.
002714          15 to-upgm-wait-interval     pic x(08).
002716          15 filler                    pic x(08) value spaces.
002718          15 filler                    pic x(16)
002720             value 'to-upgm-persis'.
002722          15 to-upgm-persistent        pic x(01).
002724          15 filler                    pic x(15) value spaces.
002726          15 filler                    pic x(16)
002728             value 'from-qmgr-name'.
002730          15 from-upgm-qmgr-name       pic x(48).
002732          15 filler                    pic x(16) value spaces.
002734          15 filler                    pic x(16)
002736             value 'from-upgm-qname'.
002738          15 from-upgm-qname           pic x(48).
002740          15 filler                    pic x(16) value spaces.
002742          15 filler                    pic x(16)
002744             value 'from-upgm-nbr'.
002746          15 from-upgm-queue-nbr       pic x(03).
002748          15 filler                    pic x(13) value spaces.
002750          15 filler                    pic x(16)
002752             value 'from-upgm-expiry'.
002754          15 from-upgm-expiry          pic x(08).
002756          15 filler                    pic x(08) value spaces.
002758          15 filler                    pic x(16)
002760             value 'from-upgm-wait'.
002762          15 from-upgm-wait-interval   pic x(08).
002764          15 filler                    pic x(08) value spaces.
002766          15 filler                    pic x(16)
002768             value 'from-upgm-persis'.
002770          15 from-upgm-persistent      pic x(01).
002772          15 filler                    pic x(15) value spaces.
002774          15 filler                    pic x(16)
002776             value 'mq03-alt-name'.
002778          15 mq03-alt-name             pic x(08).
002780          15 filler                    pic x(08) value spaces.
002782          15 filler                    pic x(16)
002784             value 'reserved'.
002786          15 reserved                  pic x(321).
002788          15 filler                    pic x(15) value spaces.
002790 01 ws-fmt-hdr-t.
002792    05 fmt-hdr-t.
002794       10 fmt-hdr.
002796          15 filler                    pic x(16)
002798             value 'Stru FMTH'.
002800          15 filler                    pic x(16)
002802             value 'base-pntr'.
002804          15 base-pntr                 pic x(04).
002806          15 filler                    pic x(12) value spaces.
002808          15 filler                    pic x(16)
002810             value 'this-pntr'.
002812          15 this-pntr                 pic x(04).
002814          15 filler                    pic x(12) value spaces.
002816          15 filler                    pic x(16)
002818             value 'this-length'.
002820          15 this-length               pic +999,999,999.
002822          15 filler                    pic x(04) value spaces.
002824          15 filler                    pic x(16)
002826             value 'Vector follows'.
002828          15 filler                    pic x(16)
002830             value 'version'.
002832          15 version                   pic 9(04).
002834          15 filler                    pic x(12) value spaces.
002836          15 filler                    pic x(16)
002838             value 'codepage'.
002840          15 codepage                  pic 9(04).
002842          15 filler                    pic x(12) value spaces.
002844          15 filler                    pic x(16)
002846             value 'encoding-format'.
002848          15 encoding-format           pic 9(02).
002850          15 filler                    pic x(14) value spaces.
002852          15 filler                    pic x(16)
002854             value 'platform'.
002856          15 platform                  pic 9(02).
002858          15 filler                    pic x(14) value spaces.
002860          15 filler                    pic x(16)
002862             value 'message-length'.
002864          15 message-length            pic +999,999,999.
002866          15 filler                    pic x(04) value spaces.
002868          15 filler                    pic x(16)
002870             value 'filler1'.
002872          15 filler1                   pic 9(05).
002874          15 filler                    pic x(11) value spaces.
002876          15 filler                    pic x(16)
002878             value 'formatter-flag'.
002880          15 formatter-trace-flag      pic 9(01).
002882          15 filler                    pic x(15) value spaces.
002884          15 filler                    pic x(16)
002886             value 'trace-flags'.
002888          15 trace-flags               pic 9(01).
002890          15 filler                    pic x(15) value spaces.
002892          15 filler                    pic x(16)
002894             value 'trace-ts-q'.
002896          15 trace-ts-q                pic x(08).
002898          15 filler                    pic x(08) value spaces.
002900 01 ws-ebiz-req-hdr-t.
002902    05 ebiz-req-hdr-t.
002904       10 ebiz-req-hdr.
002906          15 filler                    pic x(16)
002908             value 'Stru REQH'.
002910          15 filler                    pic x(16)
002912             value 'base-pntr'.
002914          15 base-pntr                 pic x(04).
002916          15 filler                    pic x(12) value spaces.
002918          15 filler                    pic x(16)
002920             value 'this-pntr'.
002922          15 this-pntr                 pic x(04).
002924          15 filler                    pic x(12) value spaces.
002926          15 filler                    pic x(16)
002928             value 'this-length'.
002930          15 this-length               pic +999,999,999.
002932          15 filler                    pic x(04) value spaces.
002934          15 filler                    pic x(16)
002936             value 'Vector follows'.
002938          15 filler                    pic x(16)
002940             value 'useridx'.
002942          15 useridx                   pic x(08).
002944          15 filler                    pic x(08) value spaces.
002946          15 filler                    pic x(16)
002948             value 'passwordx'.
002950          15 passwordx                 pic x(08).
002952          15 filler                    pic x(08) value spaces.
002954          15 filler                    pic x(16)
002956             value 'facilitylike'.
002958          15 facilitylike              pic x(04).
002960          15 filler                    pic x(12) value spaces.
002962          15 filler                    pic x(16)
002964             value 'recovery-step'.
002966          15 recovery-step             pic +9(03).
002968          15 filler                    pic x(12) value spaces.
002970          15 filler                    pic x(16)
002972             value 'recovery-flag'.
002974          15 recovery-flag             pic +9(01).
002976          15 filler                    pic x(14) value spaces.
002978          15 filler                    pic x(16)
002980             value 'filler2'.
002982          15 filler2                   pic x(02).
002984          15 filler                    pic x(14) value spaces.
002986 01 ws-ebiz-rep-hdr-t.
002988    05 ebiz-rep-hdr-t.
002990       10 ebiz-rep-hdr.
002992          15 filler                    pic x(16)
002994             value 'Stru REPH'.
002996          15 filler                    pic x(16)
002998             value 'base-pntr'.
003000          15 base-pntr                 pic x(04).
003002          15 filler                    pic x(12) value spaces.
003004          15 filler                    pic x(16)
003006             value 'this-pntr'.
003008          15 this-pntr                 pic x(04).
003010          15 filler                    pic x(12) value spaces.
003012          15 filler                    pic x(16)
003014             value 'this-length'.
003016          15 this-length               pic +999,999,999.
003018          15 filler                    pic x(04) value spaces.
003020          15 filler                    pic x(16)
003022             value 'Vector follows'.
003024          15 filler                    pic x(16)
003026             value 'target'.
003028          15 target                    pic x(32).
003030          15 filler                    pic x(16) value spaces.
003032          15 filler                    pic x(16)
003034             value 'abendcode'.
003036          15 abendcode                 pic x(04).
003038          15 filler                    pic x(12) value spaces.
003040          15 filler                    pic x(16)
003042             value 'statusx'.
003044          15 statusx                   pic +9(04).
003046          15 filler                    pic x(11) value spaces.
003048          15 filler                    pic x(16)
003050             value 'status-msg'.
003052          15 status-msg                pic x(80).
003054          15 filler                    pic x(16) value spaces.
003056          15 filler                    pic x(16)
003058             value 'filler'.
003060          15 filler                    pic x(08).
003062          15 filler                    pic x(08) value spaces.
003064 01  ws-cics-recs-t.
003066     05 filler                         pic x(01) value spaces.
003068     05 ws-retrieve-t.
003070        10 retrieve-t.
003072           15 filler                   pic x(16)
003074              value 'Exec RETRIEVE'.
003076           15 retrieve-status          pic x(06).
003078              88 retrieve-after-88           value 'after '.
003080              88 retrieve-before-88          value 'before'.
003082              88 retrieve-error-88           value 'error'.
003084           15 filler                   pic x(10) value space.
003086           15 filler                   pic x(16)
003088              value 'resp'.
003090           15 retrieve-resp            pic +999,999,999.
003092           15 filler                   pic x(04) value spaces.
003094           15 filler                   pic x(16)
003096              value 'resp2'.
003098           15 retrieve-resp2           pic +999,999,999.
003100           15 filler                   pic x(04) value spaces.
003102           15 filler                   pic x(16)
003104              value 'into'.
003106           15 retrieve-into            pic x(30).
003108           15 filler                   pic x(02) value spaces.
003110           15 filler                   pic x(16)
003112              value 'set'.
003114           15 retrieve-set             pic x(30).
003116           15 filler                   pic x(02) value spaces.
003118           15 filler                   pic x(16)
003120              value 'length'.
003122           15 retrieve-length          pic +999,999,999.
003124           15 filler                   pic x(04) value spaces.
003126           15 filler                   pic x(16)
003128              value 'nohandle'.
003130     05 ws-start-t.
003132        10 start-t.
003134           15 filler                   pic x(16)
003136              value 'Exec START'.
003138           15 start-status             pic x(06).
003140              88 start-after-88              value 'after '.
003142              88 start-before-88             value 'before'.
003144              88 start-error-88              value 'error '.
003146           15 filler                   pic x(10) value space.
003148           15 filler                   pic x(16)
003150              value 'resp'.
003152           15 start-resp               pic +999,999,999.
003154           15 filler                   pic x(04) value spaces.
003156           15 filler                   pic x(16)
003158              value 'resp2'.
003160           15 start-resp2              pic +999,999,999.
003162           15 filler                   pic x(04) value spaces.
003164           15 filler                   pic x(16)
003166              value 'transid'.
003168           15 start-transid            pic x(08).
003170           15 filler                   pic x(08) value spaces.
003172           15 filler                   pic x(16)
003174              value 'from'.
003176           15 start-from               pic x(30).
003178           15 filler                   pic x(02) value spaces.
003180           15 filler                   pic x(16)
003182              value 'length'.
003184           15 start-length             pic +999,999,999.
003186           15 filler                   pic x(04) value spaces.
003188           15 filler                   pic x(16)
003190              value 'userid'.
003192           15 start-userid             pic x(08).
003194           15 filler                   pic x(08) value spaces.
003196           15 filler                   pic x(16)
003198              value 'nohandle'.
003200     05 ws-verify-t.
003202        10 verify-t.
003204           15 filler                   pic x(16)
003206              value 'Exec VERIFY'.
003208           15 verify-status            pic x(06).
003210              88 verify-after-88             value 'after '.
003212              88 verify-before-88            value 'before'.
003214              88 verify-error-88             value 'error '.
003216           15 filler                   pic x(10) value space.
003218           15 filler                   pic x(16)
003220              value 'resp'.
003222           15 verify-resp              pic +999,999,999.
003224           15 filler                   pic x(04) value spaces.
003226           15 filler                   pic x(16)
003228              value 'resp2'.
003230           15 verify-resp2             pic +999,999,999.
003232           15 filler                   pic x(04) value spaces.
003234           15 filler                   pic x(16)
003236              value 'userid'.
003238           15 verify-userid            pic x(08).
003240           15 filler                   pic x(08) value spaces.
003242           15 filler                   pic x(16)
003244              value 'password'.
003246           15 verify-password          pic x(08).
003248           15 filler                   pic x(08) value spaces.
003250           15 filler                   pic x(16)
003252              value 'daysleft'.
003254           15 verify-daysleft          pic +999,999,999.
003256           15 filler                   pic x(04) value spaces.
003258     05 ws-offsets-t.
003260        10 offsets.
003262           15 filler                   pic x(04)
003264              value 'Stru'.
003266           15 filler                   pic x(01) value space.
003268           15 strucid                  pic x(04).
003270           15 filler                   pic x(07) value spaces.
003272           15 filler                   pic x(16)
003274              value 'ver'.
003276           15 version                  pic +9(09).
003278           15 filler                   pic x(06) value spaces.
003280           15 filler                   pic x(16)
003282              value 'slen'.
003284           15 struclen                 pic +9(09).
003286           15 filler                   pic x(06) value spaces.
003288           15 filler                   pic x(16)
003290              value 'MWIH offset'.
003292           15 msg-hdr-offset-i         pic +9(09).
003294           15 filler                   pic x(06) value spaces.
003296           15 filler                   pic x(16)
003298              value 'MWIH-e offset'.
003300           15 msg-hdr-ext-offset-i     pic +9(09).
003302           15 filler                   pic x(06) value spaces.
003304           15 filler                   pic x(16)
003306              value 'FMTH offset'.
003308           15 fmt-hdr-offset-i         pic +9(09).
003310           15 filler                   pic x(06) value spaces.
003312           15 filler                   pic x(16)
003314              value 'REQH offset'.
003316           15 ebiz-req-hdr-offset-i    pic +9(09).
003318           15 filler                   pic x(06) value spaces.
003320           15 filler                   pic x(16)
003322              value 'REQD offset'.
003324           15 ebiz-req-data-offset-i   pic +9(09).
003326           15 filler                   pic x(06) value spaces.
003328           15 filler                   pic x(16)
003330              value 'MWIH offset'.
003332           15 msg-hdr-offset-o         pic +9(09).
003334           15 filler                   pic x(06) value spaces.
003336           15 filler                   pic x(16)
003338              value 'FMTH offset'.
003340           15 fmt-hdr-offset-o         pic +9(09).
003342           15 filler                   pic x(06) value spaces.
003344           15 filler                   pic x(16)
003346              value 'REPH offset'.
003348           15 ebiz-rep-hdr-offset-o    pic +9(09).
003350           15 filler                   pic x(06) value spaces.
003352           15 filler                   pic x(16)
003354              value 'REPD offset'.
003356           15 ebiz-rep-data-offset-o   pic +9(09).
003358           15 filler                   pic x(06) value spaces.
003360 01  ws-mq-recs-t.
003362     05 ws-mqclose-t.
003364        10 mqclose-t.
003366           15 filler                   pic x(16)
003368             value 'Call MQCLOSE'.
003370            15 mqclose-status          pic x(06).
003372              88 mqclose-after-88            value 'after '.
003374              88 mqclose-before-88           value 'before'.
003376              88 mqclose-error-88            value 'error '.
003378           15 filler                   pic x(10) value spaces.
003380           15 filler                   pic x(16)
003382              value 'Hconn'.
003384           15 mqclose-hconn            pic +999,999,999.
003386           15 filler                   pic x(04) value spaces.
003388           15 filler                   pic x(16)
003390              value 'Hobj'.
003392           15 mqclose-q-handle         pic +999,999,999.
003394           15 filler                   pic x(04) value spaces.
003396           15 filler                   pic x(16)
003398              value 'Options'.
003400           15 mqclose-options          pic +999,999,999.
003402           15 filler                   pic x(04) value spaces.
003404           15 filler                   pic x(16)
003406              value 'CompCode'.
003408           15 mqclose-comp-code        pic +999,999,999.
003410           15 filler                   pic x(04) value spaces.
003412           15 filler                   pic x(16)
003414              value 'Reason'.
003416           15 mqclose-reason           pic +999,999,999.
003418           15 filler                   pic x(04) value spaces.
003420     05 ws-mqget-t.
003422        10 mqget-t.
003424           15 filler                   pic x(16)
003426             value 'Call MQGET'.
003428           15 mqget-status             pic x(06).
003430              88 mqget-after-88              value 'after '.
003432              88 mqget-before-88             value 'before'.
003434              88 mqget-error-88              value 'error '.
003436           15 filler                   pic x(10) value spaces.
003438           15 filler                   pic x(16)
003440              value 'Hconn'.
003442           15 mqget-hconn              pic +999,999,999.
003444           15 filler                   pic x(04) value spaces.
003446           15 filler                   pic x(16)
003448              value 'Hobj'.
003450           15 mqget-q-handle           pic +999,999,999.
003452           15 filler                   pic x(04) value spaces.
003454           15 filler                   pic x(32)
003456              value 'MsgDesc         next trace rec'.
003458           15 filler                   pic x(32)
003460              value 'GetMsgOpts      next trace rec'.
003462           15 filler                   pic x(16)
003464              value 'BufferLength'.
003466           15 mqget-buffer-lenf        pic +999,999,999.
003468           15 filler                   pic x(04) value spaces.
003470           15 filler                   pic x(32)
003472              value 'Buffer          next trace rec'.
003474           15 filler                   pic x(16)
003476              value 'Datalength'.
003478           15 mqget-data-lenf          pic +999,999,999.
003480           15 filler                   pic x(04) value spaces.
003482           15 filler                   pic x(16)
003484              value 'CompCode'.
003486           15 mqget-comp-code          pic +999,999,999.
003488           15 filler                   pic x(04) value spaces.
003490           15 filler                   pic x(16)
003492              value 'Reason'.
003494           15 mqget-reason             pic +999,999,999.
003496           15 filler                   pic x(04) value spaces.
003498     05 ws-mqopen-t.
003500        10 mqopen-t.
003502           15 filler                   pic x(16)
003504             value 'Call MQOPEN'.
003506           15 mqopen-status            pic x(06).
003508              88 mqopen-after-88             value 'after '.
003510              88 mqopen-before-88            value 'before'.
003512              88 mqopen-error-88             value 'error '.
003514           15 filler                   pic x(10) value spaces.
003516           15 filler                   pic x(16)
003518              value 'Hconn'.
003520           15 mqopen-hconn             pic +999,999,999.
003522           15 filler                   pic x(04) value spaces.
003524           15 filler                   pic x(32)
003526              value 'ObjDesc         next trace rec'.
003528           15 filler                   pic x(16)
003530              value 'Options'.
003532           15 mqopen-options           pic +999,999,999.
003534           15 filler                   pic x(04) value spaces.
003536           15 filler                   pic x(16)
003538              value 'Hobj'.
003540           15 mqopen-q-handle          pic +999,999,999.
003542           15 filler                   pic x(04) value spaces.
003544           15 filler                   pic x(16)
003546              value 'CompCode'.
003548           15 mqopen-comp-code         pic +999,999,999.
003550           15 filler                   pic x(04) value spaces.
003552           15 filler                   pic x(16)
003554              value 'Reason'.
003556           15 mqopen-reason            pic +999,999,999.
003558           15 filler                   pic x(04) value spaces.
003560     05 ws-cmqodv-t.
003562        10 mqod-trace.
003564           15 filler                   pic x(16)
003566             value 'Stru CMQODV'.
003568           15 filler                   pic x(16)
003570              value 'strucid'.
003572           15 mqod-strucid             pic x(04).
003574           15 filler                   pic x(12) value spaces.
003576           15 filler                   pic x(16)
003578              value 'version'.
003580           15 mqod-version             pic +999,999,999.
003582           15 filler                   pic x(04) value spaces.
003584           15 filler                   pic x(16)
003586              value 'objecttype'.
003588           15 mqod-objecttype          pic +999,999,999.
003590           15 filler                   pic x(04) value spaces.
003592           15 filler                   pic x(16)
003594              value 'objectname'.
003596           15 mqod-objectname          pic x(48).
003598           15 filler                   pic x(16) value spaces.
003600           15 filler                   pic x(16)
003602              value 'objectqmgrname'.
003604           15 mqod-objectqmgrname      pic x(48).
003606           15 filler                   pic x(16) value spaces.
003608           15 filler                   pic x(16)
003610              value 'dynamicqname'.
003612           15 mqod-dynamicqname        pic x(48).
003614           15 filler                   pic x(16) value spaces.
003616           15 filler                   pic x(16)
003618              value 'alternateuserid'.
003620           15 mqod-alternateuserid     pic x(12).
003622           15 filler                   pic x(04) value spaces.
003624           15 filler                   pic x(16)
003626              value 'recspresent'.
003628           15 mqod-recspresent         pic +999,999,999.
003630           15 filler                   pic x(04) value spaces.
003632           15 filler                   pic x(16)
003634              value 'knowndestcount'.
003636           15 mqod-knowndestcount      pic +999,999,999.
003638           15 filler                   pic x(04) value spaces.
003640           15 filler                   pic x(16)
003642              value 'unknowndestcount'.
003644           15 mqod-unknowndestcount    pic +999,999,999.
003646           15 filler                   pic x(04) value spaces.
003648           15 filler                   pic x(16)
003650              value 'invaliddestcount'.
003652           15 mqod-invaliddestcount    pic x(04).
003654           15 filler                   pic x(12) value spaces.
003656           15 filler                   pic x(16)
003658              value 'objectrecoffset'.
003660           15 mqod-objectrecoffset     pic +999,999,999.
003662           15 filler                   pic x(04) value spaces.
003664           15 filler                   pic x(16)
003666              value 'responserecoffse'.
003668           15 mqod-responserecoffset   pic +999,999,999.
003670           15 filler                   pic x(04) value spaces.
003672           15 filler                   pic x(16)
003674              value 'objectrecptr'.
003676           15 mqod-objectrecptr        usage pointer.
003678           15 filler                   pic x(12) value spaces.
003680           15 filler                   pic x(16)
003682              value 'responserecptr'.
003684           15 mqod-responserecptr      usage pointer.
003686           15 filler                   pic x(12) value spaces.
003688           15 filler                   pic x(16)
003690              value 'alternatesecurit'.
003692           15 mqod-alternatesecurityid pic x(40).
003694           15 filler                   pic x(08) value spaces.
003696           15 filler                   pic x(16)
003698              value 'resolvedqname'.
003700           15 mqod-resolvedqname       pic x(48).
003702           15 filler                   pic x(16) value spaces.
003704           15 filler                   pic x(16)
003706              value 'resolvedqmgrname'.
003708           15 mqod-resolvedqmgrname    pic x(48).
003710           15 filler                   pic x(16) value spaces.
003712     05 ws-cmqmdv-t.
003714        10 mqmd-trace.
003716           15 filler                   pic x(16)
003718             value 'Stru CMQPMOV'.
003720           15 filler                   pic x(16)
003722              value 'strucid'.
003724           15 mqmd-strucid             pic x(04).
003726           15 filler                   pic x(12) value spaces.
003728           15 filler                   pic x(16)
003730              value 'version'.
003732           15 mqmd-version             pic +999,999,999.
003734           15 filler                   pic x(04) value spaces.
003736           15 filler                   pic x(16)
003738              value 'report'.
003740           15 mqmd-report              pic +999,999,999.
003742           15 filler                   pic x(04) value spaces.
003744           15 filler                   pic x(16)
003746              value 'msgtype'.
003748           15 mqmd-msgtype             pic +999,999,999.
003750           15 filler                   pic x(04) value spaces.
003752           15 filler                   pic x(16)
003754              value 'expiry'.
003756           15 mqmd-expiry              pic +999,999,999.
003758           15 filler                   pic x(04) value spaces.
003760           15 filler                   pic x(16)
003762              value 'feedback'.
003764           15 mqmd-feedback            pic +999,999,999.
003766           15 filler                   pic x(04) value spaces.
003768           15 filler                   pic x(16)
003770              value 'encoding'.
003772           15 mqmd-encoding            pic +999,999,999.
003774           15 filler                   pic x(04) value spaces.
003776           15 filler                   pic x(16)
003778              value 'codedcharsetid'.
003780           15 mqmd-codedcharsetid      pic +999,999,999.
003782           15 filler                   pic x(04) value spaces.
003784           15 filler                   pic x(16)
003786              value 'format'.
003788           15 mqmd-format              pic x(08).
003790           15 filler                   pic x(08) value spaces.
003792           15 filler                   pic x(16)
003794              value 'priority'.
003796           15 mqmd-priority            pic +999,999,999.
003798           15 filler                   pic x(04) value spaces.
003800           15 filler                   pic x(16)
003802              value 'persistence'.
003804           15 mqmd-persistence         pic +999,999,999.
003806           15 filler                   pic x(04) value spaces.
003808           15 filler                   pic x(16)
003810              value 'msgid'.
003812           15 mqmd-msgid               pic x(24).
003814           15 filler                   pic x(08) value spaces.
003816           15 filler                   pic x(16)
003818              value 'correlid'.
003820           15 mqmd-correlid            pic x(24).
003822           15 filler                   pic x(08) value spaces.
003824           15 filler                   pic x(16)
003826              value 'backoutcount'.
003828           15 mqmd-backoutcount        pic +999,999,999.
003830           15 filler                   pic x(04) value spaces.
003832           15 filler                   pic x(16)
003834              value 'replytoq'.
003836           15 mqmd-replytoq            pic x(48).
003838           15 filler                   pic x(16) value spaces.
003840           15 filler                   pic x(16)
003842              value 'replytoqmgr'.
003844           15 mqmd-replytoqmgr         pic x(48).
003846           15 filler                   pic x(16) value spaces.
003848           15 filler                   pic x(16)
003850              value 'useridentifier'.
003852           15 mqmd-useridentifier      pic x(12).
003854           15 filler                   pic x(04) value spaces.
003856           15 filler                   pic x(16)
003858              value 'accountingtoken'.
003860           15 mqmd-accountingtoken     pic x(32).
003862           15 filler                   pic x(16) value spaces.
003864           15 filler                   pic x(16)
003866              value 'applidentitydata'.
003868           15 mqmd-applidentitydata    pic x(32).
003870           15 filler                   pic x(16) value spaces.
003872           15 filler                   pic x(16)
003874              value 'putappltype'.
003876           15 mqmd-putappltype         pic +999,999,999.
003878           15 filler                   pic x(04) value spaces.
003880           15 filler                   pic x(16)
003882              value 'putapplname'.
003884           15 mqmd-putapplname         pic x(28).
003886           15 filler                   pic x(04) value spaces.
003888           15 filler                   pic x(16)
003890              value 'putdate'.
003892           15 mqmd-putdate             pic x(08).
003894           15 filler                   pic x(08) value spaces.
003896           15 filler                   pic x(16)
003898              value 'puttime'.
003900           15 mqmd-puttime             pic x(08).
003902           15 filler                   pic x(08) value spaces.
003904           15 filler                   pic x(16)
003906              value 'applorigindata'.
003908           15 mqmd-applorigindata      pic x(04).
003910           15 filler                   pic x(12) value spaces.
003912     05 ws-cmqgmov-t.
003914        10 cmqgmov-t.
003916           15 filler                   pic x(16)
003918             value 'Stru CMQGMOV'.
003920           15 filler                   pic x(16)
003922              value 'strucid'.
003924           15 mqgmo-strucid            pic x(04).
003926           15 filler                   pic x(12) value spaces.
003928           15 filler                   pic x(16)
003930              value 'version'.
003932           15 mqgmo-version            pic +999,999,999.
003934           15 filler                   pic x(04) value spaces.
003936           15 filler                   pic x(16)
003938              value 'options'.
003940           15 mqgmo-options            pic +999,999,999.
003942           15 filler                   pic x(04) value spaces.
003944           15 filler                   pic x(16)
003946              value 'waitinterval'.
003948           15 mqgmo-waitinterval       pic +999,999,999.
003950           15 filler                   pic x(04) value spaces.
003952           15 filler                   pic x(16)
003954              value 'signal1'.
003956           15 mqgmo-signal1            pic +999,999,999.
003958           15 filler                   pic x(04) value spaces.
003960           15 filler                   pic x(16)
003962              value 'signal2'.
003964           15 mqgmo-signal2            pic +999,999,999.
003966           15 filler                   pic x(04) value spaces.
003968           15 filler                   pic x(16)
003970              value 'resolvedqname'.
003972           15 mqgmo-resolvedqname      pic x(48).
003974           15 filler                   pic x(16) value spaces.
003976           15 filler                   pic x(16)
003978              value 'matchoptions'.
003980           15 mqgmo-matchoptions       pic +999,999,999.
003982           15 filler                   pic x(04) value spaces.
003984           15 filler                   pic x(16)
003986              value 'groupstatus'.
003988           15 mqgmo-groupstatus        pic x(01).
003990           15 filler                   pic x(15) value spaces.
003992           15 filler                   pic x(16)
003994              value 'segmentstatus'.
003996           15 mqgmo-segmentstatus      pic x(01).
003998           15 filler                   pic x(15) value spaces.
004000           15 filler                   pic x(16)
004002              value 'segmentation'.
004004           15 mqgmo-segmentation       pic x(01).
004006           15 filler                   pic x(15) value spaces.
004008           15 filler                   pic x(16)
004010              value 'reserved1'.
004012           15 mqgmo-reserved1          pic x(01).
004014           15 filler                   pic x(15) value spaces.
004016           15 filler                   pic x(16)
004018              value 'msgtoken'.
004020           15 mqgmo-msgtoken           pic x(16).
004022           15 filler                   pic x(16)
004024              value 'returnedlength'.
004026           15 mqgmo-returnedlength     pic +999,999,999.
004028           15 filler                   pic x(04) value spaces.
004030     05 ws-cmqpmov-t.
004032        10 cmqpmov-t.
004034           15 filler                   pic x(16)
004036             value 'Stru CMQPMOV'.
004038           15 filler                   pic x(16)
004040              value 'strucid'.
004042           15 mqpmo-strucid            pic x(04).
004044           15 filler                   pic x(12) value spaces.
004046           15 filler                   pic x(16)
004048              value 'version'.
004050           15 mqpmo-version            pic +999,999,999.
004052           15 filler                   pic x(04) value spaces.
004054           15 filler                   pic x(16)
004056              value 'options'.
004058           15 mqpmo-options            pic +999,999,999.
004060           15 filler                   pic x(04) value spaces.
004062           15 filler                   pic x(16)
004064              value 'timeout'.
004066           15 mqpmo-timeout            pic +999,999,999.
004068           15 filler                   pic x(04) value spaces.
004070           15 filler                   pic x(16)
004072              value 'context'.
004074           15 mqpmo-context            pic +999,999,999.
004076           15 filler                   pic x(04) value spaces.
004078           15 filler                   pic x(16)
004080              value 'knowndestcount'.
004082           15 mqpmo-knowndestcount     pic +999,999,999.
004084           15 filler                   pic x(04) value spaces.
004086           15 filler                   pic x(16)
004088              value 'unknowndestcount'.
004090           15 mqpmo-unknowndestcount   pic +999,999,999.
004092           15 filler                   pic x(04) value spaces.
004094           15 filler                   pic x(16)
004096              value 'invaliddestcount'.
004098           15 mqpmo-invaliddestcount   pic +999,999,999.
004100           15 filler                   pic x(04) value spaces.
004102           15 filler                   pic x(16)
004104              value 'resolvedqname'.
004106           15 mqpmo-resolvedqname      pic x(48).
004108           15 filler                   pic x(16) value spaces.
004110           15 filler                   pic x(16)
004112              value 'resolvedqmgrname'.
004114           15 mqpmo-resolvedqmgrname   pic x(48).
004116           15 filler                   pic x(16) value spaces.
004118     05 ws-cmqtml-t.
004120        10 mqtm-trace.
004122           15 filler                   pic x(16)
004124              value 'Stru CMQTML'.
004126           15 filler                   pic x(16)
004128              value 'strucid'.
004130           15 mqtm-strucid             pic x(04).
004132           15 filler                   pic x(12) value spaces.
004134           15 filler                   pic x(16)
004136              value 'version'.
004138           15 mqtm-version             pic +999,999,999.
004140           15 filler                   pic x(04) value spaces.
004142           15 filler                   pic x(16)
004144              value 'qname'.
004146           15 mqtm-qname               pic x(48).
004148           15 filler                   pic x(16) value spaces.
004150           15 filler                   pic x(16)
004152              value 'processname'.
004154           15 mqtm-processname         pic x(48).
004156           15 filler                   pic x(16) value spaces.
004158           15 filler                   pic x(16)
004160              value 'triggerdata'.
004162           15 mqtm-triggerdata         pic x(64).
004164           15 filler                   pic x(16) value spaces.
004166           15 filler                   pic x(16)
004168              value 'appltype'.
004170           15 mqtm-appltype            pic +999,999,999.
004172           15 filler                   pic x(04) value spaces.
004174           15 filler                   pic x(16)
004176              value 'applid'.
004178           15 mqtm-applid              pic x(256).
004180           15 filler                   pic x(16) value spaces.
004182           15 filler                   pic x(16)
004184              value 'envdata'.
004186           15 mqtm-envdata             pic x(128).
004188           15 filler                   pic x(16) value spaces.
004190           15 filler                   pic x(16)
004192              value 'userdata'.
004194           15 mqtm-userdata            pic x(128).
004196           15 filler                   pic x(16) value spaces.
004198 01  ws-footprint-pos                  pic s9(8) comp.
004200 01  ws-footprint-rulefile-ctr         pic s9(8) comp.
004202 01  ws-footprint-rulefile-table.
004204     05  ws-footprint-rulefile-row     occurs 18.
004206         15  ws-footprint-rulefile     pic X(80).
004208 LINKAGE SECTION.
004210 01  dfhcommarea.
004212     05 filler                         pic x(01)
004214                                       occurs 1 to 32767
004216                                       depending on eibcalen.
004218
004220 01  lk-msg-partial                    pic x(01).
004222
004224 01  lk-req-msg                        pic x(01).
004226
004228 01  lk-msg-hdr-i.
004230     10 msg-hdr.
004232*       Record size is 212 bytes
004234        15 message-encoding            pic x(04).
004236        15 msg-encoding                redefines
004238           message-encoding            pic x(04).
004240        15 msg-sequence-num            pic x(04).
004242        15 msg-xmit-time               pic x(18).
004244        15 trace-flags                 pic x(02).
004246        15 msg-max-length              pic x(10).
004248        15 msg-max-length-numeric      redefines
004250           msg-max-length              pic 9(10).
004252        15 appl-msg-length             pic x(10).
004254        15 appl-msg-length-numeric     redefines
004256           appl-msg-length             pic 9(10).
004258        15 trace-ts-q                  pic x(08).
004260        15 useridx                     pic x(08).
004262        15 passwordx                   pic x(16).
004264        15 public-key                  pic x(16).
004266        15 sessionid                   pic x(24).
004268        15 function-code               pic x(02).
004270        15 secondary-func-code         pic x(02).
004272        15 resource-url                pic x(32).
004274        15 middleware-parms.
004276           20 mq-put-msg-expiry        pic x(09).
004278           20 mq-get-msg-wait          pic x(09).
004280           20 mq-persistence-flag      pic x(01).
004282           20 filler                   pic x(13).
004284        15 cics-verify                 pic x(01).
004286        15 message-exit                pic x(01).
004288        15 ebiz-type                   pic x(01).
004290        15 reserved                    pic x(13).
004292        15 return-codex                pic x(04).
004294        15 reason-codex                pic x(04).
004296
004298 01  lk-msg-hdr-ext-i.
004300     10 msg-hdr-ext.
004302*       Record size is 300 bytes
004304        15 to-upgm-qmgr-name           pic x(48).
004306        15 to-upgm-qname               pic x(48).
004308        15 to-upgm-queue-nbr           pic x(03).
004310        15 to-upgm-expiry              pic x(08).
004312        15 to-upgm-wait-interval       pic x(08).
004314        15 to-upgm-persistent          pic x(01).
004316        15 from-upgm-qmgr-name         pic x(48).
004318        15 from-upgm-qname             pic x(48).
004320        15 from-upgm-queue-nbr         pic x(03).
004322        15 from-upgm-expiry            pic x(08).
004324        15 from-upgm-wait-interval     pic x(08).
004326        15 from-upgm-persistent        pic x(01).
004328        15 mq03-alt-name               pic x(08).
004330        15 reserved                    pic x(60).
004332
004334 01  lk-fmt-hdr-i.
004336     10 fmt-hdr.
004338*       Record size is 37 bytes
004340        15 version                     pic 9(04).
004342        15 codepage                    pic 9(04).
004344           88 formater-none-88               value 0.
004346           88 formater-native-88             value 1.
004348           88 formater-string-88             value 2.
004350           88 formater-xml-88                value 3.
004352        15 encoding-format             pic 9(02).
004354        15 platform                    pic 9(02).
004356        15 message-length              pic x(10).
004358        15 message-length-numeric      redefines
004360           message-length              pic 9(10).
004362        15 filler1                     pic 9(05).
004364        15 formatter-trace-flag        pic 9(01).
004366        15 trace-flags                 pic 9(01).
004368        15 trace-ts-q                  pic x(08).
004370
004372 01  lk-fmt-hdr-c.
004374     10 fmt-hdr.
004376*       Record size is 32 bytes
004378        15 version                     pic 9(04).
004380        15 codepage                    pic 9(04).
004382           88 formater-none-88               value 0.
004384           88 formater-native-88             value 1.
004386           88 formater-string-88             value 2.
004388           88 formater-xml-88                value 3.
004390        15 encoding-format             pic 9(02).
004392        15 platform                    pic 9(02).
004394        15 message-length              pic 9(05).
004396        15 filler1                     pic 9(05).
004398        15 formatter-trace-flag        pic 9(01).
004400        15 trace-flags                 pic 9(01).
004402        15 trace-ts-q                  pic x(08).
004404
004406 01  lk-ebiz-req-hdr-i.
004408     10 ebiz-req-hdr.
004410*       Record size is 26 bytes
004412        15 useridx                     pic x(08).
004414        15 passwordx                   pic x(08).
004416        15 facilitylike                pic x(04).
004418        15 recovery-step               pic 9(03).
004420        15 recovery-flag               pic 9(01).
004422           88 rcv-last-88                    value 1.
004424           88 rcv-in-doubt-88                value 2.
004426        15 filler                      pic x(02).
004428
004430 01  lk-msg-hdr-o.
004432     10 msg-hdr.
004434*       Record size is 212 bytes
004436        15 message-encoding            pic x(04).
004438        15 msg-encoding                redefines
004440           message-encoding            pic x(04).
004442        15 msg-sequence-num            pic x(04).
004444        15 msg-xmit-time               pic x(18).
004446        15 trace-flags                 pic x(02).
004448        15 msg-max-length              pic x(10).
004450        15 msg-max-length-numeric      redefines
004452           msg-max-length              pic 9(10).
004454        15 appl-msg-length             pic x(10).
004456        15 appl-msg-length-numeric     redefines
004458           appl-msg-length             pic 9(10).
004460        15 trace-ts-q                  pic x(08).
004462        15 useridx                     pic x(08).
004464        15 passwordx                   pic x(16).
004466        15 public-key                  pic x(16).
004468        15 sessionid                   pic x(24).
004470        15 function-code               pic x(02).
004472        15 secondary-func-code         pic x(02).
004474        15 resource-url                pic x(32).
004476        15 middleware-parms.
004478           20 mq-put-msg-expiry        pic x(09).
004480           20 mq-get-msg-wait          pic x(09).
004482           20 mq-persistence-flag      pic x(01).
004484           20 filler                   pic x(13).
004486        15 cics-verify                 pic x(01).
004488        15 message-exit                pic x(01).
004490        15 ebiz-type                   pic x(01).
004492        15 reserved                    pic x(13).
004494        15 return-codex                pic x(04).
004496        15 reason-codex                pic x(04).
004498
004500 01  lk-fmt-hdr-o.
004502     10 fmt-hdr.
004504*       Record size is 37 bytes
004506        15 version                     pic 9(04).
004508        15 codepage                    pic 9(04).
004510           88 formater-none-88               value 0.
004512           88 formater-native-88             value 1.
004514           88 formater-string-88             value 2.
004516           88 formater-xml-88                value 3.
004518        15 encoding-format             pic 9(02).
004520        15 platform                    pic 9(02).
004522        15 message-length              pic x(10).
004524        15 message-length-numeric      redefines
004526           message-length              pic 9(10).
004528        15 filler1                     pic 9(05).
004530        15 formatter-trace-flag        pic 9(01).
004532        15 trace-flags                 pic 9(01).
004534        15 trace-ts-q                  pic x(08).
004536
004538 01  lk-ebiz-rep-hdr-o.
004540     10 ebiz-rep-hdr.
004542*       Record size is 128 bytes
004544        15 target                      pic x(32).
004546        15 abendcode                   pic x(04).
004548        15 statusx                     pic 9(04).
004550        15 status-msg                  pic x(80).
004552        15 filler                      pic x(08).
004554
004556 01  lk-ebiz-msg-remainder.
004558     10 ebiz-msg-remainder.
004560        15 msg-remainder               pic x(31788).
004562
004564 01  lk-nwif-t.
004566     03 nwif.
004568*       1,160 bytes in this group
004570        05 nwif-fields.
004572*          16 bytes in this group
004574*          Next field should start on a fullword boundary
004576           10 this-pntr                usage pointer.
004578           10 strucid                  pic x(04).
004580           10 version                  pic s9(08) comp.
004582           10 struclen                 pic s9(08) comp.
004584        05 micro-focus-fields.
004586*          172 bytes in this group
004588           10 mq03-alt-name            pic x(08).
004590           10 trace-level              pic 9(01).
004592           10 trace-level-unused       pic x(03).
004594           10 trace-queue-name         pic x(16).
004596           10 useridx                  pic x(08).
004598           10 ebiz-name                pic x(08).
004600           10 upgm-name                pic x(08).
004602           10 copybook-mode            pic x(04).
004604              88 copybook-mode-is-unk-88     value 'unk '.
004606              88 copybook-mode-is-sam-88     value 'sam '.
004608              88 copybook-mode-is-sep-88     value 'sep '.
004610              88 copybook-mode-is-amb-88     value 'amb '.
004612           10 processing-mode          pic x(04).
004614              88 mode-is-ld-88               value 'lcom'.
004616              88 mode-is-rc-88               value 'rcom'.
004618              88 mode-is-cics-88             value 'cics'.
004620              88 mode-is-ims-88              value 'ims'.
004622           10 security-status          pic x(04).
004624              88 mode-is-security-ok-88      value 'ok'.
004626              88 mode-is-security-error-88   value 'sece'.
004628           10 mf-processing-mode       pic x(04).
004630              88 mf-mode-is-normal-88        value spaces.
004632              88 mf-mode-is-error-88         value 'erro'.
004634           10 mf-abend-program         pic x(08).
004636           10 mf-abend-code            pic x(04).
004638           10 mf-return-code           pic 9(04).
004640           10 mf-reason                pic x(04).
004642           10 mf-msg                   pic x(80).
004644           10 filler                   pic x(04).
004646        05 mqtm-fields.
004648*          128 bytes in this group
004650           10 mqtm-userdata            pic x(128).
004652        05 req-msg-fields.
004654*          196 bytes in this group
004656*          Next field should start on a fullword boundary
004658           10 req-msg-pntr             usage pointer.
004660           10 req-msg-hdr-lenf         pic s9(08) comp.
004662           10 req-msg-hdr-ext-lenf     pic s9(08) comp.
004664           10 req-fmt-hdr-lenf         pic s9(08) comp.
004666           10 req-ebiz-hdr-lenf        pic s9(08) comp.
004668           10 req-ebiz-data-full-lenf  pic s9(08) comp.
004670           10 req-ebiz-data-used-lenf  pic s9(08) comp.
004672           10 req-msg-total-full-lenf  pic s9(08) comp.
004674           10 req-msg-total-used-lenf  pic s9(08) comp.
004676           10 req-msg-mq.
004678              15 req-qmgr-name         pic x(48).
004680              15 req-qname             pic x(48).
004682              15 req-queue-nbr         pic x(04).
004684              15 req-expiry            pic s9(08) comp.
004686              15 req-wait-interval     pic s9(08) comp.
004688              15 req-persistent        pic x(04).
004690              15 req-msgid             pic x(24).
004692              15 req-correlid          pic x(24).
004694        05 rep-msg-fields.
004696*          200 bytes in this group
004698*          Next field should start on a fullword boundary
004700           10 rep-msg-pntr             usage pointer.
004702           10 rep-msg-lenf             pic s9(08) comp.
004704           10 rep-msg-hdr-lenf         pic s9(08) comp.
004706           10 rep-fmt-hdr-lenf         pic s9(08) comp.
004708           10 rep-ebiz-hdr-lenf        pic s9(08) comp.
004710           10 rep-ebiz-data-full-lenf  pic s9(08) comp.
004712           10 rep-ebiz-data-used-lenf  pic s9(08) comp.
004714           10 rep-msg-total-full-lenf  pic s9(08) comp.
004716           10 rep-msg-total-used-lenf  pic s9(08) comp.
004718           10 rep-msg-mq.
004720              15 rep-qmgr-name         pic x(48).
004722              15 rep-qname             pic x(48).
004724              15 rep-queue-nbr         pic x(04).
004726              15 rep-expiry            pic s9(08) comp.
004728              15 rep-wait-interval     pic s9(08) comp.
004730              15 rep-persistent        pic x(04).
004732              15 rep-msgid             pic x(24).
004734              15 rep-correlid          pic x(24).
004736           10 filler                   pic x(04).
004738        05 to-upgm-fields.
004740*          176 bytes in this group
004742*          Next field should start on a fullword boundary
004744           10 to-upgm-bfr-pntr         usage pointer.
004746           10 to-upgm-bfr-full-lenf    pic s9(08) comp.
004748           10 to-upgm-bfr-used-lenf    pic s9(08) comp.
004750           10 to-upgm-mq.
004752              15 to-upgm-qmgr-name     pic x(48).
004754              15 to-upgm-qname         pic x(48).
004756              15 to-upgm-queue-nbr     pic x(04).
004758              15 to-upgm-expiry        pic s9(08) comp.
004760              15 to-upgm-wait-interval pic s9(08) comp.
004762              15 to-upgm-persistent    pic x(04).
004764              15 to-upgm-msgid         pic x(24).
004766              15 to-upgm-correlid      pic x(24).
004768           10 filler                   pic x(04).
004770        05 from-upgm-fields.
004772*          272 bytes in this group
004774*          Next field should start on a fullword boundary
004776           10 from-upgm-bfr-pntr       usage pointer.
004778           10 from-upgm-bfr-full-lenf  pic s9(08) comp.
004780           10 from-upgm-bfr-used-lenf  pic s9(08) comp.
004782           10 from-upgm-mq.
004784              15 from-upgm-qmgr-name   pic x(48).
004786              15 from-upgm-qname       pic x(48).
004788              15 from-upgm-queue-nbr   pic x(04).
004790              15 from-upgm-expiry      pic s9(08) comp.
004792              15 from-upgm-wait-interval
004794                                       pic s9(08) comp.
004796              15 from-upgm-persistent  pic x(04).
004798              15 from-upgm-msgid       pic x(24).
004800              15 from-upgm-correlid    pic x(24).
004802           10 from-upgm-fields-aux.
004804              15 from-upgm-processing-mode
004806                                       pic x(04).
004808                 88 from-upgm-mode-is-normal-88  value spaces.
004810                 88 from-upgm-mode-is-error-88   value 'erro'.
004812              15 from-upgm-abend-program
004814                                       pic x(04).
004816              15 from-upgm-abend-code  pic x(04).
004818              15 from-upgm-return-code pic 9(04).
004820              15 from-upgm-reason      pic x(04).
004822              15 from-upgm-msg         pic x(80).
004824
004826 01  lk-clif-t.
004828     03 clif.
004830        05  trace-levelx               pic x(01).
004832        05  trace-level                redefines
004834            trace-levelx               pic 9(01).
004836        05  trace-queue-name           pic x(16).
004838        05  cmqmdv-copybook.
004840            copy cmqmdv.
004842        05  cmqtml-copybook.
004844            copy cmqtml.
004846
004848 01  lk-msg-hdr-t.
004850     10 msg-hdr.
004852*       Record size is 212 bytes
004854        15 message-encoding            pic x(04).
004856        15 msg-encoding                redefines
004858           message-encoding            pic x(04).
004860        15 msg-sequence-num            pic x(04).
004862        15 msg-xmit-time               pic x(18).
004864        15 trace-flags                 pic x(02).
004866        15 msg-max-length              pic x(10).
004868        15 msg-max-length-numeric      redefines
004870           msg-max-length              pic 9(10).
004872        15 appl-msg-length             pic x(10).
004874        15 appl-msg-length-numeric     redefines
004876           appl-msg-length             pic 9(10).
004878        15 trace-ts-q                  pic x(08).
004880        15 useridx                     pic x(08).
004882        15 passwordx                   pic x(16).
004884        15 public-key                  pic x(16).
004886        15 sessionid                   pic x(24).
004888        15 function-code               pic x(02).
004890        15 secondary-func-code         pic x(02).
004892        15 resource-url                pic x(32).
004894        15 middleware-parms.
004896           20 mq-put-msg-expiry        pic x(09).
004898           20 mq-get-msg-wait          pic x(09).
004900           20 mq-persistence-flag      pic x(01).
004902           20 filler                   pic x(13).
004904        15 cics-verify                 pic x(01).
004906        15 message-exit                pic x(01).
004908        15 ebiz-type                   pic x(01).
004910        15 reserved                    pic x(13).
004912        15 return-codex                pic x(04).
004914        15 reason-codex                pic x(04).
004916
004918 01  lk-msg-hdr-ext-t.
004920     10 msg-hdr-ext.
004922*       Record size is 300 bytes
004924        15 to-upgm-qmgr-name           pic x(48).
004926        15 to-upgm-qname               pic x(48).
004928        15 to-upgm-queue-nbr           pic x(03).
004930        15 to-upgm-expiry              pic x(08).
004932        15 to-upgm-wait-interval       pic x(08).
004934        15 to-upgm-persistent          pic x(01).
004936        15 from-upgm-qmgr-name         pic x(48).
004938        15 from-upgm-qname             pic x(48).
004940        15 from-upgm-queue-nbr         pic x(03).
004942        15 from-upgm-expiry            pic x(08).
004944        15 from-upgm-wait-interval     pic x(08).
004946        15 from-upgm-persistent        pic x(01).
004948        15 mq03-alt-name               pic x(08).
004950        15 reserved                    pic x(60).
004952
004954 01  lk-fmt-hdr-t.
004956     10 fmt-hdr.
004958*       Record size is 37 bytes
004960        15 version                     pic 9(04).
004962        15 codepage                    pic 9(04).
004964           88 formater-none-88               value 0.
004966           88 formater-native-88             value 1.
004968           88 formater-string-88             value 2.
004970           88 formater-xml-88                value 3.
004972        15 encoding-format             pic 9(02).
004974        15 platform                    pic 9(02).
004976        15 message-length              pic x(10).
004978        15 message-length-numeric      redefines
004980           message-length              pic 9(10).
004982        15 filler1                     pic 9(05).
004984        15 formatter-trace-flag        pic 9(01).
004986        15 trace-flags                 pic 9(01).
004988        15 trace-ts-q                  pic x(08).
004990
004992 01  lk-fmt-hdr-c-t.
004994     10 fmt-hdr.
004996*       Record size is 32 bytes
004998        15 version                     pic 9(04).
005000        15 codepage                    pic 9(04).
005002           88 formater-none-88               value 0.
005004           88 formater-native-88             value 1.
005006           88 formater-string-88             value 2.
005008           88 formater-xml-88                value 3.
005010        15 encoding-format             pic 9(02).
005012        15 platform                    pic 9(02).
005014        15 message-length              pic 9(05).
005016        15 filler1                     pic 9(05).
005018        15 formatter-trace-flag        pic 9(01).
005020        15 trace-flags                 pic 9(01).
005022        15 trace-ts-q                  pic x(08).
005024
005026 01  lk-ebiz-req-hdr-t.
005028     10 ebiz-req-hdr.
005030*       Record size is 26 bytes
005032        15 useridx                     pic x(08).
005034        15 passwordx                   pic x(08).
005036        15 facilitylike                pic x(04).
005038        15 recovery-step               pic 9(03).
005040        15 recovery-flag               pic 9(01).
005042           88 rcv-last-88                    value 1.
005044           88 rcv-in-doubt-88                value 2.
005046        15 filler                      pic x(02).
005048
005050 01  lk-ebiz-rep-hdr-t.
005052     10 ebiz-rep-hdr.
005054*       Record size is 128 bytes
005056        15 target                      pic x(32).
005058        15 abendcode                   pic x(04).
005060        15 statusx                     pic 9(04).
005062        15 status-msg                  pic x(80).
005064        15 filler                      pic x(08).
005066
005068 01  lk-msg-hdr-pw                     pic x(01).
005070
005072 01  lk-req-hdr-pw                     pic x(01).
005074
005076 PROCEDURE DIVISION.
005078 
005080 000-main-processing section.
005082     if ws-mf-ti-trace-level >= 1
005084       move 71 to ws-mf-ti-msg-nbr
005086       move '000-main-processing' to ws-mf-ti-data-rec(1:19)
005088       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
005090       move 19 to ws-mf-ti-user-data-len
005092       perform mf-ti-write
005094     end-if
005096     if eibcalen =   2000
005098       and dfhcommarea (1:ws-footprint-header-len) = 'footprint re
005100-          'quest'
005102       perform ebiz-footprint-request-check
005104     end-if
005106     move zero
005108       to mmtm-trace-level           of ws-mmtm-trace-misc
005110     move spaces
005112       to mmtm-trace-queue-name      of ws-mmtm-trace-misc
005114     perform mf-ti-setup
005116     perform 100-setup
005118     perform 100-set-common-pntrs
005120     perform 200-retrieve-start-data
005122     perform 300-open-req-queue
005124     perform 310-process-req-queue
005126     perform 390-close-req-queue
005128     perform 9000-return
005130     .
005132 
005134 100-setup section.
005136     if ws-mf-ti-trace-level >= 1
005138       move 71 to ws-mf-ti-msg-nbr
005140       move '100-setup' to ws-mf-ti-data-rec(1:9)
005142       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
005144       move 9 to ws-mf-ti-user-data-len
005146       perform mf-ti-write
005148     end-if
005150     initialize ws-nwif
005152     set  this-pntr                    of ws-nwif
005154       to null
005156     set  req-msg-pntr                 of ws-nwif
005158       to null
005160     set  req-msg-pntr                 of ws-nwif
005162       to null
005164     set  to-upgm-bfr-pntr             of ws-nwif
005166       to null
005168     set  from-upgm-bfr-pntr           of ws-nwif
005170       to null
005172*    nwif-fields
005174     set this-pntr                     of ws-nwif
005176       to address                      of ws-nwif
005178     move nwif-strucid                 of ws-static-fields
005180       to strucid                      of ws-nwif
005182     move 1
005184       to version                      of ws-nwif
005186     move length                       of ws-nwif
005188       to struclen                     of ws-nwif
005190*    micro-focus-fields
005192     set  mode-is-ld-88                of ws-nwif
005194       to true
005196*    mqtm-fields
005198*    req-msg-fields
005200     move length                       of lk-msg-hdr-i
005202       to req-msg-hdr-lenf             of ws-nwif
005204     move length                       of lk-msg-hdr-ext-i
005206       to req-msg-hdr-ext-lenf         of ws-nwif
005208     move length                       of lk-fmt-hdr-i
005210       to req-fmt-hdr-lenf             of ws-nwif
005212     move length                       of lk-ebiz-req-hdr-i
005214       to req-ebiz-hdr-lenf            of ws-nwif
005216*    rep-msg-fields
005218     move length                       of lk-msg-hdr-o
005220       to rep-msg-hdr-lenf             of ws-nwif
005222     move length                       of lk-fmt-hdr-o
005224       to rep-fmt-hdr-lenf             of ws-nwif
005226     move length                       of lk-ebiz-rep-hdr-o
005228       to rep-ebiz-hdr-lenf            of ws-nwif
005230     initialize ws-mqclose-misc
005232     initialize ws-mqget-misc
005234     initialize ws-mqopen-misc
005236     move length                       of ws-msg-partial
005238       to mqget-buffer-lenf            of ws-mqget-misc
005240     compute mqget-browse-first        of ws-mqget-misc
005242       = mqgmo-wait                    of ws-cmqv-copybook
005244       + mqgmo-browse-first            of ws-cmqv-copybook
005246       + mqgmo-fail-if-quiescing       of ws-cmqv-copybook
005248       + mqgmo-accept-truncated-msg    of ws-cmqv-copybook
005250     compute mqget-browse-next         of ws-mqget-misc
005252       = mqgmo-wait                    of ws-cmqv-copybook
005254       + mqgmo-browse-next             of ws-cmqv-copybook
005256       + mqgmo-fail-if-quiescing       of ws-cmqv-copybook
005258       + mqgmo-accept-truncated-msg    of ws-cmqv-copybook
005260     exit
005262     .
005264 
005266 100-set-common-pntrs section.
005268     if ws-mf-ti-trace-level >= 1
005270       move 71 to ws-mf-ti-msg-nbr
005272       move '100-set-common-pntrs' to ws-mf-ti-data-rec(1:20)
005274       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
005276       move 20 to ws-mf-ti-user-data-len
005278       perform mf-ti-write
005280     end-if
005282     set  address                      of lk-req-msg
005284       to address                      of ws-msg-partial
005286     set  address                      of lk-msg-partial
005288       to address                      of ws-msg-partial
005290     set  address                      of lk-msg-hdr-i
005292       to address                      of lk-msg-partial
005294     set  address                      of lk-nwif-t
005296       to address                      of ws-nwif
005298     exit
005300     .
005302 
005304 200-retrieve-start-data section.
005306     if ws-mf-ti-trace-level >= 1
005308       move 71 to ws-mf-ti-msg-nbr
005310       move '200-retrieve-start-data' to ws-mf-ti-data-rec(1:23)
005312       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
005314       move 23 to ws-mf-ti-user-data-len
005316       perform mf-ti-write
005318     end-if
005320     set  retrieve-before-88           of ws-retrieve-t
005322       to true
005324     move length                       of ws-cmqtml-copybook
005326       to retrieve-length              of ws-retrieve-misc
005328     move zero
005330       to retrieve-resp                of ws-retrieve-misc
005332          retrieve-resp2               of ws-retrieve-misc
005334     move 'ws-cmqtml-copybook'
005336       to retrieve-set                 of ws-retrieve-misc
005338          retrieve-into                of ws-retrieve-misc
005340     move length                       of ws-cmqtml-copybook
005342       to retrieve-length              of ws-retrieve-misc
005344     if ws-mf-ti-trace-level >= 4
005346       perform 7000-retrieve-trace
005348     end-if
005350     exec cics retrieve
005352       resp     ( retrieve-resp        of ws-retrieve-misc )
005354       resp2    ( retrieve-resp        of ws-retrieve-misc )
005356       into     ( ws-cmqtml-copybook                       )
005358       length   ( retrieve-length      of ws-retrieve-misc )
005360       nohandle
005362     end-exec
005364     set  retrieve-after-88            of ws-retrieve-t
005366       to true
005368     evaluate true
005370       when retrieve-resp              of ws-retrieve-misc
005372         = dfhresp ( normal )
005374         continue
005376       when other
005378         set  retrieve-error-88        of ws-retrieve-t
005380           to true
005382         perform 8000-retrieve-error
005384     end-evaluate
005386     if retrieve-length                of ws-retrieve-misc
005388       = length                        of ws-cmqtml-copybook
005390       and mqtm-strucid                of ws-cmqtml-copybook
005392       = 'TM'
005394       continue
005396     else
005398       move spaces
005400         to ws-mf-ti-data-rec-r
005402       string
005404         'Invalid start data passed to program '
005406         this-program                  of ws-static-fields
005408         delimited by size
005410         into ws-mf-ti-data-rec-data-r of ws-mf-ti-data-rec-r
005412       exec cics writeq ts
005414         queue    ( default-traceq     of ws-static-fields    )
005416         from     ( ws-mf-ti-data-rec-r                       )
005418         length   ( length             of ws-mf-ti-data-rec-r )
005420         nohandle
005422       end-exec
005424       move ws-cmqtml-copybook
005426         to ws-mf-ti-data-rec-data-r   of ws-mf-ti-data-rec-r
005428       exec cics writeq ts
005430         queue    ( default-traceq     of ws-static-fields    )
005432         from     ( ws-mf-ti-data-rec-r                       )
005434         length   ( length             of ws-mf-ti-data-rec-r )
005436         nohandle
005438       end-exec
005440       perform 9000-return
005442     end-if
005444     if ws-mf-ti-trace-level >= 4
005446       set  retrieve-after-88          of ws-retrieve-t
005448         to true
005450       perform 7000-retrieve-trace
005452       perform 7000-cmqtml-trace
005454     end-if
005456     exit
005458     .
005460 
005462 300-open-req-queue section.
005464     if ws-mf-ti-trace-level >= 1
005466       move 71 to ws-mf-ti-msg-nbr
005468       move '300-open-req-queue' to ws-mf-ti-data-rec(1:18)
005470       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
005472       move 18 to ws-mf-ti-user-data-len
005474       perform mf-ti-write
005476     end-if
005478     move mqtm-qname                   of ws-cmqtml-copybook
005480       to mqod-objectname              of ws-cmqodv-copybook
005482     move mqot-q                       of ws-cmqv-copybook
005484       to mqod-objecttype              of ws-cmqodv-copybook
005486     compute mqopen-options            of ws-mqopen-misc
005488       = mqoo-input-shared             of ws-cmqv-copybook
005490       + mqoo-browse                   of ws-cmqv-copybook
005492       + mqoo-fail-if-quiescing        of ws-cmqv-copybook
005494     set  mqopen-before-88             of ws-mqopen-t
005496       to true
005498     move mqcc-ok                      of ws-cmqv-copybook
005500       to mqopen-comp-code             of ws-mqopen-misc
005502     move mqcc-ok                      of ws-cmqv-copybook
005504       to mqopen-reason                of ws-mqopen-misc
005506     if ws-mf-ti-trace-level >= 4
005508       perform 7000-cmqodv-trace
005510       perform 7000-mqopen-trace
005512     end-if
005514     call 'mqopen'
005516       using mqopen-hconn              of ws-mqopen-misc
005518             mqod                      of ws-cmqodv-copybook
005520             mqopen-options            of ws-mqopen-misc
005522             mqopen-q-handle           of ws-mqopen-misc
005524             mqopen-comp-code          of ws-mqopen-misc
005526             mqopen-reason             of ws-mqopen-misc
005528     end-call
005530     set  mqopen-after-88              of ws-mqopen-t
005532       to true
005534     if mqopen-comp-code               of ws-mqopen-misc
005536       not = mqcc-ok                   of ws-cmqv-copybook
005538       move this-program               of ws-static-fields
005540         to mf-abend-program           of ws-nwif
005542       move mqopen-failure             of ws-mmtm-abends
005544         to mf-abend-code              of ws-nwif
005546       perform 8000-mqopen-error
005548       perform 9000-return
005550     else
005552       continue
005554     end-if
005556     if ws-mf-ti-trace-level >= 4
005558       perform 7000-mqopen-trace
005560     end-if
005562     move mqopen-q-handle              of ws-mqopen-misc
005564       to mqget-q-handle               of ws-mqget-misc
005566          mqclose-q-handle             of ws-mqclose-misc
005568     exit
005570     .
005572 
005574 310-process-req-queue section.
005576     if ws-mf-ti-trace-level >= 1
005578       move 71 to ws-mf-ti-msg-nbr
005580       move '310-process-req-queue' to ws-mf-ti-data-rec(1:21)
005582       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
005584       move 21 to ws-mf-ti-user-data-len
005586       perform mf-ti-write
005588     end-if
005590     move mqget-browse-first           of ws-mqget-misc
005592       to mqgmo-options                of mqgmo
005594     perform 320-browse-req-msg
005596     perform test before
005598       until mqget-comp-code           of ws-mqget-misc
005600         > mqcc-warning                of ws-cmqv-copybook
005602         if mqget-data-lenf            of ws-mqget-misc
005604           > zero
005606           perform 330-process-req-msg
005608           move mqget-browse-next      of ws-mqget-misc
005610             to mqgmo-options          of mqgmo
005612         end-if
005614         perform 320-browse-req-msg
005616     end-perform
005618     exit
005620     .
005622***------------------------------------------------------------*
005624***  browse the message                                        *
005626***                                                            *
005628***   In order to read the messages in sequence, MSGID and     *
005630***   CORRELID must have the default value.  MQGET sets them   *
005632***   to the values for the message it returns, so             *
005634***   re-initialize them each time                             *
005636***                                                            *
005638***       *** DEPLOYMENT NOTE ***                              *
005640***                                                            *
005642***   The wait interval is set to 30000 milliseconds (30       *
005644***   seconds).  Alter the value in the MOVE statement below   *
005646***   if desired.  Valid values are 0 through 999999999.       *
005648***   Move MQWI-UNLIMITED to MQGMO-WAITINTERVAL if you want    *
005650***   the message monitor to become a long running task and    *
005652***   wait indefinitely                                        *
005654***------------------------------------------------------------*
005656 
005658 320-browse-req-msg section.
005660     if ws-mf-ti-trace-level >= 1
005662       move 71 to ws-mf-ti-msg-nbr
005664       move '320-browse-req-msg' to ws-mf-ti-data-rec(1:18)
005666       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
005668       move 18 to ws-mf-ti-user-data-len
005670       perform mf-ti-write
005672     end-if
005674     move mqmi-none                    of ws-cmqv-copybook
005676       to mqmd-msgid                   of ws-cmqmdv-copybook
005678     move mqci-none                    of ws-cmqv-copybook
005680       to mqmd-correlid                of ws-cmqmdv-copybook
005682***------------------------------------------------------------*
005684*** change the wait interval value here, if desired            *
005686***------------------------------------------------------------*
005688     move 30000
005690       to mqgmo-waitinterval           of ws-cmqgmov-copybook
005692     set  mqget-before-88              of ws-mqget-t
005694       to true
005696     move mqcc-ok                      of ws-cmqv-copybook
005698       to mqget-comp-code              of ws-mqget-misc
005700     move mqcc-ok                      of ws-cmqv-copybook
005702       to mqget-reason                 of ws-mqget-misc
005704     if ws-mf-ti-trace-level >= 4
005706       perform 7000-cmqmdv-trace
005708       perform 7000-cmqgmov-trace
005710       perform 7000-mqget-trace
005712     end-if
005714     call 'mqget'
005716       using mqget-hconn               of ws-mqget-misc
005718             mqget-q-handle            of ws-mqget-misc
005720             mqmd                      of ws-cmqmdv-copybook
005722             mqgmo                     of ws-cmqgmov-copybook
005724             mqget-buffer-lenf         of ws-mqget-misc
005726             lk-msg-partial
005728             mqget-data-lenf           of ws-mqget-misc
005730             mqget-comp-code           of ws-mqget-misc
005732             mqget-reason              of ws-mqget-misc
005734     end-call
005736     set  mqget-after-88               of ws-mqget-t
005738       to true
005740     evaluate true
005742       when mqget-comp-code            of ws-mqget-misc
005744         = mqcc-ok                     of ws-cmqv-copybook
005746         continue
005748       when mqget-reason               of ws-mqget-misc
005750         = mqrc-truncated-msg-accepted of ws-cmqv-copybook
005752         continue
005754       when mqget-reason               of ws-mqget-misc
005756         = mqrc-no-msg-available       of ws-cmqv-copybook
005758         continue
005760       when other
005762         set  mqget-stop-88            of ws-mqget-misc
005764           to true
005766         set  mqget-error-88           of ws-mqget-t
005768           to true
005770         move this-program             of ws-static-fields
005772           to mf-abend-program         of ws-nwif
005774         move mqget-failure            of ws-mmtm-abends
005776           to mf-abend-code            of ws-nwif
005778         perform 8000-mqget-error
005780         perform 9000-return
005782     end-evaluate
005784     if ws-mf-ti-trace-level >= 4
005786       perform 7000-mqget-trace
005788       perform 7000-cmqmdv-trace
005790       perform 7000-cmqgmov-trace
005792     end-if
005794     if mqget-comp-code                of ws-mqget-misc
005796         = mqcc-ok                     of ws-cmqv-copybook
005798       or mqget-reason                 of ws-mqget-misc
005800         = mqrc-truncated-msg-accepted of ws-cmqv-copybook
005802       if ebiz-type                    of lk-msg-hdr-i
005804         = hex-32                      of ws-static-fields
005806         perform 370-set-large-req-pntrs
005808       else
005810         perform 360-set-classic-req-pntrs
005812       end-if
005814       if ws-mf-ti-trace-level >= 4
005816         move 'before ASCII to EBCDIC conversion'
005818           to textx                    of ws-info-t
005820         perform 7000-info-trace
005822         move mqget-data-lenf          of ws-mqget-misc
005824           to ws-mf-ti-user-data-len   of ws-mf-ti-record
005826         set  ws-mf-ti-user-data-pntr  of ws-mf-ti-record
005828           to address                  of lk-msg-partial
005830         move seventy-five             of ws-static-fields
005832           to ws-mf-ti-msg-nbr         of ws-mf-ti-record
005834         set  address                  of lk-msg-hdr-pw
005836           to address of lk-msg-hdr-i
005838         perform 8000-hide-msg-hdr-pw
005840         set  address                  of lk-req-hdr-pw
005842           to address                  of lk-ebiz-req-hdr-i
005844         perform 8000-hide-req-hdr-pw
005846         perform mf-ti-write
005848         perform 8000-restore-msg-hdr-pw
005850         perform 8000-restore-req-hdr-pw
005852       end-if
005854       inspect      lk-msg-partial(1:
005856                    mqget-buffer-lenf  of ws-mqget-misc)
005858         converting ws-inspect-input
005860         to         ws-inspect-to-ebcdic
005862       if ws-mf-ti-trace-level >= 4
005864         move 'after ASCII to EBCDIC conversion'
005866           to textx                    of ws-info-t
005868         perform 7000-info-trace
005870         move mqget-data-lenf          of ws-mqget-misc
005872           to ws-mf-ti-user-data-len   of ws-mf-ti-record
005874         set  ws-mf-ti-user-data-pntr  of ws-mf-ti-record
005876           to address                  of lk-msg-partial
005878         move seventy-five             of ws-static-fields
005880           to ws-mf-ti-msg-nbr         of ws-mf-ti-record
005882         set  address                  of lk-msg-hdr-pw
005884           to address of lk-msg-hdr-i
005886         perform 8000-hide-msg-hdr-pw
005888         set  address                  of lk-req-hdr-pw
005890           to address                  of lk-ebiz-req-hdr-i
005892         perform 8000-hide-req-hdr-pw
005894         perform mf-ti-write
005896         perform 8000-restore-msg-hdr-pw
005898         perform 8000-restore-req-hdr-pw
005900       end-if
005902       if ebiz-type                    of lk-msg-hdr-i
005904         = hex-f2                      of ws-static-fields
005906         if ws-mf-ti-trace-level >= 4
005908           set  address                of lk-msg-hdr-t
005910             to address                of lk-msg-hdr-i
005912           set basepntr-p
005914             to address                of lk-req-msg
005916           perform 7000-mwih-trace
005918           set  address                of lk-msg-hdr-ext-t
005920             to address                of lk-msg-hdr-ext-i
005922           set basepntr-p
005924             to address                of lk-req-msg
005926           perform 7000-mwih-ext-trace
005928           set  address                of lk-fmt-hdr-t
005930             to address                of lk-fmt-hdr-i
005932           set basepntr-p
005934             to address                of lk-req-msg
005936           perform 7000-fmth-trace
005938           set  address                of lk-ebiz-req-hdr-t
005940             to address                of lk-ebiz-req-hdr-i
005942           set basepntr-p
005944             to address                of lk-req-msg
005946           perform 7000-reqh-trace
005948         end-if
005950       else
005952         if ws-mf-ti-trace-level >= 4
005954           set  address                of lk-msg-hdr-t
005956             to address                of lk-msg-hdr-i
005958           set basepntr-p
005960             to address                of lk-req-msg
005962           perform 7000-mwih-trace
005964           set  address                of lk-fmt-hdr-c-t
005966             to address                of lk-fmt-hdr-c
005968           set basepntr-p
005970             to address                of lk-req-msg
005972           perform 7000-fmth-c-trace
005974           set  address                of lk-ebiz-req-hdr-t
005976             to address                of lk-ebiz-req-hdr-i
005978           set basepntr-p
005980             to address                of lk-req-msg
005982           perform 7000-reqh-trace
005984         end-if
005986       end-if
005988       if ebiz-type                    of lk-msg-hdr-i
005990         = hex-f2                      of ws-static-fields
005992         move trace-flags              of lk-fmt-hdr-i
005994           to mmtm-trace-level         of ws-mmtm-trace-misc
005996              trace-level              of ws-nwif
005998         move trace-ts-q               of lk-fmt-hdr-i
006000           to mmtm-trace-queue-name    of ws-mmtm-trace-misc
006002              trace-queue-name         of ws-nwif
006004       else
006006         move trace-flags              of lk-fmt-hdr-c
006008           to mmtm-trace-level         of ws-mmtm-trace-misc
006010              trace-level              of ws-nwif
006012         move trace-ts-q               of lk-fmt-hdr-c
006014           to mmtm-trace-queue-name    of ws-mmtm-trace-misc
006016              trace-queue-name         of ws-nwif
006018       end-if
006020       perform mf-ti-setup
006022     end-if
006024     exit
006026     .
006028 
006030 330-process-req-msg section.
006032     if ws-mf-ti-trace-level >= 1
006034       move 71 to ws-mf-ti-msg-nbr
006036       move '330-process-req-msg' to ws-mf-ti-data-rec(1:19)
006038       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006040       move 19 to ws-mf-ti-user-data-len
006042       perform mf-ti-write
006044     end-if
006046     if ebiz-type                      of lk-msg-hdr-i
006048       = hex-f2                        of ws-static-fields
006050       perform 350-process-large-req-msg
006052     else
006054       perform 340-process-classic-req-msg
006056     end-if
006058     exit
006060     .
006062 
006064 340-process-classic-req-msg section.
006066     if ws-mf-ti-trace-level >= 1
006068       move 71 to ws-mf-ti-msg-nbr
006070       move '340-process-classic-req-msg' to 
006072           ws-mf-ti-data-rec(1:27)
006074       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006076       move 27 to ws-mf-ti-user-data-len
006078       perform mf-ti-write
006080     end-if
006082     perform 360-set-classic-req-pntrs
006084     if ws-mf-ti-trace-level >= 4
006086       perform 7000-mqget-trace
006088       perform 7000-cmqmdv-trace
006090       perform 7000-cmqgmov-trace
006092       set  address                    of lk-msg-hdr-t
006094         to address                    of lk-msg-hdr-i
006096       set basepntr-p
006098         to address                    of lk-req-msg
006100       perform 7000-mwih-trace
006102       set  ws-mf-ti-user-data-pntr    of ws-mf-ti-record
006104         to address                    of lk-msg-hdr-i
006106       move seventy-five               of ws-static-fields
006108         to ws-mf-ti-msg-nbr           of ws-mf-ti-record
006110       move length                     of lk-msg-hdr-i
006112         to ws-mf-ti-user-data-len
006114       set  address                    of lk-msg-hdr-pw
006116         to address of lk-msg-hdr-i
006118       perform 8000-hide-msg-hdr-pw
006120       set  address                    of lk-req-hdr-pw
006122         to address of lk-ebiz-req-hdr-i
006124       perform 8000-hide-req-hdr-pw
006126       perform mf-ti-write
006128       perform 8000-restore-msg-hdr-pw
006130       set  address                    of lk-fmt-hdr-c-t
006132         to address                    of lk-fmt-hdr-c
006134       set basepntr-p
006136         to address                    of lk-req-msg
006138       perform 7000-fmth-c-trace
006140       set  ws-mf-ti-user-data-pntr
006142         to address                    of lk-fmt-hdr-c
006144       move seventy-five               of ws-static-fields
006146         to ws-mf-ti-msg-nbr           of ws-mf-ti-record
006148       move length                     of lk-fmt-hdr-c
006150         to ws-mf-ti-user-data-len     of ws-mf-ti-record
006152       perform mf-ti-write
006154       set  address                    of lk-ebiz-req-hdr-t
006156         to address                    of lk-ebiz-req-hdr-i
006158       set basepntr-p
006160         to address                    of lk-req-msg
006162       perform 7000-reqh-trace
006164       set  ws-mf-ti-user-data-pntr
006166         to address                    of lk-ebiz-req-hdr-i
006168       move seventy-five               of ws-static-fields
006170         to ws-mf-ti-msg-nbr           of ws-mf-ti-record
006172       move length                     of lk-ebiz-req-hdr-i
006174         to ws-mf-ti-user-data-len
006176       set  address                    of lk-req-hdr-pw
006178         to address                    of lk-ebiz-req-hdr-i
006180       perform 8000-hide-req-hdr-pw
006182       perform mf-ti-write
006184       perform 8000-restore-req-hdr-pw
006186     end-if
006188     perform 400-populate-clif
006190     if ws-mf-ti-trace-level >= 4
006192       perform 7000-offsets-trace
006194     end-if
006196     move appl-msg-length              of lk-msg-hdr-i
006198       to appl-msg-len-num             of ws-misc-fields
006200     if mmtm-trace-level             of ws-mmtm-trace-misc
006202        = zero
006204        move 236
006206          to num1                      of ws-misc-fields
006208        move lk-msg-partial (num1      of ws-misc-fields:1)
006210          to mmtm-trace-level        of ws-mmtm-trace-misc
006212     end-if
006214     if mmtm-trace-queue-name        of ws-mmtm-trace-misc
006216        = spaces
006218        move trace-ts-q              of lk-msg-hdr-i
006220          to mmtm-trace-queue-name   of ws-mmtm-trace-misc
006222     end-if
006224     perform mf-ti-setup
006226***------------------------------------------------------------*
006228***  pass wait interval for mwi in mqtm-userdata               *
006230***------------------------------------------------------------*
006232     move mq-get-msg-wait              of lk-msg-hdr-i
006234       to mqtm-userdata                of ws-cmqtml-copybook
006236          (1:length                    of mq-get-msg-wait
006238                                       of lk-msg-hdr-i)
006240***-----------------------------------------------------------*
006242*** check to see if malformed message, if so move ZZZ         *
006244*** to MQTM-USERDATA.  This will cause MER0MQMW to get the    *
006246*** message off the queue without processing it               *
006248***-----------------------------------------------------------*
006250     if msg-encoding                   of lk-msg-hdr-i
006252       = uppercase-nnn                 of ws-static-fields
006254       or msg-encoding                 of lk-msg-hdr-i
006256       = uppercase-pnn                 of ws-static-fields
006258       or msg-encoding                 of lk-msg-hdr-i
006260       = uppercase-bnn                 of ws-static-fields
006262       or msg-encoding                 of lk-msg-hdr-i
006264       = uppercase-ann                 of ws-static-fields
006266         continue
006268     else
006270       if ws-mf-ti-trace-level >= 4
006272         move spaces
006274           to textx                    of ws-info-t
006276         string
006278           'msg-encoding setting is invalid '
006280           left-paren                  of ws-static-fields
006282           msg-encoding                of lk-msg-hdr-i
006284           right-paren                 of ws-static-fields
006286           delimited by size
006288           into textx                  of ws-info-t
006290         end-string
006292         exec cics writeq ts
006294           queue ( default-traceq      of ws-static-fields )
006296           from  ( textx               of ws-info-t        )
006298         end-exec
006300         perform 7000-info-trace
006302       end-if
006304       move uppercase-zzz              of ws-static-fields
006306         to mqtm-userdata              of ws-cmqtml-copybook
006308     end-if
006310     if mq-put-msg-expiry              of lk-msg-hdr-i
006312       is numeric
006314       continue
006316     else
006318       if ws-mf-ti-trace-level >= 4
006320         move spaces
006322           to textx                    of ws-info-t
006324         string
006326           'put-expiry setting is invalid '
006328           left-paren                  of ws-static-fields
006330           mq-put-msg-expiry           of lk-msg-hdr-i
006332           right-paren                 of ws-static-fields
006334           delimited by size
006336           into textx                  of ws-info-t
006338         end-string
006340         exec cics writeq ts
006342           queue ( default-traceq      of ws-static-fields )
006344           from  ( textx               of ws-info-t        )
006346         end-exec
006348         perform 7000-info-trace
006350       end-if
006352       move uppercase-zzz              of ws-static-fields
006354         to mqtm-userdata              of ws-cmqtml-copybook
006356     end-if
006358     if msg-max-length                 of lk-msg-hdr-i
006360       is numeric
006362       continue
006364     else
006366       if ws-mf-ti-trace-level >= 4
006368         move spaces
006370           to textx                    of ws-info-t
006372         string
006374           'msg-max-length setting is invalid '
006376           left-paren                  of ws-static-fields
006378           msg-max-length              of lk-msg-hdr-i
006380           right-paren                 of ws-static-fields
006382           delimited by size
006384           into textx                  of ws-info-t
006386         end-string
006388         exec cics writeq ts
006390           queue ( default-traceq      of ws-static-fields )
006392           from  ( textx               of ws-info-t        )
006394         end-exec
006396         perform 7000-info-trace
006398       end-if
006400       move uppercase-zzz              of ws-static-fields
006402         to mqtm-userdata              of ws-cmqtml-copybook
006404     end-if
006406     if appl-msg-length                of lk-msg-hdr-i
006408       is numeric
006410       continue
006412     else
006414       if ws-mf-ti-trace-level >= 4
006416         move spaces
006418           to textx                    of ws-info-t
006420         string
006422           'appl-msg-length setting is invalid '
006424           left-paren                  of ws-static-fields
006426           appl-msg-length             of lk-msg-hdr-i
006428           right-paren                 of ws-static-fields
006430           delimited by size
006432           into textx                  of ws-info-t
006434         end-string
006436         exec cics writeq ts
006438           queue ( default-traceq      of ws-static-fields )
006440           from  ( textx               of ws-info-t        )
006442         end-exec
006444         perform 7000-info-trace
006446       end-if
006448       move uppercase-zzz              of ws-static-fields
006450         to mqtm-userdata              of ws-cmqtml-copybook
006452     end-if
006454     move mqtm-userdata                of ws-cmqtml-copybook
006456       to mqtm-userdata                of ws-nwif
006458     perform 410-start-mqmw
006460     exit
006462     .
006464 
006466 350-process-large-req-msg section.
006468     if ws-mf-ti-trace-level >= 1
006470       move 71 to ws-mf-ti-msg-nbr
006472       move '350-process-large-req-msg' to ws-mf-ti-data-rec(1:25)
006474       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006476       move 25 to ws-mf-ti-user-data-len
006478       perform mf-ti-write
006480     end-if
006482     perform 370-set-large-req-pntrs
006484     perform 450-populate-nwif
006486     if ws-mf-ti-trace-level >= 4
006488       perform 7000-mqget-trace
006490       perform 7000-cmqmdv-trace
006492       perform 7000-cmqgmov-trace
006494       set  ws-mf-ti-user-data-pntr    of ws-mf-ti-record
006496         to address                    of lk-msg-partial
006498       move seventy-five               of ws-static-fields
006500         to ws-mf-ti-msg-nbr           of ws-mf-ti-record
006502       move mqget-data-lenf            of ws-mqget-misc
006504         to ws-mf-ti-user-data-len     of ws-mf-ti-record
006506       perform mf-ti-write
006508       set  address                    of lk-msg-hdr-t
006510         to address                    of lk-msg-hdr-i
006512       set basepntr-p
006514         to address                    of lk-req-msg
006516       perform 7000-mwih-trace
006518       set  address                    of lk-msg-hdr-pw
006520         to address of lk-msg-hdr-i
006522       perform 8000-hide-msg-hdr-pw
006524       set  ws-mf-ti-user-data-pntr    of ws-mf-ti-record
006526         to address                    of lk-msg-hdr-i
006528       move seventy-five               of ws-static-fields
006530         to ws-mf-ti-msg-nbr           of ws-mf-ti-record
006532       move length                     of lk-msg-hdr-i
006534         to ws-mf-ti-user-data-len     of ws-mf-ti-record
006536       perform mf-ti-write
006538       perform 8000-restore-msg-hdr-pw
006540       set  address                    of lk-msg-hdr-ext-t
006542         to address                    of lk-msg-hdr-ext-i
006544       set basepntr-p
006546         to address                    of lk-req-msg
006548       perform 7000-mwih-ext-trace
006550       set  ws-mf-ti-user-data-pntr    of ws-mf-ti-record
006552         to address                    of lk-msg-hdr-ext-i
006554       move seventy-five               of ws-static-fields
006556         to ws-mf-ti-msg-nbr           of ws-mf-ti-record
006558       move length                     of lk-msg-hdr-ext-i
006560         to ws-mf-ti-user-data-len     of ws-mf-ti-record
006562       perform mf-ti-write
006564       set  address                    of lk-fmt-hdr-t
006566         to address                    of lk-fmt-hdr-i
006568       set basepntr-p
006570         to address                    of lk-req-msg
006572       perform 7000-fmth-trace
006574       set  ws-mf-ti-user-data-pntr    of ws-mf-ti-record
006576         to address                    of lk-fmt-hdr-i
006578       move seventy-five               of ws-static-fields
006580         to ws-mf-ti-msg-nbr           of ws-mf-ti-record
006582       move length                     of lk-fmt-hdr-i
006584         to ws-mf-ti-user-data-len     of ws-mf-ti-record
006586       perform mf-ti-write
006588       set  address                    of lk-ebiz-req-hdr-t
006590         to address                    of lk-ebiz-req-hdr-i
006592       set basepntr-p
006594         to address                    of lk-req-msg
006596       perform 7000-reqh-trace
006598       set  ws-mf-ti-user-data-pntr    of ws-mf-ti-record
006600         to address                    of lk-ebiz-req-hdr-i
006602       move seventy-five               of ws-static-fields
006604         to ws-mf-ti-msg-nbr           of ws-mf-ti-record
006606       move length                     of lk-ebiz-req-hdr-i
006608         to ws-mf-ti-user-data-len     of ws-mf-ti-record
006610       set  address                    of lk-req-hdr-pw
006612         to address                    of lk-ebiz-req-hdr-i
006614       perform 8000-hide-req-hdr-pw
006616       set  ws-mf-ti-user-data-pntr    of ws-mf-ti-record
006618         to address                    of lk-msg-hdr-i
006620       perform mf-ti-write
006622       perform 8000-hide-req-hdr-pw
006624     end-if
006626     if ws-mf-ti-trace-level >= 4
006628       perform 7000-offsets-trace
006630     end-if
006632     move trace-flags                  of lk-fmt-hdr-i
006634       to trace-level                  of ws-nwif
006636          mmtm-trace-level             of ws-mmtm-trace-misc
006638     move trace-ts-q                   of lk-fmt-hdr-i
006640       to trace-queue-name             of ws-nwif
006642          mmtm-trace-queue-name        of ws-mmtm-trace-misc
006644     perform mf-ti-setup
006646***------------------------------------------------------------*
006648***  pass wait interval for mwi in mqtm-userdata               *
006650***------------------------------------------------------------*
006652     move mq-get-msg-wait              of lk-msg-hdr-i
006654       to mqtm-userdata                of ws-cmqtml-copybook
006656          (1:length                    of mq-get-msg-wait
006658                                       of lk-msg-hdr-i)
006660***-----------------------------------------------------------*
006662*** check to see if malformed message, if so move ZZZ         *
006664*** to MQTM-USERDATA.  This will cause MER0MQ01 to get the    *
006666*** message off the queue without processing it               *
006668***-----------------------------------------------------------*
006670     if msg-encoding                   of lk-msg-hdr-i
006672       = uppercase-nnn                 of ws-static-fields
006674       or msg-encoding                 of lk-msg-hdr-i
006676       = uppercase-pnn                 of ws-static-fields
006678       or msg-encoding                 of lk-msg-hdr-i
006680       = uppercase-bnn                 of ws-static-fields
006682       or msg-encoding                 of lk-msg-hdr-i
006684       = uppercase-ann                 of ws-static-fields
006686         continue
006688     else
006690       if ws-mf-ti-trace-level >= 4
006692         move spaces
006694           to textx                    of ws-info-t
006696         string
006698           'msg-encoding setting is invalid '
006700           left-paren                  of ws-static-fields
006702           msg-encoding                of lk-msg-hdr-i
006704           right-paren                 of ws-static-fields
006706           delimited by size
006708           into textx                  of ws-info-t
006710         end-string
006712         exec cics writeq ts
006714           queue ( default-traceq      of ws-static-fields )
006716           from  ( textx               of ws-info-t        )
006718         end-exec
006720         perform 7000-info-trace
006722       end-if
006724       move uppercase-zzz
006726         to mqtm-userdata              of ws-cmqtml-copybook
006728     end-if
006730     if mq-put-msg-expiry              of lk-msg-hdr-i
006732       is numeric
006734       continue
006736     else
006738       if ws-mf-ti-trace-level >= 4
006740         move spaces
006742           to textx                    of ws-info-t
006744         string
006746           'put-expiry setting is invalid '
006748           left-paren                  of ws-static-fields
006750           mq-put-msg-expiry           of lk-msg-hdr-i
006752           right-paren                 of ws-static-fields
006754           delimited by size
006756           into textx                  of ws-info-t
006758         end-string
006760         exec cics writeq ts
006762           queue ( default-traceq      of ws-static-fields )
006764           from  ( textx               of ws-info-t        )
006766         end-exec
006768         perform 7000-info-trace
006770       end-if
006772       move uppercase-zzz              of ws-static-fields
006774         to mqtm-userdata              of ws-cmqtml-copybook
006776     end-if
006778     if msg-max-length                 of lk-msg-hdr-i
006780       is numeric
006782       continue
006784     else
006786       if ws-mf-ti-trace-level >= 4
006788         move spaces
006790           to textx                    of ws-info-t
006792         string
006794           'msg-max-length setting is invalid '
006796           left-paren                  of ws-static-fields
006798           msg-max-length              of lk-msg-hdr-i
006800           right-paren                 of ws-static-fields
006802           delimited by size
006804           into textx                  of ws-info-t
006806         end-string
006808         exec cics writeq ts
006810           queue ( default-traceq      of ws-static-fields )
006812           from  ( textx               of ws-info-t        )
006814         end-exec
006816         perform 7000-info-trace
006818       end-if
006820       move uppercase-zzz              of ws-static-fields
006822         to mqtm-userdata              of ws-cmqtml-copybook
006824     end-if
006826     if appl-msg-length                of lk-msg-hdr-i
006828       is numeric
006830       continue
006832     else
006834       if ws-mf-ti-trace-level >= 4
006836         move spaces
006838           to textx                    of ws-info-t
006840         string
006842           'appl-msg-length setting is invalid '
006844           left-paren                  of ws-static-fields
006846           appl-msg-length             of lk-msg-hdr-i
006848           right-paren                 of ws-static-fields
006850           delimited by size
006852           into textx                  of ws-info-t
006854         end-string
006856         exec cics writeq ts
006858           queue ( default-traceq      of ws-static-fields )
006860           from  ( textx               of ws-info-t        )
006862         end-exec
006864         perform 7000-info-trace
006866       end-if
006868       move uppercase-zzz              of ws-static-fields
006870         to mqtm-userdata              of ws-cmqtml-copybook
006872     end-if
006874     move mqtm-userdata                of ws-cmqtml-copybook
006876       to mqtm-userdata                of ws-nwif
006878     set  mode-is-security-ok-88       of ws-nwif
006880       to true
006882     if cics-verify                    of lk-msg-hdr-i
006884       = uppercase-y                   of ws-static-fields
006886       perform 380-cics-verify
006888       if verify-resp                  of ws-verify-misc
006890         = dfhresp ( normal )
006892         continue
006894       else
006896         set  mode-is-security-error-88
006898                                       of ws-nwif
006900           to true
006902       end-if
006904     else
006906       if ws-mf-ti-trace-level >= 4
006908         move verify-bypassed-msg      of ws-static-fields
006910           to textx                    of ws-info-t
006912         perform 7000-info-trace
006914       end-if
006916       set  mode-is-security-ok-88     of ws-nwif
006918         to true
006920     end-if
006922     perform 440-start-mq01
006924     exit
006926     .
006928 
006930 360-set-classic-req-pntrs section.
006932     if ws-mf-ti-trace-level >= 1
006934       move 71 to ws-mf-ti-msg-nbr
006936       move '360-set-classic-req-pntrs' to ws-mf-ti-data-rec(1:25)
006938       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006940       move 25 to ws-mf-ti-user-data-len
006942       perform mf-ti-write
006944     end-if
006946     if last-request-was-classic-88    of ws-misc-fields
006948       continue
006950     else
006952       set last-request-was-classic-88 of ws-misc-fields
006954         to true
006956       set  address                    of lk-msg-hdr-i
006958         to address                    of lk-msg-partial
006960       set  address                    of lk-fmt-hdr-c
006962         to address                    of lk-msg-partial
006964            (fmt-hdr-offset-i          of ws-msg-offsets-c:1)
006966       set  address                    of lk-ebiz-req-hdr-i
006968         to address                    of ws-msg-partial
006970           (ebiz-req-hdr-offset-i      of ws-msg-offsets-c:1)
006972       set  address                    of lk-msg-hdr-t
006974         to address                    of lk-msg-hdr-i
006976       set  address                    of lk-fmt-hdr-t
006978         to address                    of lk-fmt-hdr-i
006980       set  address                    of lk-ebiz-req-hdr-t
006982         to address                    of lk-ebiz-req-hdr-i
006984     end-if
006986     exit
006988     .
006990 
006992 370-set-large-req-pntrs section.
006994     if ws-mf-ti-trace-level >= 1
006996       move 71 to ws-mf-ti-msg-nbr
006998       move '370-set-large-req-pntrs' to ws-mf-ti-data-rec(1:23)
007000       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007002       move 23 to ws-mf-ti-user-data-len
007004       perform mf-ti-write
007006     end-if
007008     if last-request-was-large-88      of ws-misc-fields
007010       continue
007012     else
007014       set  last-request-was-large-88  of ws-misc-fields
007016         to true
007018       set  address                    of lk-msg-hdr-i
007020         to address                    of lk-msg-partial
007022       set  address                    of lk-msg-hdr-ext-i
007024         to address                    of lk-msg-partial
007026            (msg-hdr-ext-offset-i      of ws-msg-offsets-l:1)
007028       set  address                    of lk-fmt-hdr-i
007030         to address                    of lk-msg-partial
007032            (fmt-hdr-offset-i          of ws-msg-offsets-l:1)
007034       set  address                    of lk-ebiz-req-hdr-i
007036         to address                    of lk-msg-partial
007038            (ebiz-req-hdr-offset-i     of ws-msg-offsets-l:1)
007040       set  address                    of lk-msg-hdr-t
007042         to address                    of lk-msg-hdr-i
007044       set  address                    of lk-msg-hdr-ext-t
007046         to address                    of lk-msg-hdr-ext-i
007048       set  address                    of lk-fmt-hdr-t
007050         to address                    of lk-fmt-hdr-i
007052       set  address                    of lk-ebiz-req-hdr-t
007054         to address                    of lk-ebiz-req-hdr-i
007056       set  address                    of lk-ebiz-rep-hdr-t
007058         to address                    of lk-ebiz-rep-hdr-o
007060     end-if
007062     exit
007064     .
007066 
007068 380-cics-verify section.
007070     if ws-mf-ti-trace-level >= 1
007072       move 71 to ws-mf-ti-msg-nbr
007074       move '380-cics-verify' to ws-mf-ti-data-rec(1:15)
007076       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007078       move 15 to ws-mf-ti-user-data-len
007080       perform mf-ti-write
007082     end-if
007084     set  verify-before-88             of ws-verify-t
007086       to true
007088     move zero
007090       to verify-resp                  of ws-verify-misc
007092     move zero
007094       to verify-resp2                 of ws-verify-misc
007096     move useridx                      of lk-msg-hdr-i
007098       to verify-userid                of ws-verify-misc
007100     move passwordx                    of lk-msg-hdr-i
007102       to verify-password              of ws-verify-misc
007104     move zero
007106       to verify-daysleft              of ws-verify-misc
007108     if ws-mf-ti-trace-level >= 4
007110       perform 7000-verify-trace
007112     end-if
007114     exec cics verify
007116       resp     ( verify-resp          of ws-verify-misc )
007118       resp2    ( verify-resp2         of ws-verify-misc )
007120       userid   ( verify-userid        of ws-verify-misc )
007122       password ( verify-password      of ws-verify-misc )
007124       daysleft ( verify-daysleft      of ws-verify-misc )
007126       nohandle
007128     end-exec
007130     set  verify-after-88              of ws-verify-t
007132       to true
007134     move spaces
007136       to verify-password              of ws-verify-misc
007138     set  verify-after-88              of ws-verify-t
007140       to true
007142     if verify-resp                    of ws-verify-misc
007144       = dfhresp ( normal )
007146       continue
007148     else
007150       perform 8000-verify-error
007152     end-if
007154     if ws-mf-ti-trace-level >= 4
007156       perform 7000-verify-trace
007158     end-if
007160     exit
007162     .
007164 
007166 390-close-req-queue section.
007168     if ws-mf-ti-trace-level >= 1
007170       move 71 to ws-mf-ti-msg-nbr
007172       move '390-close-req-queue' to ws-mf-ti-data-rec(1:19)
007174       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007176       move 19 to ws-mf-ti-user-data-len
007178       perform mf-ti-write
007180     end-if
007182     move mqco-none                    of ws-cmqv-copybook
007184       to mqclose-options              of ws-mqclose-misc
007186     set  mqclose-before-88            of ws-mqclose-t
007188       to true
007190     move mqcc-ok                      of ws-cmqv-copybook
007192       to mqclose-comp-code            of ws-mqclose-misc
007194     move mqcc-ok                      of ws-cmqv-copybook
007196       to mqclose-reason               of ws-mqclose-misc
007198     if ws-mf-ti-trace-level >= 4
007200       perform 7000-mqclose-trace
007202     end-if
007204     call 'mqclose'
007206       using mqclose-hconn             of ws-mqclose-misc
007208             mqclose-q-handle          of ws-mqclose-misc
007210             mqco-none                 of ws-cmqv-copybook
007212             mqclose-comp-code         of ws-mqclose-misc
007214             mqclose-reason            of ws-mqclose-misc
007216     end-call
007218     set  mqclose-after-88             of ws-mqclose-t
007220       to true
007222     if mqclose-comp-code              of ws-mqclose-misc
007224       not = mqcc-ok                   of ws-cmqv-copybook
007226       move this-program               of ws-static-fields
007228         to mf-abend-program           of ws-nwif
007230       move mqclose-failure            of ws-mmtm-abends
007232         to mf-abend-code              of ws-nwif
007234       perform 8000-mqclose-error
007236       perform 9000-return
007238     else
007240       continue
007242     end-if
007244     if ws-mf-ti-trace-level >= 4
007246       perform 7000-mqclose-trace
007248     end-if
007250     exit
007252     .
007254 
007256 400-populate-clif section.
007258     if ws-mf-ti-trace-level >= 1
007260       move 71 to ws-mf-ti-msg-nbr
007262       move '400-populate-clif' to ws-mf-ti-data-rec(1:17)
007264       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007266       move 17 to ws-mf-ti-user-data-len
007268       perform mf-ti-write
007270     end-if
007272     move mmtm-trace-level             of ws-mmtm-trace-misc
007274       to trace-levelx                 of ws-clif
007276     move mmtm-trace-queue-name        of ws-mmtm-trace-misc
007278       to trace-queue-name             of ws-clif
007280     move ws-cmqmdv-copybook
007282       to cmqmdv-copybook              of ws-clif
007284     move ws-cmqtml-copybook
007286       to cmqtml-copybook              of ws-clif
007288     move mq-get-msg-wait              of lk-msg-hdr-i
007290       to mqtm-userdata                of ws-clif
007292         (1:length of mq-get-msg-wait  of lk-msg-hdr-i)
007294     exit
007296     .
007298 
007300 410-start-mqmw section.
007302     if ws-mf-ti-trace-level >= 1
007304       move 71 to ws-mf-ti-msg-nbr
007306       move '410-start-mqmw' to ws-mf-ti-data-rec(1:14)
007308       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007310       move 14 to ws-mf-ti-user-data-len
007312       perform mf-ti-write
007314     end-if
007316     move 'MQMW'
007318       to start-transid                of ws-start-misc
007320     if ws-mf-ti-trace-level >= 4
007322       perform 7000-clif-trace
007324     end-if
007326     perform 420-start-mqmw-with-userid
007328     if start-resp                     of ws-start-misc
007330       not = dfhresp ( normal )
007332       perform 430-start-mqmw-without-userid
007334     end-if
007336     exit
007338     .
007340 
007342 420-start-mqmw-with-userid section.
007344     if ws-mf-ti-trace-level >= 1
007346       move 71 to ws-mf-ti-msg-nbr
007348       move '420-start-mqmw-with-userid' to 
007350           ws-mf-ti-data-rec(1:26)
007352       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007354       move 26 to ws-mf-ti-user-data-len
007356       perform mf-ti-write
007358     end-if
007360     set  start-before-88              of ws-start-t
007362       to true
007364     move zero
007366       to start-resp                   of ws-start-misc
007368     move zero
007370       to start-resp2                  of ws-start-misc
007372     move 'ws-clif'
007374       to start-from                   of ws-start-misc
007376     move length                       of ws-clif
007378       to start-length                 of ws-start-misc
007380     move function upper-case
007382       (useridx                        of lk-msg-hdr-i)
007384       to start-userid                 of ws-start-misc
007386     if ws-mf-ti-trace-level >= 4
007388       perform 7000-clif-trace
007390       perform 7000-start-trace
007392     end-if
007394     exec cics start
007396       resp     ( start-resp           of ws-start-misc )
007398       resp2    ( start-resp2          of ws-start-misc )
007400       transid  ( start-transid        of ws-start-misc )
007402       from     ( ws-clif                               )
007404       length   ( start-length         of ws-start-misc )
007406       userid   ( start-userid         of ws-start-misc )
007408       nohandle
007410     end-exec
007412     set  start-after-88               of ws-start-t
007414       to true
007416     if start-resp                     of ws-start-misc
007418       = dfhresp ( normal )
007420       continue
007422     else
007424       set  start-error-88             of ws-start-t
007426         to true
007428       perform 8000-start-error
007430     end-if
007432     if ws-mf-ti-trace-level >= 4
007434       perform 7000-start-trace
007436     end-if
007438     exit
007440     .
007442 
007444 430-start-mqmw-without-userid section.
007446     if ws-mf-ti-trace-level >= 1
007448       move 71 to ws-mf-ti-msg-nbr
007450       move '430-start-mqmw-without-userid' to 
007452           ws-mf-ti-data-rec(1:29)
007454       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007456       move 29 to ws-mf-ti-user-data-len
007458       perform mf-ti-write
007460     end-if
007462     move zero
007464       to start-resp                   of ws-start-misc
007466     move zero
007468       to start-resp2                  of ws-start-misc
007470     set  start-before-88              of ws-start-t
007472       to true
007474     if ws-mf-ti-trace-level >= 4
007476       perform 7000-clif-trace
007478       perform 7000-start-trace
007480     end-if
007482     exec cics start
007484       resp     ( start-resp           of ws-start-misc )
007486       resp2    ( start-resp2          of ws-start-misc )
007488       transid  ( start-transid        of ws-start-misc )
007490       from     ( ws-clif                              )
007492       length   ( start-length         of ws-start-misc )
007494       nohandle
007496     end-exec
007498     set  start-after-88               of ws-start-t
007500       to true
007502     if start-resp                     of ws-start-misc
007504       = dfhresp ( normal )
007506       continue
007508     else
007510       set  start-error-88             of ws-start-t
007512         to true
007514       perform 8000-start-error
007516     end-if
007518     if ws-mf-ti-trace-level >= 4
007520       perform 7000-start-trace
007522     end-if
007524     exit
007526     .
007528 
007530 440-start-mq01 section.
007532     if ws-mf-ti-trace-level >= 1
007534       move 71 to ws-mf-ti-msg-nbr
007536       move '440-start-mq01' to ws-mf-ti-data-rec(1:14)
007538       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007540       move 14 to ws-mf-ti-user-data-len
007542       perform mf-ti-write
007544     end-if
007546     move 'MQ01'
007548       to start-transid                of ws-start-misc
007550     if mode-is-security-error-88      of ws-nwif
007552       perform 470-start-mq01-without-userid
007554     else
007556       perform 460-start-mq01-with-userid
007558       if start-resp                   of ws-start-misc
007560         not = dfhresp ( normal )
007562         perform 470-start-mq01-without-userid
007564       end-if
007566     end-if
007568     exit
007570     .
007572 
007574 450-populate-nwif section.
007576     if ws-mf-ti-trace-level >= 1
007578       move 71 to ws-mf-ti-msg-nbr
007580       move '450-populate-nwif' to ws-mf-ti-data-rec(1:17)
007582       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007584       move 17 to ws-mf-ti-user-data-len
007586       perform mf-ti-write
007588     end-if
007590     if ws-mf-ti-trace-level >= 4
007592       set  address                    of lk-msg-hdr-t
007594         to address                    of lk-msg-hdr-i
007596       set basepntr-p
007598         to address                    of lk-req-msg
007600       perform 7000-mwih-trace
007602       set  address                    of lk-msg-hdr-ext-t
007604         to address                    of lk-msg-hdr-ext-i
007606       set basepntr-p
007608         to address                    of lk-req-msg
007610       perform 7000-mwih-ext-trace
007612       set  address                    of lk-fmt-hdr-t
007614         to address                    of lk-fmt-hdr-i
007616       set basepntr-p
007618         to address                    of lk-req-msg
007620       perform 7000-fmth-trace
007622     end-if
007624*    nwif-fields
007626*    micro-focus-fields
007628     move trace-flags                  of lk-fmt-hdr-i
007630       to trace-level                  of ws-nwif
007632     move trace-ts-q                   of lk-fmt-hdr-i
007634       to trace-queue-name             of ws-nwif
007636     move useridx                      of lk-msg-hdr-i
007638       to useridx                      of ws-nwif
007640*    mqtm-fields
007642*    req-msg-fields
007644     move mqget-data-lenf              of ws-mqget-misc
007646       to req-msg-total-used-lenf      of ws-nwif
007648     move mqtm-qname                   of ws-cmqtml-copybook
007650       to req-qname                    of ws-nwif
007652     move mqmd-msgid                   of ws-cmqmdv-copybook
007654       to req-msgid                    of ws-nwif
007656     move mqmd-correlid                of ws-cmqmdv-copybook
007658       to req-correlid                 of ws-nwif
007660     move mqmd-replytoq                of ws-cmqmdv-copybook
007662       to rep-qname                    of ws-nwif
007664     if ws-mf-ti-trace-level >= 4
007666       move 'Bottom 450-populate-nwif'
007668         to textx                      of ws-info-t
007670       perform 7000-info-trace
007672       perform 7000-nwif-trace
007674     end-if
007676     exit
007678     .
007680 
007682 460-start-mq01-with-userid section.
007684     if ws-mf-ti-trace-level >= 1
007686       move 71 to ws-mf-ti-msg-nbr
007688       move '460-start-mq01-with-userid' to 
007690           ws-mf-ti-data-rec(1:26)
007692       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007694       move 26 to ws-mf-ti-user-data-len
007696       perform mf-ti-write
007698     end-if
007700     set  start-before-88              of ws-start-t
007702       to true
007704     move zero
007706       to start-resp                   of ws-start-misc
007708     move zero
007710       to start-resp2                  of ws-start-misc
007712     move 'ws-nwif'
007714       to start-from                   of ws-start-misc
007716     move length                       of ws-nwif
007718       to start-length                 of ws-start-misc
007720     move function upper-case
007722       (useridx                        of lk-msg-hdr-i)
007724       to start-userid                 of ws-start-misc
007726     if ws-mf-ti-trace-level >= 4
007728       perform 7000-nwif-trace
007730       set  address                    of lk-msg-hdr-t
007732         to address                    of lk-msg-hdr-i
007734       set basepntr-p
007736         to address                    of lk-req-msg
007738       perform 7000-mwih-trace
007740       set  address                    of lk-msg-hdr-ext-t
007742         to address                    of lk-msg-hdr-ext-i
007744       set basepntr-p
007746         to address                    of lk-req-msg
007748       perform 7000-mwih-ext-trace
007750       set  address                    of lk-fmt-hdr-t
007752         to address                    of lk-fmt-hdr-i
007754       set basepntr-p
007756         to address                    of lk-req-msg
007758       perform 7000-fmth-trace
007760       set  address                    of lk-ebiz-req-hdr-t
007762         to address                    of lk-ebiz-req-hdr-i
007764       set basepntr-p
007766         to address                    of lk-req-msg
007768       perform 7000-reqh-trace
007770       perform 7000-start-trace
007772     end-if
007774     exec cics start
007776       resp     ( start-resp           of ws-start-misc )
007778       resp2    ( start-resp2          of ws-start-misc )
007780       transid  ( start-transid        of ws-start-misc )
007782       from     ( ws-nwif                               )
007784       length   ( start-length         of ws-start-misc )
007786       userid   ( start-userid         of ws-start-misc )
007788       nohandle
007790     end-exec
007792     set  start-after-88               of ws-start-t
007794       to true
007796     if start-resp                     of ws-start-misc
007798       = dfhresp ( normal )
007800       continue
007802     else
007804       set  start-error-88             of ws-start-t
007806         to true
007808       perform 8000-start-error
007810     end-if
007812     if ws-mf-ti-trace-level >= 4
007814       perform 7000-start-trace
007816     end-if
007818     exit
007820     .
007822 
007824 470-start-mq01-without-userid section.
007826     if ws-mf-ti-trace-level >= 1
007828       move 71 to ws-mf-ti-msg-nbr
007830       move '470-start-mq01-without-userid' to 
007832           ws-mf-ti-data-rec(1:29)
007834       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007836       move 29 to ws-mf-ti-user-data-len
007838       perform mf-ti-write
007840     end-if
007842     move zero
007844       to start-resp                   of ws-start-misc
007846     move zero
007848       to start-resp2                  of ws-start-misc
007850     set  start-before-88              of ws-start-t
007852       to true
007854     if mode-is-security-error-88      of ws-nwif
007856       move length of ws-nwif
007858         to start-length               of ws-start-misc
007860       move spaces
007862         to start-userid               of ws-start-misc
007864     end-if
007866     if ws-mf-ti-trace-level >= 4
007868       perform 7000-nwif-trace
007870       set  address                    of lk-msg-hdr-t
007872         to address                    of lk-msg-hdr-i
007874       set basepntr-p
007876         to address                    of lk-req-msg
007878       perform 7000-mwih-trace
007880       set  address                    of lk-msg-hdr-ext-t
007882         to address                    of lk-msg-hdr-ext-i
007884       set basepntr-p
007886         to address                    of lk-req-msg
007888       perform 7000-mwih-ext-trace
007890       set  address                    of lk-fmt-hdr-t
007892         to address                    of lk-fmt-hdr-i
007894       set basepntr-p
007896         to address                    of lk-req-msg
007898       perform 7000-fmth-trace
007900       set  address                    of lk-ebiz-req-hdr-t
007902         to address                    of lk-ebiz-req-hdr-i
007904       set basepntr-p
007906         to address                    of lk-req-msg
007908       perform 7000-reqh-trace
007910       perform 7000-start-trace
007912     end-if
007914     exec cics start
007916       resp     ( start-resp           of ws-start-misc )
007918       resp2    ( start-resp2          of ws-start-misc )
007920       transid  ( start-transid        of ws-start-misc )
007922       from     ( ws-nwif                               )
007924       length   ( start-length         of ws-start-misc )
007926       nohandle
007928     end-exec
007930     set  start-after-88               of ws-start-t
007932       to true
007934     if start-resp                     of ws-start-misc
007936       = dfhresp ( normal )
007938       continue
007940     else
007942       set  start-error-88             of ws-start-t
007944         to true
007946       perform 8000-start-error
007948     end-if
007950     if ws-mf-ti-trace-level >= 4
007952       perform 7000-start-trace
007954     end-if
007956     exit
007958     .
007960 
007962 8000-hide-msg-hdr-pw section.
007964     if ws-mf-ti-trace-level >= 1
007966       move 71 to ws-mf-ti-msg-nbr
007968       move '8000-hide-msg-hdr-pw' to ws-mf-ti-data-rec(1:20)
007970       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007972       move 20 to ws-mf-ti-user-data-len
007974       perform mf-ti-write
007976     end-if
007978     move 65
007980       to pw-start-pos                 of pw-save-area
007982     move 16
007984       to pw-len                       of pw-save-area
007986     move lk-msg-hdr-pw(pw-start-pos   of pw-save-area:
007988                        pw-len         of pw-save-area )
007990       to pw-from-msg-hdr              of pw-save-area
007992     move all '*'
007994       to  lk-msg-hdr-pw(pw-start-pos  of pw-save-area:
007996                         pw-len        of pw-save-area )
007998     exit
008000     .
008002 
008004 8000-restore-msg-hdr-pw section.
008006     if ws-mf-ti-trace-level >= 1
008008       move 71 to ws-mf-ti-msg-nbr
008010       move '8000-restore-msg-hdr-pw' to ws-mf-ti-data-rec(1:23)
008012       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008014       move 23 to ws-mf-ti-user-data-len
008016       perform mf-ti-write
008018     end-if
008020     move 65
008022       to pw-start-pos                 of pw-save-area
008024     move 16
008026       to pw-len                       of pw-save-area
008028     move pw-from-msg-hdr              of pw-save-area
008030       to lk-msg-hdr-pw(pw-start-pos   of pw-save-area:
008032                        pw-len         of pw-save-area )
008034     move spaces
008036       to pw-from-msg-hdr              of pw-save-area
008038     exit
008040     .
008042 
008044 8000-hide-req-hdr-pw section.
008046     if ws-mf-ti-trace-level >= 1
008048       move 71 to ws-mf-ti-msg-nbr
008050       move '8000-hide-req-hdr-pw' to ws-mf-ti-data-rec(1:20)
008052       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008054       move 20 to ws-mf-ti-user-data-len
008056       perform mf-ti-write
008058     end-if
008060     move 9
008062       to pw-start-pos                 of pw-save-area
008064     move 8
008066       to pw-len                       of pw-save-area
008068     move lk-req-hdr-pw(pw-start-pos   of pw-save-area:
008070                        pw-len         of pw-save-area )
008072       to pw-from-req-hdr              of pw-save-area
008074     move all '*'
008076       to  lk-req-hdr-pw(pw-start-pos  of pw-save-area:
008078                         pw-len        of pw-save-area )
008080     exit
008082     .
008084 
008086 8000-restore-req-hdr-pw section.
008088     if ws-mf-ti-trace-level >= 1
008090       move 71 to ws-mf-ti-msg-nbr
008092       move '8000-restore-req-hdr-pw' to ws-mf-ti-data-rec(1:23)
008094       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008096       move 23 to ws-mf-ti-user-data-len
008098       perform mf-ti-write
008100     end-if
008102     move 9
008104       to pw-start-pos                 of pw-save-area
008106     move 8
008108       to pw-len                       of pw-save-area
008110     move pw-from-req-hdr              of pw-save-area
008112       to lk-req-hdr-pw(pw-start-pos   of pw-save-area:
008114                        pw-len         of pw-save-area )
008116     move spaces
008118       to pw-from-req-hdr              of pw-save-area
008120     exit
008122     .
008124 
008126 8000-verify-error section.
008128     if ws-mf-ti-trace-level >= 1
008130       move 71 to ws-mf-ti-msg-nbr
008132       move '8000-verify-error' to ws-mf-ti-data-rec(1:17)
008134       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008136       move 17 to ws-mf-ti-user-data-len
008138       perform mf-ti-write
008140     end-if
008142     perform 8000-determine-error
008144     set  mode-is-security-error-88    of ws-nwif
008146       to true
008148     exit
008150     .
008152 
008154 8000-determine-error section.
008156     if ws-mf-ti-trace-level >= 1
008158       move 71 to ws-mf-ti-msg-nbr
008160       move '8000-determine-error' to ws-mf-ti-data-rec(1:20)
008162       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008164       move 20 to ws-mf-ti-user-data-len
008166       perform mf-ti-write
008168     end-if
008170     compute verify-error-flag
008172       = zero
008174       - verify-resp2                  of ws-verify-misc
008176     evaluate true
008178       when verify-id-useriderr-88     of ws-verify-misc
008180         move ws-abend-codex           of ws-useriderr-error
008182           to mf-abend-code            of ws-nwif
008184         move ws-return-codex          of ws-useriderr-error
008186           to mf-return-code           of ws-nwif
008188         move ws-messagex              of ws-useriderr-error
008190           to mf-msg                   of ws-nwif
008192       when verify-id-sm-error-88      of ws-verify-misc
008194         move ws-abend-codex           of ws-sm-error-error
008196           to mf-abend-code            of ws-nwif
008198         move ws-return-codex          of ws-sm-error-error
008200           to mf-return-code           of ws-nwif
008202         move ws-messagex              of ws-sm-error-error
008204           to mf-msg                   of ws-nwif
008206       when verify-id-sm-not-init-88   of ws-verify-misc
008208         move ws-abend-codex           of ws-sm-not-init-error
008210           to mf-abend-code            of ws-nwif
008212         move ws-return-codex          of ws-sm-not-init-error
008214           to mf-return-code           of ws-nwif
008216         move ws-messagex              of ws-sm-not-init-error
008218           to mf-msg                   of ws-nwif
008220       when verify-id-sm-no-resp-88    of ws-verify-misc
008222         move ws-abend-codex           of ws-sm-no-resp-error
008224           to mf-abend-code            of ws-nwif
008226         move ws-return-codex          of ws-sm-no-resp-error
008228           to mf-return-code           of ws-nwif
008230         move ws-messagex              of ws-sm-no-resp-error
008232           to mf-msg                   of ws-nwif
008234       when verify-id-id-invalid-88    of ws-verify-misc
008236         move ws-abend-codex           of ws-id-invalid-error
008238           to mf-abend-code            of ws-nwif
008240         move ws-return-codex          of ws-id-invalid-error
008242           to mf-return-code           of ws-nwif
008244         move ws-messagex              of ws-id-invalid-error
008246           to mf-msg                   of ws-nwif
008248       when verify-id-pw-invalid-88    of ws-verify-misc
008250         move ws-abend-codex           of ws-pw-invalid-error
008252           to mf-abend-code            of ws-nwif
008254         move ws-return-codex          of ws-pw-invalid-error
008256           to mf-return-code           of ws-nwif
008258         move ws-messagex              of ws-pw-invalid-error
008260           to mf-msg                   of ws-nwif
008262       when verify-id-pw-expired-88    of ws-verify-misc
008264         move ws-abend-codex           of ws-pw-expired-error
008266           to mf-abend-code            of ws-nwif
008268         move ws-return-codex          of ws-pw-expired-error
008270           to mf-return-code           of ws-nwif
008272         move ws-messagex              of ws-pw-expired-error
008274           to mf-msg                   of ws-nwif
008276       when verify-id-id-revoked-88    of ws-verify-misc
008278         move ws-abend-codex           of ws-id-revoked-error
008280           to mf-abend-code            of ws-nwif
008282         move ws-return-codex          of ws-id-revoked-error
008284           to mf-return-code           of ws-nwif
008286         move ws-messagex              of ws-id-revoked-error
008288           to mf-msg                   of ws-nwif
008290       when verify-id-id-unknown-88    of ws-verify-misc
008292         move ws-abend-codex           of ws-id-unknown-error
008294           to mf-abend-code            of ws-nwif
008296         move ws-return-codex          of ws-id-unknown-error
008298           to mf-return-code           of ws-nwif
008300         move ws-messagex              of ws-id-unknown-error
008302           to mf-msg                   of ws-nwif
008304       when other
008306         move eibresp
008308           to ws-verify-eibresp
008310         move eibresp2
008312           to ws-verify-eibresp2
008314         move ws-abend-codex           of ws-verify-error
008316           to mf-abend-code            of ws-nwif
008318         move ws-return-codex          of ws-verify-error
008320           to mf-return-code           of ws-nwif
008322         move ws-messagex              of ws-verify-error
008324           to mf-msg                   of ws-nwif
008326     end-evaluate
008328     if ws-mf-ti-trace-level >= 4
008330       move mf-msg                     of ws-nwif
008332         to textx                      of ws-info-t
008334       perform 7000-info-trace
008336     end-if
008338     if ws-mf-ti-trace-level >= 4
008340       set  ws-mf-ti-user-data-pntr    of ws-mf-ti-record
008342         to address                    of mf-msg
008344                                       of ws-nwif
008346       move seventy-five               of ws-static-fields
008348         to ws-mf-ti-msg-nbr           of ws-mf-ti-record
008350       move length                     of mf-msg
008352                                       of ws-nwif
008354         to ws-mf-ti-user-data-len     of ws-mf-ti-record
008356       perform mf-ti-write
008358     end-if
008360     exit
008362     .
008364 
008366 8000-start-error section.
008368     if ws-mf-ti-trace-level >= 1
008370       move 71 to ws-mf-ti-msg-nbr
008372       move '8000-start-error' to ws-mf-ti-data-rec(1:16)
008374       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008376       move 16 to ws-mf-ti-user-data-len
008378       perform mf-ti-write
008380     end-if
008382     perform 7000-error-trace
008384     perform 7000-start-trace
008386     exit
008388     .
008390 
008392 8000-mqclose-error section.
008394     if ws-mf-ti-trace-level >= 1
008396       move 71 to ws-mf-ti-msg-nbr
008398       move '8000-mqclose-error' to ws-mf-ti-data-rec(1:18)
008400       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008402       move 18 to ws-mf-ti-user-data-len
008404       perform mf-ti-write
008406     end-if
008408     perform 7000-error-trace
008410     perform 7000-mqclose-trace
008412     perform 9000-return
008414     exit
008416     .
008418 
008420 8000-mqget-error section.
008422     if ws-mf-ti-trace-level >= 1
008424       move 71 to ws-mf-ti-msg-nbr
008426       move '8000-mqget-error' to ws-mf-ti-data-rec(1:16)
008428       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008430       move 16 to ws-mf-ti-user-data-len
008432       perform mf-ti-write
008434     end-if
008436     perform 7000-error-trace
008438     perform 7000-mqget-trace
008440     perform 9000-return
008442     exit
008444     .
008446 
008448 8000-mqopen-error section.
008450     if ws-mf-ti-trace-level >= 1
008452       move 71 to ws-mf-ti-msg-nbr
008454       move '8000-mqopen-error' to ws-mf-ti-data-rec(1:17)
008456       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008458       move 17 to ws-mf-ti-user-data-len
008460       perform mf-ti-write
008462     end-if
008464     perform 7000-error-trace
008466     perform 7000-mqopen-trace
008468     perform 9000-return
008470     exit
008472     .
008474 
008476 8000-retrieve-error section.
008478     if ws-mf-ti-trace-level >= 1
008480       move 71 to ws-mf-ti-msg-nbr
008482       move '8000-retrieve-error' to ws-mf-ti-data-rec(1:19)
008484       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008486       move 19 to ws-mf-ti-user-data-len
008488       perform mf-ti-write
008490     end-if
008492     perform 7000-error-trace
008494     perform 7000-retrieve-trace
008496     perform 9000-return
008498     exit
008500     .
008502 
008504 9000-return section.
008506     if ws-mf-ti-trace-level >= 1
008508       move 71 to ws-mf-ti-msg-nbr
008510       move '9000-return' to ws-mf-ti-data-rec(1:11)
008512       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008514       move 11 to ws-mf-ti-user-data-len
008516       perform mf-ti-write
008518     end-if
008520     exec cics return
008522     end-exec.
008524     exit
008526     .
008528
008530 mf-ti-setup section.
008532     move mmtm-trace-level             of ws-mmtm-trace-misc
008534       to ws-mf-ti-trace-level         of ws-mf-ti-record
008536     move mmtm-trace-queue-name        of ws-mmtm-trace-misc
008538       to ws-mf-ti-queue-name-long     of ws-mf-ti-record
008540     if ws-mf-ti-trace-level           of ws-mf-ti-record
008542       > zero
008544       move 1
008546         to ws-mf-ti-major-version     of ws-mf-ti-record
008548       move zero
008550         to ws-mf-ti-minor-version     of ws-mf-ti-record
008552       if ws-mf-ti-fld-zero            of ws-mf-ti-misc
008554         = ws-mf-ti-ebcdic-0           of ws-mf-ti-misc
008556         move 'MER0TRAC'
008558           to ws-mf-ti-trace-program   of ws-mf-ti-record
008560       else
008562         move 'MER1TRAC'
008564           to ws-mf-ti-trace-program   of ws-mf-ti-record
008566       end-if
008568       exec cics assign
008570         userid   (ws-mf-ti-userid     of ws-mf-ti-record)
008572         nohandle
008574       end-exec
008576       exec cics assign
008578         sysid    (ws-mf-ti-sysid      of ws-mf-ti-record)
008580         nohandle
008582       end-exec
008584       move eibtaskn                   of dfheiblk
008586         to ws-mf-ti-eibtaskn          of ws-mf-ti-record
008588       move 'MER0MMTM'
008590         to ws-mf-ti-calling-program   of ws-mf-ti-record
008592       move 'unknown'
008594         to ws-mf-ti-ebiz-program      of ws-mf-ti-record
008596     end-if
008598     exit
008600     .
008602
008604 mf-ti-write section.
008606     call ws-mf-ti-trace-program
008608       using dfheiblk
008610             dfhcommarea
008612             ws-mf-ti-record
008614       on exception
008616         continue
008618     end-call
008620     exit
008622     .
008624 
008626 7000-footprint-trace section.
008628     if ws-mf-ti-trace-level >= 1
008630       move 71 to ws-mf-ti-msg-nbr
008632       move '7000-footprint-trace' to ws-mf-ti-data-rec(1:20)
008634       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008636       move 20 to ws-mf-ti-user-data-len
008638       perform mf-ti-write
008640     end-if
008642     move ws-footprint(17:83)
008644       to footprint-data               of ws-footprint-t
008646     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
008648       to address                      of ws-footprint-t
008650     move seventy-five                 of ws-static-fields
008652       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
008654     move length                       of ws-footprint-t
008656       to ws-mf-ti-user-data-len       of ws-mf-ti-record
008658     perform mf-ti-write
008660     exit
008662     .
008664 
008666 7000-info-trace section.
008668     if ws-mf-ti-trace-level >= 1
008670       move 71 to ws-mf-ti-msg-nbr
008672       move '7000-info-trace' to ws-mf-ti-data-rec(1:15)
008674       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008676       move 15 to ws-mf-ti-user-data-len
008678       perform mf-ti-write
008680     end-if
008682     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
008684       to address                      of ws-info-t
008686     move seventy-five                 of ws-static-fields
008688       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
008690     move length                       of ws-info-t
008692       to ws-mf-ti-user-data-len       of ws-mf-ti-record
008694     perform mf-ti-write
008696     exit
008698     .
008700 
008702 7000-error-trace section.
008704     if ws-mf-ti-trace-level >= 1
008706       move 71 to ws-mf-ti-msg-nbr
008708       move '7000-error-trace' to ws-mf-ti-data-rec(1:16)
008710       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008712       move 16 to ws-mf-ti-user-data-len
008714       perform mf-ti-write
008716     end-if
008718     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
008720       to address                      of ws-error-t
008722     move seventy-five                 of ws-static-fields
008724       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
008726     move length                       of ws-error-t
008728       to ws-mf-ti-user-data-len       of ws-mf-ti-record
008730     perform mf-ti-write
008732     exit
008734     .
008736 
008738 7000-section-trace section.
008740     if ws-mf-ti-trace-level >= 1
008742       move 71 to ws-mf-ti-msg-nbr
008744       move '7000-section-trace' to ws-mf-ti-data-rec(1:18)
008746       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008748       move 18 to ws-mf-ti-user-data-len
008750       perform mf-ti-write
008752     end-if
008754     if ws-mf-ti-trace-level >= 1
008756       move 71 to ws-mf-ti-msg-nbr
008758       move '7000-section-trace' to ws-mf-ti-data-rec(1:18)
008760       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008762       move 18 to ws-mf-ti-user-data-len
008764       perform mf-ti-write
008766     end-if
008768     exit
008770     .
008772 
008774 7000-cmqgmov-trace section.
008776     if ws-mf-ti-trace-level >= 1
008778       move 71 to ws-mf-ti-msg-nbr
008780       move '7000-cmqgmov-trace' to ws-mf-ti-data-rec(1:18)
008782       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008784       move 18 to ws-mf-ti-user-data-len
008786       perform mf-ti-write
008788     end-if
008790     move mqgmo-strucid                of ws-cmqgmov-copybook
008792       to mqgmo-strucid                of ws-cmqgmov-t
008794     move mqgmo-version                of ws-cmqgmov-copybook
008796       to mqgmo-version                of ws-cmqgmov-t
008798     move mqgmo-options                of ws-cmqgmov-copybook
008800       to mqgmo-options                of ws-cmqgmov-t
008802     move mqgmo-waitinterval           of ws-cmqgmov-copybook
008804       to mqgmo-waitinterval           of ws-cmqgmov-t
008806     move mqgmo-signal1                of ws-cmqgmov-copybook
008808       to mqgmo-signal1                of ws-cmqgmov-t
008810     move mqgmo-signal2                of ws-cmqgmov-copybook
008812       to mqgmo-signal2                of ws-cmqgmov-t
008814     move mqgmo-resolvedqname          of ws-cmqgmov-copybook
008816       to mqgmo-resolvedqname          of ws-cmqgmov-t
008818     move mqgmo-matchoptions           of ws-cmqgmov-copybook
008820       to mqgmo-matchoptions           of ws-cmqgmov-t
008822     move mqgmo-groupstatus            of ws-cmqgmov-copybook
008824       to mqgmo-groupstatus            of ws-cmqgmov-t
008826     move mqgmo-segmentstatus          of ws-cmqgmov-copybook
008828       to mqgmo-segmentstatus          of ws-cmqgmov-t
008830     move mqgmo-segmentation           of ws-cmqgmov-copybook
008832       to mqgmo-segmentation           of ws-cmqgmov-t
008834     move mqgmo-reserved1              of ws-cmqgmov-copybook
008836       to mqgmo-reserved1              of ws-cmqgmov-t
008838     move mqgmo-msgtoken               of ws-cmqgmov-copybook
008840       to mqgmo-msgtoken               of ws-cmqgmov-t
008842     move mqgmo-returnedlength         of ws-cmqgmov-copybook
008844       to mqgmo-returnedlength         of ws-cmqgmov-t
008846     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
008848       to address                      of ws-cmqgmov-t
008850     move seventy-five                 of ws-static-fields
008852       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
008854     move length                       of ws-cmqgmov-t
008856       to ws-mf-ti-user-data-len       of ws-mf-ti-record
008858     perform mf-ti-write
008860     exit
008862     .
008864 
008866 7000-cmqodv-trace section.
008868     if ws-mf-ti-trace-level >= 1
008870       move 71 to ws-mf-ti-msg-nbr
008872       move '7000-cmqodv-trace' to ws-mf-ti-data-rec(1:17)
008874       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008876       move 17 to ws-mf-ti-user-data-len
008878       perform mf-ti-write
008880     end-if
008882     move mqod-strucid                 of ws-cmqodv-copybook
008884       to mqod-strucid                 of ws-cmqodv-t
008886     move mqod-version                 of ws-cmqodv-copybook
008888       to mqod-version                 of ws-cmqodv-t
008890     move mqod-objecttype              of ws-cmqodv-copybook
008892       to mqod-objecttype              of ws-cmqodv-t
008894     move mqod-objectname              of ws-cmqodv-copybook
008896       to mqod-objectname              of ws-cmqodv-t
008898     move mqod-objectqmgrname          of ws-cmqodv-copybook
008900       to mqod-objectqmgrname          of ws-cmqodv-t
008902     move mqod-dynamicqname            of ws-cmqodv-copybook
008904       to mqod-dynamicqname            of ws-cmqodv-t
008906     move mqod-alternateuserid         of ws-cmqodv-copybook
008908       to mqod-alternateuserid         of ws-cmqodv-t
008910     move mqod-recspresent             of ws-cmqodv-copybook
008912       to mqod-recspresent             of ws-cmqodv-t
008914     move mqod-knowndestcount          of ws-cmqodv-copybook
008916       to mqod-knowndestcount          of ws-cmqodv-t
008918     move mqod-unknowndestcount        of ws-cmqodv-copybook
008920       to mqod-unknowndestcount        of ws-cmqodv-t
008922     move mqod-invaliddestcount        of ws-cmqodv-copybook
008924       to mqod-invaliddestcount        of ws-cmqodv-t
008926     move mqod-objectrecoffset         of ws-cmqodv-copybook
008928       to mqod-objectrecoffset         of ws-cmqodv-t
008930     move mqod-responserecoffset       of ws-cmqodv-copybook
008932       to mqod-responserecoffset       of ws-cmqodv-t
008934     set  mqod-objectrecptr            of ws-cmqodv-t
008936       to mqod-objectrecptr            of ws-cmqodv-copybook
008938     set  mqod-responserecptr          of ws-cmqodv-t
008940       to mqod-responserecptr          of ws-cmqodv-copybook
008942     move mqod-alternatesecurityid     of ws-cmqodv-copybook
008944       to mqod-alternatesecurityid     of ws-cmqodv-t
008946     move mqod-resolvedqname           of ws-cmqodv-copybook
008948       to mqod-resolvedqname           of ws-cmqodv-t
008950     move mqod-resolvedqmgrname        of ws-cmqodv-copybook
008952       to mqod-resolvedqmgrname        of ws-cmqodv-t
008954     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
008956       to address                      of ws-cmqodv-t
008958     move seventy-five                 of ws-static-fields
008960       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
008962     move length                       of ws-cmqodv-t
008964       to ws-mf-ti-user-data-len       of ws-mf-ti-record
008966     perform mf-ti-write
008968     exit
008970     .
008972 
008974 7000-cmqmdv-trace section.
008976     if ws-mf-ti-trace-level >= 1
008978       move 71 to ws-mf-ti-msg-nbr
008980       move '7000-cmqmdv-trace' to ws-mf-ti-data-rec(1:17)
008982       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008984       move 17 to ws-mf-ti-user-data-len
008986       perform mf-ti-write
008988     end-if
008990     move mqmd-strucid                 of ws-cmqmdv-copybook
008992       to mqmd-strucid                 of ws-cmqmdv-t
008994     move mqmd-version                 of ws-cmqmdv-copybook
008996       to mqmd-version                 of ws-cmqmdv-t
008998     move mqmd-report                  of ws-cmqmdv-copybook
009000       to mqmd-report                  of ws-cmqmdv-t
009002     move mqmd-msgtype                 of ws-cmqmdv-copybook
009004       to mqmd-msgtype                 of ws-cmqmdv-t
009006     move mqmd-expiry                  of ws-cmqmdv-copybook
009008       to mqmd-expiry                  of ws-cmqmdv-t
009010     move mqmd-feedback                of ws-cmqmdv-copybook
009012       to mqmd-feedback                of ws-cmqmdv-t
009014     move mqmd-encoding                of ws-cmqmdv-copybook
009016       to mqmd-encoding                of ws-cmqmdv-t
009018     move mqmd-codedcharsetid          of ws-cmqmdv-copybook
009020       to mqmd-codedcharsetid          of ws-cmqmdv-t
009022     move mqmd-format                  of ws-cmqmdv-copybook
009024       to mqmd-format                  of ws-cmqmdv-t
009026     move mqmd-priority                of ws-cmqmdv-copybook
009028       to mqmd-priority                of ws-cmqmdv-t
009030     move mqmd-persistence             of ws-cmqmdv-copybook
009032       to mqmd-persistence             of ws-cmqmdv-t
009034     move mqmd-msgid                   of ws-cmqmdv-copybook
009036       to mqmd-msgid                   of ws-cmqmdv-t
009038     move mqmd-correlid                of ws-cmqmdv-copybook
009040       to mqmd-correlid                of ws-cmqmdv-t
009042     move mqmd-backoutcount            of ws-cmqmdv-copybook
009044       to mqmd-backoutcount            of ws-cmqmdv-t
009046     move mqmd-replytoq                of ws-cmqmdv-copybook
009048       to mqmd-replytoq                of ws-cmqmdv-t
009050     move mqmd-replytoqmgr             of ws-cmqmdv-copybook
009052       to mqmd-replytoqmgr             of ws-cmqmdv-t
009054     move mqmd-useridentifier          of ws-cmqmdv-copybook
009056       to mqmd-useridentifier          of ws-cmqmdv-t
009058     move mqmd-accountingtoken         of ws-cmqmdv-copybook
009060       to mqmd-accountingtoken         of ws-cmqmdv-t
009062     move mqmd-applidentitydata        of ws-cmqmdv-copybook
009064       to mqmd-applidentitydata        of ws-cmqmdv-t
009066     move mqmd-putappltype             of ws-cmqmdv-copybook
009068       to mqmd-putappltype             of ws-cmqmdv-t
009070     move mqmd-putapplname             of ws-cmqmdv-copybook
009072       to mqmd-putapplname             of ws-cmqmdv-t
009074     move mqmd-putdate                 of ws-cmqmdv-copybook
009076       to mqmd-putdate                 of ws-cmqmdv-t
009078     move mqmd-puttime                 of ws-cmqmdv-copybook
009080       to mqmd-puttime                 of ws-cmqmdv-t
009082     move mqmd-applorigindata          of ws-cmqmdv-copybook
009084       to mqmd-applorigindata          of ws-cmqmdv-t
009086     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
009088       to address                      of ws-cmqmdv-t
009090     move seventy-five                 of ws-static-fields
009092       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
009094     move length                       of ws-cmqmdv-t
009096       to ws-mf-ti-user-data-len       of ws-mf-ti-record
009098     perform mf-ti-write
009100     exit
009102     .
009104 
009106 7000-cmqpmov-trace section.
009108     if ws-mf-ti-trace-level >= 1
009110       move 71 to ws-mf-ti-msg-nbr
009112       move '7000-cmqpmov-trace' to ws-mf-ti-data-rec(1:18)
009114       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
009116       move 18 to ws-mf-ti-user-data-len
009118       perform mf-ti-write
009120     end-if
009122     move mqpmo-strucid                of ws-cmqpmov-copybook
009124       to mqpmo-strucid                of ws-cmqpmov-t
009126     move mqpmo-version                of ws-cmqpmov-copybook
009128       to mqpmo-version                of ws-cmqpmov-t
009130     move mqpmo-options                of ws-cmqpmov-copybook
009132       to mqpmo-options                of ws-cmqpmov-t
009134     move mqpmo-timeout                of ws-cmqpmov-copybook
009136       to mqpmo-timeout                of ws-cmqpmov-t
009138     move mqpmo-context                of ws-cmqpmov-copybook
009140       to mqpmo-context                of ws-cmqpmov-t
009142     move mqpmo-knowndestcount         of ws-cmqpmov-copybook
009144       to mqpmo-knowndestcount         of ws-cmqpmov-t
009146     move mqpmo-unknowndestcount       of ws-cmqpmov-copybook
009148       to mqpmo-unknowndestcount       of ws-cmqpmov-t
009150     move mqpmo-invaliddestcount       of ws-cmqpmov-copybook
009152       to mqpmo-invaliddestcount       of ws-cmqpmov-t
009154     move mqpmo-resolvedqname          of ws-cmqpmov-copybook
009156       to mqpmo-resolvedqname          of ws-cmqpmov-t
009158     move mqpmo-resolvedqmgrname       of ws-cmqpmov-copybook
009160       to mqpmo-resolvedqmgrname       of ws-cmqpmov-t
009162     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
009164       to address                      of ws-cmqpmov-t
009166     move seventy-five                 of ws-static-fields
009168       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
009170     move length                       of ws-cmqpmov-t
009172       to ws-mf-ti-user-data-len       of ws-mf-ti-record
009174     perform mf-ti-write
009176     exit
009178     .
009180 
009182 7000-nwif-trace section.
009184     if ws-mf-ti-trace-level >= 1
009186       move 71 to ws-mf-ti-msg-nbr
009188       move '7000-nwif-trace' to ws-mf-ti-data-rec(1:15)
009190       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
009192       move 15 to ws-mf-ti-user-data-len
009194       perform mf-ti-write
009196     end-if
009198     set  this-pntr                    of ws-nwif-t
009200       to this-pntr                    of lk-nwif-t
009202     move struclen                     of lk-nwif-t
009204       to struclen                     of ws-nwif-t
009206     move version                      of lk-nwif-t
009208       to version                      of ws-nwif-t
009210     move mq03-alt-name                of lk-nwif-t
009212       to mq03-alt-name                of ws-nwif-t
009214     move trace-level                  of lk-nwif-t
009216       to trace-level                  of ws-nwif-t
009218     move trace-queue-name             of lk-nwif-t
009220       to trace-queue-name             of ws-nwif-t
009222     move useridx                      of lk-nwif-t
009224       to useridx                      of ws-nwif-t
009226     move ebiz-name                    of lk-nwif-t
009228       to ebiz-name                    of ws-nwif-t
009230     move upgm-name                    of lk-nwif-t
009232       to upgm-name                    of ws-nwif-t
009234     move copybook-mode                of lk-nwif-t
009236       to copybook-mode                of ws-nwif-t
009238     move processing-mode              of lk-nwif-t
009240       to processing-mode              of ws-nwif-t
009242     move security-status              of lk-nwif-t
009244       to security-status              of ws-nwif-t
009246     move mf-processing-mode           of lk-nwif-t
009248       to mf-processing-mode           of ws-nwif-t
009250     move mf-abend-program             of lk-nwif-t
009252       to mf-abend-program             of ws-nwif-t
009254     move mf-abend-code                of lk-nwif-t
009256       to mf-abend-code                of ws-nwif-t
009258     move mf-return-code               of lk-nwif-t
009260       to mf-return-code               of ws-nwif-t
009262     move mf-reason                    of lk-nwif-t
009264       to mf-reason                    of ws-nwif-t
009266     move mf-msg                       of lk-nwif-t
009268       to mf-msg                       of ws-nwif-t
009270     move mqtm-userdata                of lk-nwif-t
009272       to mqtm-userdata                of ws-nwif-t
009274     set  req-msg-pntr                 of ws-nwif-t
009276       to req-msg-pntr                 of lk-nwif-t
009278     move req-msg-hdr-lenf             of lk-nwif-t
009280       to req-msg-hdr-lenf             of ws-nwif-t
009282     move req-msg-hdr-ext-lenf         of lk-nwif-t
009284       to req-msg-hdr-ext-lenf         of ws-nwif-t
009286     move req-fmt-hdr-lenf             of lk-nwif-t
009288       to req-fmt-hdr-lenf             of ws-nwif-t
009290     move req-ebiz-hdr-lenf            of lk-nwif-t
009292       to req-ebiz-hdr-lenf            of ws-nwif-t
009294     move req-ebiz-data-full-lenf      of lk-nwif-t
009296       to req-ebiz-data-full-lenf      of ws-nwif-t
009298     move req-ebiz-data-used-lenf      of lk-nwif-t
009300       to req-ebiz-data-used-lenf      of ws-nwif-t
009302     move req-msg-total-full-lenf      of lk-nwif-t
009304       to req-msg-total-full-lenf      of ws-nwif-t
009306     move req-msg-total-used-lenf      of lk-nwif-t
009308       to req-msg-total-used-lenf      of ws-nwif-t
009310     move req-qmgr-name                of lk-nwif-t
009312       to req-qmgr-name                of ws-nwif-t
009314     move req-qname                    of lk-nwif-t
009316       to req-qname                    of ws-nwif-t
009318     move req-queue-nbr                of lk-nwif-t
009320       to req-queue-nbr                of ws-nwif-t
009322     move req-expiry                   of lk-nwif-t
009324       to req-expiry                   of ws-nwif-t
009326     move req-wait-interval            of lk-nwif-t
009328       to req-wait-interval            of ws-nwif-t
009330     move req-persistent               of lk-nwif-t
009332       to req-persistent               of ws-nwif-t
009334     move req-msgid                    of lk-nwif-t
009336       to req-msgid                    of ws-nwif-t
009338     move req-correlid                 of lk-nwif-t
009340       to req-correlid                 of ws-nwif-t
009342     set  rep-msg-pntr                 of ws-nwif-t
009344       to rep-msg-pntr                 of lk-nwif-t
009346     move rep-msg-hdr-lenf             of lk-nwif-t
009348       to rep-msg-hdr-lenf             of ws-nwif-t
009350     move rep-fmt-hdr-lenf             of lk-nwif-t
009352       to rep-fmt-hdr-lenf             of ws-nwif-t
009354     move rep-ebiz-hdr-lenf            of lk-nwif-t
009356       to rep-ebiz-hdr-lenf            of ws-nwif-t
009358     move rep-ebiz-data-full-lenf      of lk-nwif-t
009360       to rep-ebiz-data-full-lenf      of ws-nwif-t
009362     move rep-ebiz-data-used-lenf      of lk-nwif-t
009364       to rep-ebiz-data-used-lenf      of ws-nwif-t
009366     move rep-msg-total-full-lenf      of lk-nwif-t
009368       to rep-msg-total-full-lenf      of ws-nwif-t
009370     move rep-msg-total-used-lenf      of lk-nwif-t
009372       to rep-msg-total-used-lenf      of ws-nwif-t
009374     move rep-qmgr-name                of lk-nwif-t
009376       to rep-qmgr-name                of ws-nwif-t
009378     move rep-qname                    of lk-nwif-t
009380       to rep-qname                    of ws-nwif-t
009382     move rep-queue-nbr                of lk-nwif-t
009384       to rep-queue-nbr                of ws-nwif-t
009386     move rep-expiry                   of lk-nwif-t
009388       to rep-expiry                   of ws-nwif-t
009390     move rep-wait-interval            of lk-nwif-t
009392       to rep-wait-interval            of ws-nwif-t
009394     move rep-persistent               of lk-nwif-t
009396       to rep-persistent               of ws-nwif-t
009398     move rep-msgid                    of lk-nwif-t
009400       to rep-msgid                    of ws-nwif-t
009402     move rep-correlid                 of lk-nwif-t
009404       to rep-correlid                 of ws-nwif-t
009406     set  to-upgm-bfr-pntr             of ws-nwif-t
009408       to to-upgm-bfr-pntr             of lk-nwif-t
009410     move to-upgm-bfr-full-lenf        of lk-nwif-t
009412       to to-upgm-bfr-full-lenf        of ws-nwif-t
009414     move to-upgm-bfr-used-lenf        of lk-nwif-t
009416       to to-upgm-bfr-used-lenf        of ws-nwif-t
009418     move to-upgm-qmgr-name            of lk-nwif-t
009420       to to-upgm-qmgr-name            of ws-nwif-t
009422     move to-upgm-qname                of lk-nwif-t
009424       to to-upgm-qname                of ws-nwif-t
009426     move to-upgm-queue-nbr            of lk-nwif-t
009428       to to-upgm-queue-nbr            of ws-nwif-t
009430     move to-upgm-expiry               of lk-nwif-t
009432       to to-upgm-expiry               of ws-nwif-t
009434     move to-upgm-wait-interval        of lk-nwif-t
009436       to to-upgm-wait-interval        of ws-nwif-t
009438     move to-upgm-persistent           of lk-nwif-t
009440       to to-upgm-persistent           of ws-nwif-t
009442     move to-upgm-msgid                of lk-nwif-t
009444       to to-upgm-msgid                of ws-nwif-t
009446     move to-upgm-correlid             of lk-nwif-t
009448       to to-upgm-correlid             of ws-nwif-t
009450     set  from-upgm-bfr-pntr           of ws-nwif-t
009452       to from-upgm-bfr-pntr           of lk-nwif-t
009454     move from-upgm-bfr-full-lenf      of lk-nwif-t
009456       to from-upgm-bfr-full-lenf      of ws-nwif-t
009458     move from-upgm-bfr-used-lenf      of lk-nwif-t
009460       to from-upgm-bfr-used-lenf      of ws-nwif-t
009462     move from-upgm-qmgr-name          of lk-nwif-t
009464       to from-upgm-qmgr-name          of ws-nwif-t
009466     move from-upgm-qname              of lk-nwif-t
009468       to from-upgm-qname              of ws-nwif-t
009470     move from-upgm-queue-nbr          of lk-nwif-t
009472       to from-upgm-queue-nbr          of ws-nwif-t
009474     move from-upgm-expiry             of lk-nwif-t
009476       to from-upgm-expiry             of ws-nwif-t
009478     move from-upgm-wait-interval      of lk-nwif-t
009480       to from-upgm-wait-interval      of ws-nwif-t
009482     move from-upgm-persistent         of lk-nwif-t
009484       to from-upgm-persistent         of ws-nwif-t
009486     move from-upgm-msgid              of lk-nwif-t
009488       to from-upgm-msgid              of ws-nwif-t
009490     move from-upgm-correlid           of lk-nwif-t
009492       to from-upgm-correlid           of ws-nwif-t
009494     move from-upgm-processing-mode    of lk-nwif-t
009496       to from-upgm-processing-mode    of ws-nwif-t
009498     move from-upgm-abend-program      of lk-nwif-t
009500       to from-upgm-abend-program      of ws-nwif-t
009502     move from-upgm-abend-code         of lk-nwif-t
009504       to from-upgm-abend-code         of ws-nwif-t
009506     move from-upgm-return-code        of lk-nwif-t
009508       to from-upgm-return-code        of ws-nwif-t
009510     move from-upgm-reason             of lk-nwif-t
009512       to from-upgm-reason             of ws-nwif-t
009514     move from-upgm-msg                of lk-nwif-t
009516       to from-upgm-msg                of ws-nwif-t
009518     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
009520       to address                      of ws-nwif-t
009522     move seventy-five                 of ws-static-fields
009524       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
009526     move length                       of ws-nwif-t
009528       to ws-mf-ti-user-data-len       of ws-mf-ti-record
009530     perform mf-ti-write
009532     exit
009534     .
009536 
009538 7000-mwih-trace section.
009540     if ws-mf-ti-trace-level >= 1
009542       move 71 to ws-mf-ti-msg-nbr
009544       move '7000-mwih-trace' to ws-mf-ti-data-rec(1:15)
009546       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
009548       move 15 to ws-mf-ti-user-data-len
009550       perform mf-ti-write
009552     end-if
009554     move basepntr-x
009556       to base-pntr                    of ws-msg-hdr-t
009558     set  pntr-p
009560       to address                      of lk-msg-hdr-t
009562     move pntr-x
009564       to this-pntr                    of ws-msg-hdr-t
009566     move length                       of lk-msg-hdr-t
009568       to this-length                  of ws-msg-hdr-t
009570     move message-encoding             of lk-msg-hdr-t
009572       to message-encoding             of ws-msg-hdr-t
009574     move msg-sequence-num             of lk-msg-hdr-t
009576       to msg-sequence-num             of ws-msg-hdr-t
009578     move msg-xmit-time                of lk-msg-hdr-t
009580       to msg-xmit-time                of ws-msg-hdr-t
009582     move trace-flags                  of lk-msg-hdr-t
009584       to trace-flags                  of ws-msg-hdr-t
009586     move msg-max-length               of lk-msg-hdr-t
009588       to msg-max-length               of ws-msg-hdr-t
009590     move appl-msg-length              of lk-msg-hdr-t
009592       to appl-msg-length              of ws-msg-hdr-t
009594     move trace-ts-q                   of lk-msg-hdr-t
009596       to trace-ts-q                   of ws-msg-hdr-t
009598     move useridx                      of lk-msg-hdr-t
009600       to useridx                      of ws-msg-hdr-t
009602     move '********'
009604       to passwordx                    of ws-msg-hdr-t
009606     move public-key                   of lk-msg-hdr-t
009608       to public-key                   of ws-msg-hdr-t
009610     move sessionid                    of lk-msg-hdr-t
009612       to sessionid                    of ws-msg-hdr-t
009614     move function-code                of lk-msg-hdr-t
009616       to function-code                of ws-msg-hdr-t
009618     move secondary-func-code          of lk-msg-hdr-t
009620       to secondary-func-code          of ws-msg-hdr-t
009622     move resource-url                 of lk-msg-hdr-t
009624       to resource-url                 of ws-msg-hdr-t
009626     move mq-put-msg-expiry            of lk-msg-hdr-t
009628       to mq-put-msg-expiry            of ws-msg-hdr-t
009630     move mq-get-msg-wait              of lk-msg-hdr-t
009632       to mq-get-msg-wait              of ws-msg-hdr-t
009634     move mq-persistence-flag          of lk-msg-hdr-t
009636       to mq-persistence-flag          of ws-msg-hdr-t
009638     move spaces
009640       to filler13                     of ws-msg-hdr-t
009642     move cics-verify                  of lk-msg-hdr-t
009644       to cics-verify                  of ws-msg-hdr-t
009646     move message-exit                 of lk-msg-hdr-t
009648       to message-exit                 of ws-msg-hdr-t
009650     move ebiz-type                    of lk-msg-hdr-t
009652       to ebiz-type                    of ws-msg-hdr-t
009654     move reserved                     of lk-msg-hdr-t
009656       to reserved                     of ws-msg-hdr-t
009658     move return-codex                 of lk-msg-hdr-t
009660       to return-codex                 of ws-msg-hdr-t
009662     move reason-codex                 of lk-msg-hdr-t
009664       to reason-codex                 of ws-msg-hdr-t
009666     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
009668       to address                      of ws-msg-hdr-t
009670     move seventy-five                 of ws-static-fields
009672       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
009674     move length                       of ws-msg-hdr-t
009676       to ws-mf-ti-user-data-len       of ws-mf-ti-record
009678     perform mf-ti-write
009680     exit
009682     .
009684 
009686 7000-mwih-ext-trace section.
009688     if ws-mf-ti-trace-level >= 1
009690       move 71 to ws-mf-ti-msg-nbr
009692       move '7000-mwih-ext-trace' to ws-mf-ti-data-rec(1:19)
009694       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
009696       move 19 to ws-mf-ti-user-data-len
009698       perform mf-ti-write
009700     end-if
009702     move basepntr-x
009704       to base-pntr                    of ws-msg-hdr-ext-t
009706     set  pntr-p
009708       to address                      of lk-msg-hdr-ext-t
009710     move pntr-x
009712       to this-pntr                    of ws-msg-hdr-ext-t
009714     move length                       of lk-msg-hdr-ext-t
009716       to this-length                  of ws-msg-hdr-ext-t
009718     move to-upgm-qmgr-name            of lk-msg-hdr-ext-t
009720       to to-upgm-qmgr-name            of ws-msg-hdr-ext-t
009722     move to-upgm-qname                of lk-msg-hdr-ext-t
009724       to to-upgm-qname                of ws-msg-hdr-ext-t
009726     move to-upgm-queue-nbr            of lk-msg-hdr-ext-t
009728       to to-upgm-queue-nbr            of ws-msg-hdr-ext-t
009730     move to-upgm-expiry               of lk-msg-hdr-ext-t
009732       to to-upgm-expiry               of ws-msg-hdr-ext-t
009734     move to-upgm-wait-interval        of lk-msg-hdr-ext-t
009736       to to-upgm-wait-interval        of ws-msg-hdr-ext-t
009738     move to-upgm-persistent           of lk-msg-hdr-ext-t
009740       to to-upgm-persistent           of ws-msg-hdr-ext-t
009742     move from-upgm-qmgr-name          of lk-msg-hdr-ext-t
009744       to from-upgm-qmgr-name          of ws-msg-hdr-ext-t
009746     move from-upgm-qname              of lk-msg-hdr-ext-t
009748       to from-upgm-qname              of ws-msg-hdr-ext-t
009750     move from-upgm-queue-nbr          of lk-msg-hdr-ext-t
009752       to from-upgm-queue-nbr          of ws-msg-hdr-ext-t
009754     move from-upgm-expiry             of lk-msg-hdr-ext-t
009756       to from-upgm-expiry             of ws-msg-hdr-ext-t
009758     move from-upgm-wait-interval      of lk-msg-hdr-ext-t
009760       to from-upgm-wait-interval      of ws-msg-hdr-ext-t
009762     move from-upgm-persistent         of lk-msg-hdr-ext-t
009764       to from-upgm-persistent         of ws-msg-hdr-ext-t
009766     move mq03-alt-name                of lk-msg-hdr-ext-t
009768       to mq03-alt-name                of ws-msg-hdr-ext-t
009770     move reserved                     of lk-msg-hdr-ext-t
009772       to reserved                     of ws-msg-hdr-ext-t
009774     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
009776       to address                      of ws-msg-hdr-ext-t
009778     move seventy-five                 of ws-static-fields
009780       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
009782     move length                       of ws-msg-hdr-ext-t
009784       to ws-mf-ti-user-data-len       of ws-mf-ti-record
009786     perform mf-ti-write
009788     exit
009790     .
009792 
009794 7000-fmth-trace section.
009796     if ws-mf-ti-trace-level >= 1
009798       move 71 to ws-mf-ti-msg-nbr
009800       move '7000-fmth-trace' to ws-mf-ti-data-rec(1:15)
009802       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
009804       move 15 to ws-mf-ti-user-data-len
009806       perform mf-ti-write
009808     end-if
009810     move basepntr-x
009812       to base-pntr                    of ws-fmt-hdr-t
009814     set  pntr-p
009816       to address                      of lk-fmt-hdr-t
009818     move pntr-x
009820       to this-pntr                    of ws-fmt-hdr-t
009822     move length                       of lk-fmt-hdr-t
009824       to this-length                  of ws-fmt-hdr-t
009826     move version                      of lk-fmt-hdr-t
009828       to version                      of ws-fmt-hdr-t
009830     move codepage                     of lk-fmt-hdr-t
009832       to codepage                     of ws-fmt-hdr-t
009834     move encoding-format              of lk-fmt-hdr-t
009836       to encoding-format              of ws-fmt-hdr-t
009838     move platform                     of lk-fmt-hdr-t
009840       to platform                     of ws-fmt-hdr-t
009842     move message-length               of lk-fmt-hdr-t
009844       to message-length               of ws-fmt-hdr-t
009846     move filler1                      of lk-fmt-hdr-t
009848       to filler1                      of ws-fmt-hdr-t
009850     move formatter-trace-flag         of lk-fmt-hdr-t
009852       to formatter-trace-flag         of ws-fmt-hdr-t
009854     move trace-flags                  of lk-fmt-hdr-t
009856       to trace-flags                  of ws-fmt-hdr-t
009858     move trace-ts-q                   of lk-fmt-hdr-t
009860       to trace-ts-q                   of ws-fmt-hdr-t
009862     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
009864       to address                      of ws-fmt-hdr-t
009866     move seventy-five                 of ws-static-fields
009868       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
009870     move length                       of ws-fmt-hdr-t
009872       to ws-mf-ti-user-data-len       of ws-mf-ti-record
009874     perform mf-ti-write
009876     exit
009878     .
009880 
009882 7000-fmth-c-trace section.
009884     if ws-mf-ti-trace-level >= 1
009886       move 71 to ws-mf-ti-msg-nbr
009888       move '7000-fmth-c-trace' to ws-mf-ti-data-rec(1:17)
009890       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
009892       move 17 to ws-mf-ti-user-data-len
009894       perform mf-ti-write
009896     end-if
009898     move basepntr-x
009900       to base-pntr                    of ws-fmt-hdr-t
009902     set  pntr-p
009904       to address                      of lk-fmt-hdr-c-t
009906     move pntr-x
009908       to this-pntr                    of ws-fmt-hdr-t
009910     move length                       of lk-fmt-hdr-c-t
009912       to this-length                  of ws-fmt-hdr-t
009914     move version                      of lk-fmt-hdr-c-t
009916       to version                      of ws-fmt-hdr-t
009918     move codepage                     of lk-fmt-hdr-c-t
009920       to codepage                     of ws-fmt-hdr-t
009922     move encoding-format              of lk-fmt-hdr-c-t
009924       to encoding-format              of ws-fmt-hdr-t
009926     move platform                     of lk-fmt-hdr-c-t
009928       to platform                     of ws-fmt-hdr-t
009930     move message-length               of lk-fmt-hdr-c-t
009932       to message-length               of ws-fmt-hdr-t
009934     move filler1                      of lk-fmt-hdr-c-t
009936       to filler1                      of ws-fmt-hdr-t
009938     move formatter-trace-flag         of lk-fmt-hdr-c-t
009940       to formatter-trace-flag         of ws-fmt-hdr-t
009942     move trace-flags                  of lk-fmt-hdr-c-t
009944       to trace-flags                  of ws-fmt-hdr-t
009946     move trace-ts-q                   of lk-fmt-hdr-c-t
009948       to trace-ts-q                   of ws-fmt-hdr-t
009950     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
009952       to address                      of ws-fmt-hdr-t
009954     move seventy-five                 of ws-static-fields
009956       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
009958     move length                       of ws-fmt-hdr-t
009960       to ws-mf-ti-user-data-len       of ws-mf-ti-record
009962     perform mf-ti-write
009964     exit
009966     .
009968 
009970 7000-reqh-trace section.
009972     if ws-mf-ti-trace-level >= 1
009974       move 71 to ws-mf-ti-msg-nbr
009976       move '7000-reqh-trace' to ws-mf-ti-data-rec(1:15)
009978       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
009980       move 15 to ws-mf-ti-user-data-len
009982       perform mf-ti-write
009984     end-if
009986     move basepntr-x
009988       to base-pntr                  of ws-ebiz-req-hdr-t
009990     set  pntr-p
009992       to address                    of lk-ebiz-req-hdr-t
009994     move pntr-x
009996       to this-pntr                  of ws-ebiz-req-hdr-t
009998     move length                     of lk-ebiz-req-hdr-t
010000       to this-length                of ws-ebiz-req-hdr-t
010002     move useridx                      of lk-ebiz-req-hdr-t
010004       to useridx                      of ws-ebiz-req-hdr-t
010006     move '********'
010008       to passwordx                    of ws-ebiz-req-hdr-t
010010     move facilitylike                 of lk-ebiz-req-hdr-t
010012       to facilitylike                 of ws-ebiz-req-hdr-t
010014     move recovery-step                of lk-ebiz-req-hdr-t
010016       to recovery-step                of ws-ebiz-req-hdr-t
010018     move recovery-flag                of lk-ebiz-req-hdr-t
010020       to recovery-flag                of ws-ebiz-req-hdr-t
010022     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
010024       to address                      of ws-ebiz-req-hdr-t
010026     move seventy-five                 of ws-static-fields
010028       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
010030     move length                       of ws-ebiz-req-hdr-t
010032       to ws-mf-ti-user-data-len       of ws-mf-ti-record
010034     perform mf-ti-write
010036     exit
010038     .
010040 
010042 7000-reph-trace section.
010044     if ws-mf-ti-trace-level >= 1
010046       move 71 to ws-mf-ti-msg-nbr
010048       move '7000-reph-trace' to ws-mf-ti-data-rec(1:15)
010050       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
010052       move 15 to ws-mf-ti-user-data-len
010054       perform mf-ti-write
010056     end-if
010058     move basepntr-x
010060       to base-pntr                    of ws-ebiz-rep-hdr-t
010062     set  pntr-p
010064       to address                      of lk-ebiz-rep-hdr-t
010066     move pntr-x
010068       to this-pntr                    of ws-ebiz-rep-hdr-t
010070     move length                       of lk-ebiz-rep-hdr-t
010072       to this-length                  of ws-ebiz-rep-hdr-t
010074     move target                       of lk-ebiz-rep-hdr-t
010076       to target                       of ws-ebiz-rep-hdr-t
010078     move abendcode                    of lk-ebiz-rep-hdr-t
010080       to abendcode                    of ws-ebiz-rep-hdr-t
010082     move statusx                      of lk-ebiz-rep-hdr-t
010084       to statusx                      of ws-ebiz-rep-hdr-t
010086     move status-msg                   of lk-ebiz-rep-hdr-t
010088       to status-msg                   of ws-ebiz-rep-hdr-t
010090     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
010092       to address                      of ws-ebiz-rep-hdr-t
010094     move seventy-five                 of ws-static-fields
010096       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
010098     move length                       of ws-ebiz-rep-hdr-t
010100       to ws-mf-ti-user-data-len       of ws-mf-ti-record
010102     perform mf-ti-write
010104     exit
010106     .
010108 
010110 7000-retrieve-trace section.
010112     if ws-mf-ti-trace-level >= 1
010114       move 71 to ws-mf-ti-msg-nbr
010116       move '7000-retrieve-trace' to ws-mf-ti-data-rec(1:19)
010118       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
010120       move 19 to ws-mf-ti-user-data-len
010122       perform mf-ti-write
010124     end-if
010126     if ws-mf-ti-trace-level >= 4
010128       move retrieve-resp of ws-retrieve-misc to 
010130           ws-mf-ti-num1-disp
010132       move retrieve-resp2 of ws-retrieve-misc to 
010134           ws-mf-ti-num2-disp
010136       move retrieve-length of ws-retrieve-misc to 
010138           ws-mf-ti-num3-disp
010140       move 1 to ws-mf-ti-string-len
010142       string 'retrieve -'
010144              ' resp: ' ws-mf-ti-num1-disp
010146              ', resp2: ' ws-mf-ti-num2-disp
010148              ', length: ' ws-mf-ti-num3-disp
010150              delimited by size
010152         into ws-mf-ti-data-rec
010154         with pointer ws-mf-ti-string-len
010156       subtract 1 from ws-mf-ti-string-len
010158       move 75 to ws-mf-ti-msg-nbr
010160       set ws-mf-ti-user-data-pntr
010162         to address of ws-mf-ti-data-rec (1:1)
010164       move ws-mf-ti-string-len to ws-mf-ti-user-data-len
010166       perform mf-ti-write
010168     end-if
010170     exit
010172     .
010174 
010176 7000-start-trace section.
010178     if ws-mf-ti-trace-level >= 1
010180       move 71 to ws-mf-ti-msg-nbr
010182       move '7000-start-trace' to ws-mf-ti-data-rec(1:16)
010184       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
010186       move 16 to ws-mf-ti-user-data-len
010188       perform mf-ti-write
010190     end-if
010192     move start-resp                   of ws-start-misc
010194       to start-resp                   of ws-start-t
010196     move start-resp2                  of ws-start-misc
010198       to start-resp2                  of ws-start-t
010200     move start-from                   of ws-start-misc
010202       to start-from                   of ws-start-t
010204     move start-length                 of ws-start-misc
010206       to start-length                 of ws-start-t
010208     move start-transid                of ws-start-misc
010210       to start-transid                of ws-start-t
010212     move start-userid                 of ws-start-misc
010214       to start-userid                 of ws-start-t
010216     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
010218       to address                      of ws-start-t
010220     move seventy-five                 of ws-static-fields
010222       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
010224     move length                       of ws-start-t
010226       to ws-mf-ti-user-data-len       of ws-mf-ti-record
010228     perform mf-ti-write
010230     exit
010232     .
010234 
010236 7000-verify-trace section.
010238     if ws-mf-ti-trace-level >= 1
010240       move 71 to ws-mf-ti-msg-nbr
010242       move '7000-verify-trace' to ws-mf-ti-data-rec(1:17)
010244       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
010246       move 17 to ws-mf-ti-user-data-len
010248       perform mf-ti-write
010250     end-if
010252     move verify-resp                  of ws-verify-misc
010254       to verify-resp                  of ws-verify-t
010256     move verify-resp2                 of ws-verify-misc
010258       to verify-resp2                 of ws-verify-t
010260     move verify-userid                of ws-verify-misc
010262       to verify-userid                of ws-verify-t
010264     move '********'
010266       to verify-password              of ws-verify-t
010268     move verify-daysleft              of ws-verify-misc
010270       to verify-daysleft              of ws-verify-t
010272     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
010274       to address                      of ws-verify-t
010276     move seventy-five                 of ws-static-fields
010278       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
010280     move length                       of ws-verify-t
010282       to ws-mf-ti-user-data-len       of ws-mf-ti-record
010284     perform mf-ti-write
010286     exit
010288     .
010290 
010292 7000-cmqtml-trace section.
010294     if ws-mf-ti-trace-level >= 1
010296       move 71 to ws-mf-ti-msg-nbr
010298       move '7000-cmqtml-trace' to ws-mf-ti-data-rec(1:17)
010300       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
010302       move 17 to ws-mf-ti-user-data-len
010304       perform mf-ti-write
010306     end-if
010308     move mqtm-strucid                 of ws-cmqtml-copybook
010310       to mqtm-strucid                 of ws-cmqtml-t
010312     move mqtm-version                 of ws-cmqtml-copybook
010314       to mqtm-version                 of ws-cmqtml-t
010316     move mqtm-qname                   of ws-cmqtml-copybook
010318       to mqtm-qname                   of ws-cmqtml-t
010320     move mqtm-processname             of ws-cmqtml-copybook
010322       to mqtm-processname             of ws-cmqtml-t
010324     move mqtm-triggerdata             of ws-cmqtml-copybook
010326       to mqtm-triggerdata             of ws-cmqtml-t
010328     move mqtm-appltype                of ws-cmqtml-copybook
010330       to mqtm-appltype                of ws-cmqtml-t
010332     move mqtm-applid                  of ws-cmqtml-copybook
010334       to mqtm-applid                  of ws-cmqtml-t
010336     move mqtm-envdata                 of ws-cmqtml-copybook
010338       to mqtm-envdata                 of ws-cmqtml-t
010340     move mqtm-userdata                of ws-cmqtml-copybook
010342       to mqtm-userdata                of ws-cmqtml-t
010344     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
010346       to address                      of ws-cmqtml-t
010348     move seventy-five                 of ws-static-fields
010350       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
010352     move length                       of ws-cmqtml-t
010354       to ws-mf-ti-user-data-len       of ws-mf-ti-record
010356     perform mf-ti-write
010358     exit
010360     .
010362 
010364 7000-mqclose-trace section.
010366     if ws-mf-ti-trace-level >= 1
010368       move 71 to ws-mf-ti-msg-nbr
010370       move '7000-mqclose-trace' to ws-mf-ti-data-rec(1:18)
010372       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
010374       move 18 to ws-mf-ti-user-data-len
010376       perform mf-ti-write
010378     end-if
010380     if ws-mf-ti-trace-level >= 4
010382       move mqclose-hconn of ws-mqclose-misc to 
010384           ws-mf-ti-handle1-disp
010386       move mqclose-options of ws-mqclose-misc to 
010388           ws-mf-ti-num1-disp
010390       move mqclose-q-handle of ws-mqclose-misc to 
010392           ws-mf-ti-handle2-disp
010394       move mqclose-comp-code of ws-mqclose-misc to 
010396           ws-mf-ti-num2-disp
010398       move mqclose-reason of ws-mqclose-misc to 
010400           ws-mf-ti-num3-disp
010402       move 1 to ws-mf-ti-string-len
010404       string 'mqclose -'
010406              ' hconn: ' ws-mf-ti-handle1-disp
010408              ', options: ' ws-mf-ti-num1-disp
010410              ', handle: ' ws-mf-ti-handle2-disp
010412              ', compcode: ' ws-mf-ti-num2-disp
010414              ', reason: ' ws-mf-ti-num3-disp
010416              delimited by size
010418         into ws-mf-ti-data-rec
010420         with pointer ws-mf-ti-string-len
010422       subtract 1 from ws-mf-ti-string-len
010424       move 75 to ws-mf-ti-msg-nbr
010426       set ws-mf-ti-user-data-pntr
010428         to address of ws-mf-ti-data-rec (1:1)
010430       move ws-mf-ti-string-len to ws-mf-ti-user-data-len
010432       perform mf-ti-write
010434     end-if
010436     exit
010438     .
010440 
010442 7000-mqget-trace section.
010444     if ws-mf-ti-trace-level >= 1
010446       move 71 to ws-mf-ti-msg-nbr
010448       move '7000-mqget-trace' to ws-mf-ti-data-rec(1:16)
010450       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
010452       move 16 to ws-mf-ti-user-data-len
010454       perform mf-ti-write
010456     end-if
010458     if ws-mf-ti-trace-level >= 4
010460       move mqget-hconn of ws-mqget-misc to ws-mf-ti-handle1-disp
010462       move mqget-q-handle of ws-mqget-misc to 
010464           ws-mf-ti-handle2-disp
010466       move mqget-comp-code of ws-mqget-misc to ws-mf-ti-num2-disp
010468       move mqget-reason of ws-mqget-misc to ws-mf-ti-num3-disp
010470       move mqget-buffer-lenf of ws-mqget-misc to 
010472           ws-mf-ti-length-1-disp
010474       move mqget-data-lenf of ws-mqget-misc to 
010476           ws-mf-ti-length-2-disp
010478       move 1 to ws-mf-ti-string-len
010480       string 'mqget -'
010482              ' hconn: ' ws-mf-ti-handle1-disp
010484              ', handle: ' ws-mf-ti-handle2-disp
010486              ', buffer length: ' ws-mf-ti-length-1-disp
010488              ', data length: ' ws-mf-ti-length-2-disp
010490              ', compcode: ' ws-mf-ti-num2-disp
010492              ', reason: ' ws-mf-ti-num3-disp
010494              delimited by size
010496         into ws-mf-ti-data-rec
010498         with pointer ws-mf-ti-string-len
010500       subtract 1 from ws-mf-ti-string-len
010502       move 75 to ws-mf-ti-msg-nbr
010504       set ws-mf-ti-user-data-pntr
010506         to address of ws-mf-ti-data-rec (1:1)
010508       move ws-mf-ti-string-len to ws-mf-ti-user-data-len
010510       perform mf-ti-write
010512     end-if
010514     exit
010516     .
010518 
010520 7000-mqopen-trace section.
010522     if ws-mf-ti-trace-level >= 1
010524       move 71 to ws-mf-ti-msg-nbr
010526       move '7000-mqopen-trace' to ws-mf-ti-data-rec(1:17)
010528       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
010530       move 17 to ws-mf-ti-user-data-len
010532       perform mf-ti-write
010534     end-if
010536     if ws-mf-ti-trace-level >= 4
010538       move mqopen-hconn of ws-mqopen-misc to 
010540           ws-mf-ti-handle1-disp
010542       move mqopen-options of ws-mqopen-misc to ws-mf-ti-num1-disp
010544       move mqopen-q-handle of ws-mqopen-misc to 
010546           ws-mf-ti-handle2-disp
010548       move mqopen-comp-code of ws-mqopen-misc to 
010550           ws-mf-ti-num2-disp
010552       move mqopen-reason of ws-mqopen-misc to ws-mf-ti-num3-disp
010554       move 1 to ws-mf-ti-string-len
010556       string 'mqopen -'
010558              ' hconn: ' ws-mf-ti-handle1-disp
010560              ', options: ' ws-mf-ti-num1-disp
010562              ', handle: ' ws-mf-ti-handle2-disp
010564              ', compcode: ' ws-mf-ti-num2-disp
010566              ', reason: ' ws-mf-ti-num3-disp
010568              delimited by size
010570         into ws-mf-ti-data-rec
010572         with pointer ws-mf-ti-string-len
010574       subtract 1 from ws-mf-ti-string-len
010576       move 75 to ws-mf-ti-msg-nbr
010578       set ws-mf-ti-user-data-pntr
010580         to address of ws-mf-ti-data-rec (1:1)
010582       move ws-mf-ti-string-len to ws-mf-ti-user-data-len
010584       perform mf-ti-write
010586     end-if
010588     exit
010590     .
010592 
010594 7000-offsets-trace section.
010596     if ws-mf-ti-trace-level >= 1
010598       move 71 to ws-mf-ti-msg-nbr
010600       move '7000-offsets-trace' to ws-mf-ti-data-rec(1:18)
010602       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
010604       move 18 to ws-mf-ti-user-data-len
010606       perform mf-ti-write
010608     end-if
010610     move 'OFFS'
010612       to strucid                      of ws-offsets-t
010614     move 1
010616       to version                      of ws-offsets-t
010618     move length                       of ws-offsets-t
010620       to struclen                     of ws-offsets-t
010622     move msg-hdr-offset-i             of ws-msg-offsets-l
010624       to msg-hdr-offset-i             of ws-offsets-t
010626     move msg-hdr-ext-offset-i         of ws-msg-offsets-l
010628       to msg-hdr-ext-offset-i         of ws-offsets-t
010630     move fmt-hdr-offset-i             of ws-msg-offsets-l
010632       to fmt-hdr-offset-i             of ws-offsets-t
010634     move ebiz-req-hdr-offset-i        of ws-msg-offsets-l
010636       to ebiz-req-hdr-offset-i        of ws-offsets-t
010638     move ebiz-req-data-offset-i       of ws-msg-offsets-l
010640       to ebiz-req-data-offset-i       of ws-offsets-t
010642     move msg-hdr-offset-o             of ws-msg-offsets-l
010644       to msg-hdr-offset-o             of ws-offsets-t
010646     move fmt-hdr-offset-o             of ws-msg-offsets-l
010648       to fmt-hdr-offset-o             of ws-offsets-t
010650     move ebiz-rep-hdr-offset-o        of ws-msg-offsets-l
010652       to ebiz-rep-hdr-offset-o        of ws-offsets-t
010654     move ebiz-rep-data-offset-o       of ws-msg-offsets-l
010656       to ebiz-rep-data-offset-o       of ws-offsets-t
010658     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
010660       to address                      of ws-offsets-t
010662     move seventy-five                 of ws-static-fields
010664       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
010666     move length                       of ws-offsets-t
010668       to ws-mf-ti-user-data-len       of ws-mf-ti-record
010670     perform mf-ti-write
010672     exit
010674     .
010676 
010678 7000-clif-trace section.
010680     if ws-mf-ti-trace-level >= 1
010682       move 71 to ws-mf-ti-msg-nbr
010684       move '7000-clif-trace' to ws-mf-ti-data-rec(1:15)
010686       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
010688       move 15 to ws-mf-ti-user-data-len
010690       perform mf-ti-write
010692     end-if
010694     move trace-level                  of ws-clif
010696       to trace-level                  of ws-clif-t
010698     move trace-queue-name             of ws-clif
010700       to trace-queue-name             of ws-clif-t
010702     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
010704       to address                      of ws-clif-t
010706     move seventy-five                 of ws-static-fields
010708       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
010710     move length                       of ws-clif-t
010712       to ws-mf-ti-user-data-len       of ws-mf-ti-record
010714     perform mf-ti-write
010716     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
010718       to address of cmqmdv-copybook
010720                  of ws-clif
010722     move seventy-five                 of ws-static-fields
010724       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
010726     move length                       of cmqmdv-copybook
010728                                       of ws-clif
010730       to ws-mf-ti-user-data-len       of ws-mf-ti-record
010732     perform mf-ti-write
010734
010736     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
010738       to address of cmqtml-copybook
010740                  of ws-clif
010742     move seventy-five                 of ws-static-fields
010744       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
010746     move length                       of cmqtml-copybook
010748                                       of ws-clif
010750       to ws-mf-ti-user-data-len       of ws-mf-ti-record
010752     perform mf-ti-write
010754     exit
010756     .
010758 ebiz-footprint-request-check section.
010760     move 0 to ws-footprint-rulefile-ctr
010762     move 84 to ws-footprint-pos
010764     move 'generated:   2022-04-20 23:04:04'
010766       to dfhcommarea (ws-footprint-pos:80)
010768     add 80 to ws-footprint-pos
010770     add 1 to ws-footprint-rulefile-ctr
010772     move 'mer0mmtm.igl 2019-02-13 18:51:21          950890'
010774        to ws-footprint-rulefile (ws-footprint-rulefile-ctr)
010776     move ws-footprint-rulefile (ws-footprint-rulefile-ctr)
010778         to dfhcommarea( ws-footprint-pos:80)
010780     add 80 to ws-footprint-pos
010782     add 1 to ws-footprint-rulefile-ctr
010784     move 'mersetup.igl 2015-12-08 13:52:44          727343'
010786        to ws-footprint-rulefile (ws-footprint-rulefile-ctr)
010788     move ws-footprint-rulefile (ws-footprint-rulefile-ctr)
010790         to dfhcommarea( ws-footprint-pos:80)
010792     add 80 to ws-footprint-pos
010794     add 1 to ws-footprint-rulefile-ctr
010796     move 'merfoot.igl  2019-02-08 13:14:37          949994'
010798        to ws-footprint-rulefile (ws-footprint-rulefile-ctr)
010800     move ws-footprint-rulefile (ws-footprint-rulefile-ctr)
010802         to dfhcommarea( ws-footprint-pos:80)
010804     add 80 to ws-footprint-pos
010806     add 1 to ws-footprint-rulefile-ctr
010808     move 'release.igl  2019-02-12 16:12:34          950598'
010810        to ws-footprint-rulefile (ws-footprint-rulefile-ctr)
010812     move ws-footprint-rulefile (ws-footprint-rulefile-ctr)
010814         to dfhcommarea( ws-footprint-pos:80)
010816     add 80 to ws-footprint-pos
010818     add 1 to ws-footprint-rulefile-ctr
010820     move 'merbrule.igl 2019-02-08 13:14:37          949994'
010822        to ws-footprint-rulefile (ws-footprint-rulefile-ctr)
010824     move ws-footprint-rulefile (ws-footprint-rulefile-ctr)
010826         to dfhcommarea( ws-footprint-pos:80)
010828     add 80 to ws-footprint-pos
010830     add 1 to ws-footprint-rulefile-ctr
010832     move 'merbipc.igl  2019-02-08 13:14:37          949994'
010834        to ws-footprint-rulefile (ws-footprint-rulefile-ctr)
010836     move ws-footprint-rulefile (ws-footprint-rulefile-ctr)
010838         to dfhcommarea( ws-footprint-pos:80)
010840     add 80 to ws-footprint-pos
010842     add 1 to ws-footprint-rulefile-ctr
010844     move 'merntrac.igl 2018-12-09 18:44:39          727692'
010846        to ws-footprint-rulefile (ws-footprint-rulefile-ctr)
010848     move ws-footprint-rulefile (ws-footprint-rulefile-ctr)
010850         to dfhcommarea( ws-footprint-pos:80)
010852     add 80 to ws-footprint-pos
010854     add 1 to ws-footprint-rulefile-ctr
010856     move 'mer0macs.igl 2019-02-08 13:14:37          949994'
010858        to ws-footprint-rulefile (ws-footprint-rulefile-ctr)
010860     move ws-footprint-rulefile (ws-footprint-rulefile-ctr)
010862         to dfhcommarea( ws-footprint-pos:80)
010864     add 80 to ws-footprint-pos
010866     add 1 to ws-footprint-rulefile-ctr
010868     move 'mer0exit.igl 2019-02-08 13:14:37          949994'
010870        to ws-footprint-rulefile (ws-footprint-rulefile-ctr)
010872     move ws-footprint-rulefile (ws-footprint-rulefile-ctr)
010874         to dfhcommarea( ws-footprint-pos:80)
010876     add 80 to ws-footprint-pos
010878     move 83 to ws-footprint-pos
010880     move ws-footprint(17:)
010882         to dfhcommarea(1:ws-footprint-pos)
010884     exec cics return
010886     end-exec
010888     exit
010890     .

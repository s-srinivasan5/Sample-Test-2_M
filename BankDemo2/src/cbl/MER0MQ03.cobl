000002* ***
000004* CR_TAG_BEGIN
000006* © Copyright 1981-2019 Micro Focus or one of its affiliates.
000008* The only warranties for products and services of Micro Focus
000010* and its affiliates and licensors (“Micro Focus”) are set 
000012* forth
000014* in the express warranty statements accompanying such products
000016* and services. Nothing herein should be construed as
000018* constituting an additional warranty. Micro Focus s hall not be
000020* liable for technical or editorial errors or omissions
000022* contained herein. The information contained herein is subject
000024* to change without notice.
000026*
000028* Contains Confidential Information. Except as specifically
000030* indicated otherwise, a valid license is required for
000032* possession, use or copying. Consistent with FAR 12.211 and
000034* 12.212, Commercial Computer Software, Computer Software
000036* Documentation, and Technical Data for Commercial Items are
000038* licensed to the U.S. Government under vendor's standard
000040* commercial license.
000042* CR_TAG_END
000044* ***
000046*
000048* ***
000050* CR_TAG_BEGIN
000052* © Copyright 1981-2019 Micro Focus or one of its affiliates.
000054* The only warranties for products and services of Micro Focus
000056* and its affiliates and licensors (“Micro Focus”) are set 
000058* forth
000060* in the express warranty statements accompanying such products
000062* and services. Nothing herein should be construed as
000064* constituting an additional warranty. Micro Focus shall not be
000066* liable for technical or editorial errors or omissions
000068* contained herein. The information contained herein is subject
000070* to change without notice.
000072*
000074* Contains Confidential Information. Except as specifically
000076* indicated otherwise, a valid license is required for
000078* possession, use or copying. Consistent with FAR 12.211 and
000080* 12.212, Commercial Computer Software, Computer Software
000082* Documentation, and Technical Data for Commercial Items are
000084* licensed to the U.S. Government under vendor's standard
000086* commercial license.
000088* CR_TAG_END
000090* ***
000092***--------------------------------------------------------------*
000094*** Revision History                                             *
000096***--------------------------------------------------------------*
000098 IDENTIFICATION DIVISION.
000100 program-id.                           MER0MQ03.
000102 ENVIRONMENT DIVISION.
000104 DATA DIVISION.
000106 WORKING-STORAGE SECTION.
000108 01  ws-mq03-trace-misc.
000110     05 mq03-trace-level               pic 9(01) value zero.
000112     05 mq03-trace-queue-name          pic x(08) value spaces.
000114
000116
000118 01  ws-footprint                pic x(100)
000120      value '$mf_footprint$: MER0MQ03 ED-STRB        2.003.0024   
000122-         '     2019-02-08 13:14:37 949994    '.
000124
000126*
000128*** Compilation:                                                 *
000130***                                                              *
000132***  Compiled on:      20 APR 22 23.54.10                        *
000134***  Micro Focus Generator: GA 4 0                               *
000136***                                                              *
000138*** ebiz source modules                                          *
000140***                                                              *
000142*** Rulefile(s):                                                 *
000144***  mer0mq03.igl         2019-02-08 13:14:37   949994           *
000146***  mersetup.igl         2015-12-08 13:52:44   727343           *
000148***  merfoot.igl          2019-02-08 13:14:37   949994           *
000150***  release.igl          2019-02-12 16:12:34   950598           *
000152***  merntrac.igl         2018-12-09 18:44:39   727692           *
000154***  mer0macs.igl         2019-02-08 13:14:37   949994           *
000156***                                                              *
000158*** Cntlfile(s):                                                 *
000160***                                                              *
000162*** Project Symbol File(s):                                      *
000164***                                                              *
000166*** Program Symbol File(s):                                      *
000168***                                                              *
000170*** Map Symbol File(s):                                          *
000172***                                                              *
000174*
000176
000178 01  ebiz-mfg-release                  pic x(30)
000180     value 'Micro Focus Generator: GA 4 0'.
000182
000184 01  ebiz-source-modules.
000186     02  filler                        pic x(12)
000188     value 'Rulefile(s):'.
000190     02  filler                        pic x(41)
000192     value '  mer0mq03.igl 2019-02-08 13:14:37 949994'.
000194     02  filler                        pic x(41)
000196     value '  mersetup.igl 2015-12-08 13:52:44 727343'.
000198     02  filler                        pic x(41)
000200     value '  merfoot.igl  2019-02-08 13:14:37 949994'.
000202     02  filler                        pic x(41)
000204     value '  release.igl  2019-02-12 16:12:34 950598'.
000206     02  filler                        pic x(41)
000208     value '  merntrac.igl 2018-12-09 18:44:39 727692'.
000210     02  filler                        pic x(41)
000212     value '  mer0macs.igl 2019-02-08 13:14:37 949994'.
000214     02  filler                        pic x(12)
000216     value 'Cntlfile(s):'.
000218 01  ws-static-fields.
000220     05 ws-nwif-strucid                pic x(04)
000222        value 'NWIF'.
000224     05 ws-trif-strucid                pic x(04)
000226        value 'TRIF'.
000228     05 ws-this-version                pic 9(04)
000230        value 1.
000232     05 ws-this-release                pic 9(04)
000234        value 1.
000236     05 ws-this-program                pic x(08)
000238        value 'MER0MQ03'.
000240     05 ws-trac-program                pic x(08)
000242        value 'MER0TRAC'.
000244     05 ws-default-traceq              pic x(08)
000246        value 'CEBRMQ03'.
000248     05 ws-unknown-ebiz                pic x(08)
000250        value 'unknown'.
000252     05 commax                         pic x(01)
000254        value ','.
000256     05 seventy-five                   pic 9(02)
000258        value 75.
000260     05 ws-wait-interval               pic s9(08) comp
000262        value 30000.
000264     05 ws-getmain-trys-max            pic s9(04) comp
000266        value 3.
000268     05 invalid-dfhcommarea-msg        pic x(38)
000270        value 'Invalid dfhcommarea passed to program '.
000272     05 persistent-msg                 pic x(29)
000274        value 'This will be a persistent msg'.
000276     05 non-persistent-msg             pic x(33)
000278        value 'This will be a non-persistent msg'.
000280     05 waitinterval-msg               pic x(26)
000282        value 'waitinterval for MQGET is '.
000284 01  ws-mq03-abends.
000286     05 bad-dfhcommarea-length         pic x(04)
000288        value '9401'.
000290     05 bad-nwih-header                pic x(04)
000292        value '9402'.
000294     05 getmain-to-lengerr             pic x(04)
000296        value '9410'.
000298     05 getmain-to-nostg               pic x(04)
000300        value '9411'.
000302     05 link-failure                   pic x(04)
000304        value '9412'.
000306     05 mqclose-failure                pic x(04)
000308        value '9420'.
000310     05 mqget-failure                  pic x(04)
000312        value '9421'.
000314     05 mqopen-failure                 pic x(04)
000316        value '9422'.
000318     05 mqput1-failure                 pic x(04)
000320        value '9423'.
000322
000324 01  ws-msg-offsets-l.
000326     05 msg-hdr-offset-i               pic s9(08) comp
000328        value 1.
000330     05 msg-hdr-ext-offset-i           pic s9(08) comp
000332        value 213.
000334     05 fmt-hdr-offset-i               pic s9(08) comp
000336        value 513.
000338     05 ebiz-req-hdr-offset-i          pic s9(08) comp
000340        value 550.
000342     05 ebiz-req-data-offset-i         pic s9(08) comp
000344        value 576.
000346     05 msg-hdr-offset-o               pic s9(08) comp
000348        value 1.
000350     05 fmt-hdr-offset-o               pic s9(08) comp
000352        value 213.
000354     05 ebiz-rep-hdr-offset-o          pic s9(08) comp
000356        value 250.
000358     05 ebiz-rep-data-offset-o         pic s9(08) comp
000360        value 378.
000362 01  ws-misc-fields.
000364     05 pntr-p                         usage pointer.
000366     05 pntr-x                         redefines
000368        pntr-p                         pic x(04).
000370     05 pntr-9                         redefines
000372        pntr-p                         pic s9(08) comp.
000374     05 basepntr-p                     usage pointer.
000376     05 basepntr-x                     redefines
000378        basepntr-p                     pic x(04).
000380     05 basepntr-9                     redefines
000382        basepntr-p                     pic s9(08) comp.
000384     05 ws-offset-fields.
000386        10 offset-1                    pic s9(08) comp.
000388        10 offset-2                    pic s9(08) comp.
000390        10 offset-3                    pic s9(08) comp.
000392        10 offset-4                    pic s9(08) comp.
000394     05 ws-offset-lengths.
000396        10 offset-len-1                pic s9(08) comp.
000398        10 offset-len-2                pic s9(08) comp.
000400        10 offset-len-3                pic s9(08) comp.
000402        10 offset-len-4                pic s9(08) comp.
000404     05 length-hold.
000406        10 ws-put-msg-string           pic x(05).
000408        10 ws-put-msg-numeric          redefines
000410           ws-put-msg-string           pic 9(05).
000412     05 ws-ebiz-abend-flg              pic x(01)
000414        value 'f'.
000416        88  ws-ebiz-abend                    value 't'.
000418     05 ws-trace-ws.
000420        10 ws-work-offset              pic s9(08) comp.
000422
000424
000426 01  ws-mf-ti-misc.
000428     05 ws-mf-ti-trace-cat             pic x(04).
000430     05 ws-mf-ti-para-tag              pic x(06) value 'para--'.
000432     05 ws-mf-ti-info-tag              pic x(06) value 'info--'.
000434     05 ws-mf-ti-step-tag              pic x(06) value 'step--'.
000436     05 ws-mf-ti-data-tag              pic x(06) value 'data--'.
000438     05 ws-mf-ti-getmain-flag          pic x(01).
000440        88 ws-mf-ti-getmain-done-88      value 't'.
000442        88 ws-mf-ti-getmain-not-done-88  value 'f'.
000444     05 ws-mf-ti-fld-zero              pic 9(01) value 0.
000446     05 ws-mf-ti-ascii-numeric         pic x(10)
000448        value x'30313233343536373839'.
000450     05 ws-mf-ti-ebcdic-numeric        pic x(10)
000452        value x'f0f1f2f3f4f5f6f7f8f9'.
000454     05 ws-mf-ti-eibresp-save          pic s9(08) comp.
000456     05 ws-mf-ti-eibresp2-save         pic s9(08) comp.
000458     05 ws-mf-ti-eibresp-disp          pic +9(08).
000460     05 ws-mf-ti-eibresp2-disp         pic +9(08).
000462     05 ws-mf-ti-length-1-disp         pic +9(08).
000464     05 ws-mf-ti-length-2-disp         pic +9(08).
000466     05 ws-mf-ti-length-3-disp         pic +9(08).
000468     05 ws-mf-ti-length-4-disp         pic +9(08).
000470     05 ws-mf-ti-n2-1-disp             pic 9(02).
000472     05 ws-mf-ti-n5-1-disp             pic +9(05).
000474     05 ws-mf-ti-n5-2-disp             pic +9(05).
000476     05 ws-mf-ti-n5-3-disp             pic +9(05).
000478     05 ws-mf-ti-n5-4-disp             pic +9(05).
000480     05 ws-ti-de-edit-status           pic x(26).
000482     05 ws-ti-scr-sub                  pic 9(04).
000484     05 ws-mf-ti-string-len            pic s9(04) comp.
000486     05 ws-mf-ti-comp4-disp            pic +9(05).
000488     05 ws-mf-ti-comp8-disp            pic +9(09).
000490     05 ws-mf-ti-pointer-temp          pointer.
000492     05 ws-mf-ti-pointer-disp redefines ws-mf-ti-pointer-temp
000494                                       pic 9(04).
000496     05 ws-mf-ti-setup-status          pic x(01) value 'F'.
000498       88 ws-mf-ti-setup-done-88         value 'T'.
000500     05 ws-mf-ti-ebcdic-values.
000502        10 ws-mf-ti-ebcdic-0           pic x(01) value x'f0'.
000504        10 ws-mf-ti-ebcdic-5           pic x(01) value x'f5'.
000506        10 ws-mf-ti-ebcdic-9           pic x(01) value x'f9'.
000508        10 ws-mf-ti-ebcdic-uc-n        pic x(01) value x'd5'.
000510        10 ws-mf-ti-ebcdic-uc-y        pic x(01) value x'e8'.
000512        10 ws-mf-ti-ebcdic-lc-n        pic x(01) value x'95'.
000514        10 ws-mf-ti-ebcdic-lc-y        pic x(01) value x'a8'.
000516     05 ws-mf-ti-ascii-values.
000518        10 ws-mf-ti-ascii-0            pic x(01) value x'30'.
000520        10 ws-mf-ti-ascii-5            pic x(01) value x'35'.
000522        10 ws-mf-ti-ascii-9            pic x(01) value x'39'.
000524        10 ws-mf-ti-ascii-uc-n         pic x(01) value x'4e'.
000526        10 ws-mf-ti-ascii-uc-y         pic x(01) value x'59'.
000528        10 ws-mf-ti-ascii-lc-n         pic x(01) value x'6e'.
000530        10 ws-mf-ti-ascii-lc-y         pic x(01) value x'79'.
000532     05 ws-mf-ti-info-lit              pic x(04) value 'info'.
000534     05 ws-mf-ti-erro-lit              pic x(04) value 'erro'.
000536 01  ws-mf-ti-verbose-mode             pic x(15).
000538 01  ws-mf-ti-hash-accum               pic z(9)9-.
000540 01  ws-mf-ti-hash-number              pic z(9)9-.
000542 01  ws-mf-ti-hash-sub                 pic zzz9.
000544
000546 01  ws-mf-ti-element-position         pic zzz9.
000548 01  ws-mf-ti-field-position           pic zzz9.
000550 01  ws-mf-ti-element-length           pic zzz9.
000552 01  ws-mf-ti-lengthx                  pic s9(04) comp.
000554 01  ws-mf-ti-handle1-disp             pic +9(08).
000556 01  ws-mf-ti-handle2-disp             pic +9(08).
000558 01  ws-mf-ti-num1-disp                pic +9(04).
000560 01  ws-mf-ti-num2-disp                pic +9(04).
000562 01  ws-mf-ti-num3-disp                pic +9(04).
000564 01  ws-mf-ti-num4-disp                pic +9(04).
000566 01  ws-mf-ti-verify-daysleft-x        pic +9(04).
000568
000570 01  ws-mf-ti-short-record.
000572     05  ws-mf-ti-short-trace-level    pic 9(01).
000574     05  ws-mf-ti-short-queue-name     pic X(16).
000576 01  ws-mf-ti-msg-nbr-tmp              pic 9(04) value zero.
000578 01  ws-mf-ti-record.
000580     05 ws-mf-ti-version.
000582        10 ws-mf-ti-major-version      pic 9(02) value zero.
000584        10 ws-mf-ti-minor-version      pic 9(02) value zero.
000586        10 ws-mf-ti-trace-level-x      pic x(01) value zero.
000588        10 ws-mf-ti-trace-level        redefines
000590           ws-mf-ti-trace-level-x      pic 9(01).
000592*    Allow future support of QNAME option where a
000594*    16 byte queue name can be specified
000596     05 ws-mf-ti-queue-name-long.
000598        10 ws-mf-ti-queue-name-short.
000600          15 ws-mf-ti-queue-name-1-4   pic x(04) value spaces.
000602          15 ws-mf-ti-queue-name-5-8   pic x(04) value spaces.
000604        10 ws-mf-ti-queue-name-9-16    pic x(08) value spaces.
000606     05 ws-mf-ti-ebiz-program          pic x(08) value spaces.
000608     05 ws-mf-ti-calling-program       pic x(08) value spaces.
000610     05 ws-mf-ti-trace-program         pic x(08) value spaces.
000612     05 ws-mf-ti-assign-values.
000614        10 ws-mf-ti-sysid              pic x(04) value spaces.
000616        10 ws-mf-ti-userid             pic x(08) value spaces.
000618     05 ws-mf-ti-eib-values.
000620        10 ws-mf-ti-eibtaskn           pic 9(09) value zero.
000622     05 ws-mf-ti-program-status        pic x(01) value spaces.
000624        88 ws-mf-ti-program-normal-88    value 'n'.
000626        88 ws-mf-ti-program-error-88     value 'e'.
000628        88 ws-mf-ti-program-abend-88     value 'a'.
000630     05 ws-mf-ti-msg-nbr               pic 9(04) value zero.
000632     05 ws-mf-ti-user-data-len         pic 9(08) value zero.
000634     05 ws-mf-ti-user-data-pntr        pointer.
000636     05 ws-mf-ti-return-values.
000638        10 ws-mf-ti-return-code        pic 9(04) value zero.
000640        10 ws-mf-ti-reason-code        pic 9(04) value zero.
000642     05 ws-mf-ti-abend-code            pic x(04) value spaces.
000644     05 ws-mf-reserved                 pic x(128) value spaces.
000646     05 ws-customer-reserved           pic x(128) value spaces.
000648 01  ws-mf-ti-data-rec                 pic x(1000).
000650 01  ws-mf-ti-data-rec-r               redefines
000652     ws-mf-ti-data-rec.
000654     05 ws-mf-ti-data-rec-header-r     pic x(24).
000656     05 ws-mf-ti-data-rec-data-r       pic x(976).
000658
000660 01  ws-cmqgmov-copybook.
000662     copy cmqgmov.
000664
000666 01  ws-cmqmdv-copybook.
000668     copy cmqmdv.
000670
000672 01  ws-cmqodv-copybook.
000674     copy cmqodv.
000676
000678 01  ws-cmqpmol-copybook.
000680     copy cmqpmol.
000682
000684 01  ws-cmqpmov-copybook.
000686     copy cmqpmov.
000688
000690 01  ws-cmqv-copybook.
000692     copy cmqv suppress.
000694
000696 01  ws-trif.
000698     05 trif.
000700*       316 bytes in this group
000702        10 amb-tp-header.
000704*           40 bytes in this group
000706           15 amb-tp-invocation-mode   pic x(01).
000708              88 amb-tp-transid-invoked      value 'T'.
000710              88 amb-tp-program-invoked      value 'P'.
000712              88 amb-tp-screen-invoked       value 'S'.
000714              88 amb-tp-link-invoked         value 'L'.
000716              88 amb-tp-largedata-invoked    value 'D'.
000718           15 amb-tp-psb-scheduled-mode
000720                                       pic x(01).
000722           15 amb-tp-addr-count        pic s9(04) comp.
000724           15 amb-tp-calling-program-id
000726                                       pic x(08).
000728           15 amb-tp-filler-28         pic x(28).
000730*       Start of fields associated with tp-user-len
000732*       Next field should start on a fullword boundary
000734        10 trif-fields.
000736*          64 bytes in this group
000738           15 this-pntr                usage pointer.
000740           15 strucid                  pic x(04).
000742           15 version                  pic s9(09) comp.
000744           15 struclen                 pic s9(09) comp.
000746           15 ebiz-name                pic x(08).
000748           15 upgm-name                pic x(08).
000750           15 useridx                  pic x(08).
000752           15 trace-level              pic 9(01).
000754           15 trace-level-unused       pic x(03).
000756           15 trace-queue-name         pic x(16).
000758           15 copybook-mode            pic x(04).
000760              88 copybook-mode-is-unk-88     value 'unk '.
000762              88 copybook-mode-is-sam-88     value 'sam '.
000764              88 copybook-mode-is-sep-88     value 'sep '.
000766              88 copybook-mode-is-amb-88     value 'amb '.
000768        10 to-upgm-fields.
000770*           12 bytes in this group
000772*           Next field should start on a fullword boundary
000774           15 to-upgm-bfr-pntr         usage pointer.
000776           15 to-upgm-bfr-full-lenf    pic s9(08) comp.
000778*    *************************************************************
000780*    if the input record in the ebiz program contains
000782*    occurs depending on clauses the to-upgm-bfr-used-lenf
000784*    will be <= to-upgm-bfr-full-lenf based on the current
000786*    size of this record in the ebiz program
000788*    *************************************************************
000790           15 to-upgm-bfr-used-lenf    pic s9(08) comp.
000792              10 from-upgm-fields.
000794*           12 bytes in this group
000796*           Next field should start on a fullword boundary
000798           15 from-upgm-bfr-pntr       usage pointer.
000800           15 from-upgm-bfr-full-lenf  pic s9(08) comp.
000802*    *************************************************************
000804*    if the output record in the user program contains
000806*    occurs depending on clauses the from-upgm-bfr-used-lenf
000808*    will be <= from-upgm-bfr-full-lenf based on the current
000810*    size of this record in the ebiz program
000812*    *************************************************************
000814           15 from-upgm-bfr-used-lenf  pic s9(08) comp.
000816        10 from-upgm-fields-aux.
000818*          108 bytes in this group
000820           15 from-upgm-processing-mode
000822                                       pic x(04).
000824              88 from-upgm-mode-is-normal-88 value spaces.
000826              88 from-upgm-mode-is-error-88  value 'erro'.
000828           15 from-upgm-abend-code     pic x(04).
000830           15 from-upgm-abend-program  pic x(08).
000832           15 from-upgm-return-code    pic 9(04).
000834           15 from-upgm-reason         pic x(04).
000836           15 from-upgm-msg            pic x(80).
000838           15 filler                   pic x(04).
000840* End of fields associated with tp-user-len
000842        10 amb-tp-trailer.
000844*          80 bytes in this group
000846           15 amb-tp-addr-table.
000848              20 amb-tp-addr           usage is pointer
000850                                       occurs 20 times.
000852
000854 01  ws-footprint-header-len           pic 9(04) comp value 17.
000856 01  ws-asktime-misc.
000858     05 asktime-resp                   pic s9(08) comp.
000860     05 asktime-resp2                  pic s9(08) comp.
000862     05 asktime-abstime                pic s9(15) comp-3.
000864
000866 01  ws-freemain-misc.
000868     05 freemain-status                pic x(06).
000870       88 freemain-after-88                  value 'after '.
000872       88 freemain-before-88                 value 'before'.
000874           88 freemain-error-88              value 'error '.
000876     05 freemain-cntr                  pic s9(04) comp
000878        value 0.
000880     05 freemain-total-bytes           pic s9(15) comp
000882        value 0.
000884     05 freemain-resp                  pic s9(08) comp.
000886     05 freemain-resp2                 pic s9(08) comp.
000888     05 freemain-data                  pic x(30).
000890     05 freemain-resp-disp             pic +9(04).
000892     05 freemain-resp2-disp            pic +9(04).
000894
000896 01  ws-formattime-misc.
000898     05 formattime-resp                pic s9(08) comp.
000900     05 formattime-resp2               pic s9(08) comp.
000902     05 formattime-yyyymmdd            pic x(10).
000904     05 formattime-hhmmss              pic x(08).
000906     05 formattime-yyddd               pic x(06).
000908
000910 01  ws-getmain-misc.
000912     05 getmain-status                 pic x(06).
000914       88 getmain-after-88                   value 'after '.
000916       88 getmain-before-88                  value 'before'.
000918       88 getmain-error-88                   value 'error '.
000920     05 getmain-pntr                   usage pointer.
000922     05 getmain-set                    pic x(30).
000924     05 getmain-cntr                   pic s9(04) comp
000926        value 0.
000928     05 getmain-resp                   pic s9(08) comp.
000930     05 getmain-resp2                  pic s9(08) comp.
000932     05 getmain-trys-cntr              pic s9(04) comp.
000934     05 getmain-flength                pic s9(08) comp.
000936     05 getmain-ind                    pic 9(01)
000938        value 0.
000940        88 keep-trying-getmain-88            value 0.
000942        88 stop-trying-getmain-88            value 1.
000944     05 getmain-resp-disp              pic +9(04).
000946     05 getmain-resp2-disp             pic +9(04).
000948     05 getmain-flength-disp           pic +9(08).
000950
000952 01  ws-link-misc.
000954     05 link-status                    pic x(06).
000956       88 link-after-88                      value 'after '.
000958       88 link-before-88                     value 'before'.
000960       88 link-error-88                      value 'error '.
000962     05 link-resp                      pic s9(08) comp.
000964     05 link-resp2                     pic s9(08) comp.
000966     05 link-commarea                  pic x(30).
000968     05 link-length                    pic s9(04) comp.
000970     05 link-program                   pic x(08).
000972     05 link-resp-disp                 pic +9(04).
000974     05 link-resp2-disp                pic +9(04).
000976     05 link-length-disp               pic +9(04).
000978
000980 01  ws-return-misc.
000982     05 return-resp                    pic s9(08) comp.
000984     05 return-resp2                   pic s9(08) comp.
000986
000988 01  ws-mqclose-misc.
000990     05 mqclose-hconn                  pic s9(09) binary.
000992     05 mqclose-q-handle               pic s9(09) binary.
000994     05 mqclose-options                pic s9(09) binary.
000996     05 mqclose-comp-code              pic s9(09) binary.
000998     05 mqclose-reason                 pic s9(09) binary.
001000     05 mqclose-comp-code-disp         pic +9(02).
001002     05 mqclose-reason-disp            pic +9(04).
001004
001006 01  ws-mqget-misc.
001008     05 mqget-wait-interval            pic s9(09) binary
001010        value 30000.
001012     05 mqget-hconn                    pic s9(09) binary.
001014     05 mqget-q-handle                 pic s9(09) binary.
001016*             mqget-msg-desc
001018     05 mqget-options                  pic s9(09) binary.
001020     05 mqget-buffer-lenf              pic s9(09) binary.
001022*             lk-mq-msg
001024     05 mqget-data-lenf                pic s9(09) binary.
001026     05 mqget-comp-code                pic s9(09) binary.
001028     05 mqget-reason                   pic s9(09) binary.
001030     05 mqget-browse-first             pic s9(09) binary.
001032     05 mqget-browse-next              pic s9(09) binary.
001034     05 mqget-comp-code-disp           pic +9(02).
001036     05 mqget-reason-disp              pic +9(04).
001038     05 mqget-ind                      pic 9(01) value zero.
001040        88 mqget-continue-88                 value zero.
001042        88 mqget-stop-88                     value 1.
001044
001046 01  ws-mqopen-misc.
001048     05 mqopen-hconn                   pic s9(09) binary.
001050*             mqopen-object-descriptor
001052     05 mqopen-options                 pic s9(09) binary.
001054     05 mqopen-q-handle                pic s9(09) binary.
001056     05 mqopen-comp-code               pic s9(09) binary.
001058     05 mqopen-reason                  pic s9(09) binary.
001060     05 mqopen-comp-code-disp          pic +9(02).
001062     05 mqopen-reason-disp             pic +9(04).
001064
001066 01  ws-mqput1-misc.
001068     05 mqput1-hconn                   pic s9(09) binary.
001070     05 mqput1-hobj                    pic s9(09) binary.
001072*             mqput1-object-descriptor
001074     05 mqput1-buffer-lenf             pic s9(09) binary.
001076*             lk-mq-msg
001078     05 mqput1-comp-code               pic s9(09) binary.
001080     05 mqput1-reason                  pic s9(09) binary.
001082     05 mqput1-comp-code-disp          pic +9(02).
001084     05 mqput1-reason-disp             pic +9(04).
001086
001088 01  ws-info-misc.
001090     05 info-len-1                     pic +999,999,999.
001092     05 info-len-2                     pic +999,999,999.
001094     05 info-len-3                     pic +999,999,999.
001096     05 info-len-4                     pic +999,999,999.
001098
001100 01  ws-to-from-upgm-misc.
001102     05 to-from-upgm-bfr-offset        pic s9(08) comp.
001104     05 to-from-upgm-bfr-full-lenf     pic s9(08) comp.
001106     05 to-from-upgm-bfr-used-lenf     pic s9(08) comp.
001108     05 to-upgm-bfr-offset             pic s9(08) comp.
001110     05 to-upgm-bfr-full-lenf          pic s9(08) comp.
001112     05 to-upgm-bfr-used-lenf          pic s9(08) comp.
001114     05 from-upgm-bfr-offset           pic s9(08) comp.
001116     05 from-upgm-bfr-full-lenf        pic s9(08) comp.
001118     05 from-upgm-bfr-used-lenf        pic s9(08) comp.
001120
001122 01  ws-program-recs-t.
001124     05 ws-footprint-t.
001126        10 footprint-t.
001128           15 filler                   pic x(11)
001130              value 'Footprint '.
001132           15 footprint-data           pic x(96).
001134     05 ws-section-t.
001136        10 ws-trace-section-rec.
001138           15 filler                   pic x(05)
001140              value 'Sect '.
001142           15 ws-trace-section-name    pic x(30).
001144     05 ws-info-t.
001146        10 filler                      pic x(05)
001148           value 'Info '.
001150        10 textx                       pic x(200).
001152     05 ws-error-t.
001154        10 filler                      pic x(16)
001156           value '**** ERROR ****'.
001158        10 filler                      pic x(16)
001160           value '**** ERROR ****'.
001162 01  ws-intf-recs-t.
001164     05 filler                         pic x(01) value spaces.
001166     05 ws-nwif-t.
001168        10 nwif-t.
001170           15 filler                   pic x(16)
001172              value 'Stru NWIF'.
001174           15 filler                   pic x(16)
001176              value 'this-pntr'.
001178           15 this-pntr                usage pointer.
001180           15 filler                   pic x(12) value spaces.
001182           15 filler                   pic x(16)
001184              value 'version'.
001186           15 version                  pic +999,999,999.
001188           15 filler                   pic x(04) value spaces.
001190           15 filler                   pic x(16)
001192              value 'struclen'.
001194           15 struclen                 pic +999,999,999.
001196           15 filler                   pic x(04) value spaces.
001198           15 filler                   pic x(16)
001200              value 'req-pntr'.
001202           15 req-msg-pntr             usage pointer.
001204           15 filler                   pic x(12) value spaces.
001206           15 filler                   pic x(16)
001208              value 'rep-pntr'.
001210           15 rep-msg-pntr             usage pointer.
001212           15 filler                   pic x(12) value spaces.
001214           15 filler                   pic x(16)
001216              value 'mq03-alt-name'.
001218           15 mq03-alt-name            pic x(08).
001220           15 filler                   pic x(08) value spaces.
001222           15 filler                   pic x(16)
001224              value 'trace-level'.
001226           15 trace-level              pic +9(01).
001228           15 filler                   pic x(14) value spaces.
001230           15 filler                   pic x(16)
001232              value 'trace-leve-un'.
001234           15 trace-level-unused       pic x(03).
001236           15 filler                   pic x(13) value spaces.
001238           15 filler                   pic x(16)
001240              value 'trace-queue'.
001242           15 trace-queue-name         pic x(16).
001244           15 filler                   pic x(16)
001246              value 'userid'.
001248           15 useridx                  pic x(08).
001250           15 filler                   pic x(08) value spaces.
001252           15 filler                   pic x(16)
001254              value 'ebiz-name'.
001256           15 ebiz-name                pic x(08).
001258           15 filler                   pic x(08) value spaces.
001260           15 filler                   pic x(16)
001262              value 'upgm-name'.
001264           15 upgm-name                pic x(08).
001266           15 filler                   pic x(08) value spaces.
001268           15 filler                   pic x(16)
001270              value 'copybook-mode'.
001272           15 copybook-mode            pic x(04).
001274           15 filler                   pic x(12) value spaces.
001276           15 filler                   pic x(16)
001278              value 'processing-mode'.
001280           15 processing-mode          pic x(04).
001282           15 filler                   pic x(12) value spaces.
001284           15 filler                   pic x(16)
001286              value 'security-status'.
001288           15 security-status          pic x(04).
001290           15 filler                   pic x(12) value spaces.
001292           15 filler                   pic x(16)
001294              value 'mf-mode'.
001296           15 mf-processing-mode       pic x(04).
001298           15 filler                   pic x(12) value spaces.
001300           15 filler                   pic x(16)
001302              value 'mf-abend-program'.
001304           15 mf-abend-program         pic x(08).
001306           15 filler                   pic x(08) value spaces.
001308           15 filler                   pic x(16)
001310              value 'mf-abend-code'.
001312           15 mf-abend-code            pic x(04).
001314           15 filler                   pic x(12) value spaces.
001316           15 filler                   pic x(16)
001318              value 'mf-return-code'.
001320           15 mf-return-code           pic +9(04).
001322           15 filler                   pic x(11) value spaces.
001324           15 filler                   pic x(16)
001326              value 'mf-reason'.
001328           15 mf-reason                pic x(04).
001330           15 filler                   pic x(12) value spaces.
001332           15 filler                   pic x(16)
001334              value 'mf-msg'.
001336           15 mf-msg                   pic x(256).
001338           15 filler                   pic x(16) value spaces.
001340           15 filler                   pic x(16)
001342              value 'mqtm-userdata'.
001344           15 mqtm-userdata            pic x(128).
001346           15 filler                   pic x(16) value spaces.
001348           15 filler                   pic x(16)
001350              value 'req-msg-hdr-len'.
001352           15 req-msg-hdr-lenf         pic +999,999,999.
001354           15 filler                   pic x(04) value spaces.
001356           15 filler                   pic x(16)
001358              value 'req-msg-hdre-len'.
001360           15 req-msg-hdr-ext-lenf     pic +999,999,999.
001362           15 filler                   pic x(04) value spaces.
001364           15 filler                   pic x(16)
001366              value 'req-fmt-hdr-len'.
001368           15 req-fmt-hdr-lenf         pic +999,999,999.
001370           15 filler                   pic x(04) value spaces.
001372           15 filler                   pic x(16)
001374              value 'req-req-hdr-len'.
001376           15 req-ebiz-hdr-lenf        pic +999,999,999.
001378           15 filler                   pic x(04) value spaces.
001380           15 filler                   pic x(16)
001382              value 'req-data-flen'.
001384           15 req-ebiz-data-full-lenf  pic +999,999,999.
001386           15 filler                   pic x(04) value spaces.
001388           15 filler                   pic x(16)
001390              value 'req-data-ulen'.
001392           15 req-ebiz-data-used-lenf  pic +999,999,999.
001394           15 filler                   pic x(04) value spaces.
001396           15 filler                   pic x(16)
001398              value 'req-msg-t-flen'.
001400           15 req-msg-total-full-lenf  pic +999,999,999.
001402           15 filler                   pic x(04) value spaces.
001404           15 filler                   pic x(16)
001406              value 'req-msg-t-alen'.
001408           15 req-msg-total-used-lenf  pic +999,999,999.
001410           15 filler                   pic x(04) value spaces.
001412           15 filler                   pic x(16)
001414              value 'req-qmgr'.
001416           15 req-qmgr-name            pic x(48).
001418           15 filler                   pic x(16) value spaces.
001420           15 filler                   pic x(16)
001422              value 'req-qname'.
001424           15 req-qname                pic x(48).
001426           15 filler                   pic x(16) value spaces.
001428           15 filler                   pic x(16)
001430              value 'req-q-nbr'.
001432           15 req-queue-nbr            pic x(48).
001434           15 filler                   pic x(16) value spaces.
001436           15 filler                   pic x(16)
001438              value 'req-expiry'.
001440           15 req-expiry               pic x(48).
001442           15 filler                   pic x(16) value spaces.
001444           15 filler                   pic x(16)
001446              value 'req-wait'.
001448           15 req-wait-interval        pic x(48).
001450           15 filler                   pic x(16) value spaces.
001452           15 filler                   pic x(16)
001454              value 'req-persist'.
001456           15 req-persistent           pic x(48).
001458           15 filler                   pic x(16) value spaces.
001460           15 filler                   pic x(16)
001462              value 'req-msgid'.
001464           15 req-msgid                pic x(24).
001466           15 filler                   pic x(08) value spaces.
001468           15 filler                   pic x(16)
001470              value 'req-correlid'.
001472           15 req-correlid             pic x(24).
001474           15 filler                   pic x(08) value spaces.
001476           15 filler                   pic x(16)
001478              value 'rep-msg-hdr-len'.
001480           15 rep-msg-hdr-lenf         pic +999,999,999.
001482           15 filler                   pic x(04) value spaces.
001484           15 filler                   pic x(16)
001486              value 'rep-fmt-hdr-len'.
001488           15 rep-fmt-hdr-lenf         pic +999,999,999.
001490           15 filler                   pic x(04) value spaces.
001492           15 filler                   pic x(16)
001494              value 'rep-ebiz-hdr-len'.
001496           15 rep-ebiz-hdr-lenf        pic +999,999,999.
001498           15 filler                   pic x(04) value spaces.
001500           15 filler                   pic x(16)
001502              value 'rep-ebiz-d-flen'.
001504           15 rep-ebiz-data-full-lenf  pic +999,999,999.
001506           15 filler                   pic x(04) value spaces.
001508           15 filler                   pic x(16)
001510              value 'rep-ebiz-d-ulen'.
001512           15 rep-ebiz-data-used-lenf  pic +999,999,999.
001514           15 filler                   pic x(04) value spaces.
001516           15 filler                   pic x(16)
001518              value 'rep-msg-to-flen'.
001520           15 rep-msg-total-full-lenf  pic +999,999,999.
001522           15 filler                   pic x(04) value spaces.
001524           15 filler                   pic x(16)
001526              value 'rep-msg-to-ulen'.
001528           15 rep-msg-total-used-lenf  pic +999,999,999.
001530           15 filler                   pic x(04) value spaces.
001532           15 filler                   pic x(16)
001534              value 'rep-qmgr'.
001536           15 rep-qmgr-name            pic x(48).
001538           15 filler                   pic x(16) value spaces.
001540           15 filler                   pic x(16)
001542              value 'rep-qname'.
001544           15 rep-qname                pic x(48).
001546           15 filler                   pic x(16) value spaces.
001548           15 filler                   pic x(16)
001550              value 'rep-q-nbr'.
001552           15 rep-queue-nbr            pic x(48).
001554           15 filler                   pic x(16) value spaces.
001556           15 filler                   pic x(16)
001558              value 'rep-expiry'.
001560           15 rep-expiry               pic x(48).
001562           15 filler                   pic x(16) value spaces.
001564           15 filler                   pic x(16)
001566              value 'rep-wait'.
001568           15 rep-wait-interval        pic x(48).
001570           15 filler                   pic x(16) value spaces.
001572           15 filler                   pic x(16)
001574              value 'rep-persist'.
001576           15 rep-persistent           pic x(48).
001578           15 filler                   pic x(16) value spaces.
001580           15 filler                   pic x(16)
001582              value 'rep-msgid'.
001584           15 rep-msgid                pic x(24).
001586           15 filler                   pic x(08) value spaces.
001588           15 filler                   pic x(16)
001590              value 'rep-correlid'.
001592           15 rep-correlid             pic x(24).
001594           15 filler                   pic x(08) value spaces.
001596           15 filler                   pic x(16)
001598              value 'to-upgm-bfr-pntr'.
001600           15 to-upgm-bfr-pntr         usage pointer.
001602           15 filler                   pic x(12) value spaces.
001604           15 filler                   pic x(16)
001606              value 'to-upgm-bfr-fl'.
001608           15 to-upgm-bfr-full-lenf    pic +999,999,999.
001610           15 filler                   pic x(04) value spaces.
001612           15 filler                   pic x(16)
001614              value 'to-upgm-bfr-ul'.
001616           15 to-upgm-bfr-used-lenf    pic +999,999,999.
001618           15 filler                   pic x(04) value spaces.
001620           15 filler                   pic x(16)
001622              value 'to-upgm-qmgr'.
001624           15 to-upgm-qmgr-name        pic x(48).
001626           15 filler                   pic x(16) value spaces.
001628           15 filler                   pic x(16)
001630              value 'to-upgm-qname'.
001632           15 to-upgm-qname            pic x(48).
001634           15 filler                   pic x(16) value spaces.
001636           15 filler                   pic x(16)
001638              value 'to-upgm-qnbr'.
001640           15 to-upgm-queue-nbr        pic x(03).
001642           15 filler                   pic x(13) value spaces.
001644           15 filler                   pic x(16)
001646              value 'to-upgm-expiry'.
001648           15 to-upgm-expiry           pic x(01).
001650           15 filler                   pic x(15) value spaces.
001652           15 filler                   pic x(16)
001654              value 'to-upgm-wait'.
001656           15 to-upgm-wait-interval    pic +999,999,999.
001658           15 filler                   pic x(04) value spaces.
001660           15 filler                   pic x(16)
001662              value 'to-upgm-persis'.
001664           15 to-upgm-persistent       pic x(01).
001666           15 filler                   pic x(15) value spaces.
001668           15 filler                   pic x(16)
001670              value 'to-upgm-msgid'.
001672           15 to-upgm-msgid            pic x(24).
001674           15 filler                   pic x(08) value spaces.
001676           15 filler                   pic x(16)
001678              value 'to-upgm-correlid'.
001680           15 to-upgm-correlid         pic x(24).
001682           15 filler                   pic x(08) value spaces.
001684           15 filler                   pic x(16)
001686              value 'fr-upgm-bfr-pntr'.
001688           15 from-upgm-bfr-pntr       usage pointer.
001690           15 filler                   pic x(12) value spaces.
001692           15 filler                   pic x(16)
001694              value 'fr-upgm-bfr-fl'.
001696           15 from-upgm-bfr-full-lenf  pic +999,999,999.
001698           15 filler                   pic x(04) value spaces.
001700           15 filler                   pic x(16)
001702              value 'fr-upgm-bfr-ul'.
001704           15 from-upgm-bfr-used-lenf  pic +999,999,999.
001706           15 filler                   pic x(04) value spaces.
001708           15 filler                   pic x(16)
001710              value 'fr-upgm-qmgr'.
001712           15 from-upgm-qmgr-name      pic x(48).
001714           15 filler                   pic x(16) value spaces.
001716           15 filler                   pic x(16)
001718              value 'fr-upgm-qname'.
001720           15 from-upgm-qname          pic x(48).
001722           15 filler                   pic x(16) value spaces.
001724           15 filler                   pic x(16)
001726              value 'fr-upgm-qnbr'.
001728           15 from-upgm-queue-nbr      pic x(03).
001730           15 filler                   pic x(13) value spaces.
001732           15 filler                   pic x(16)
001734              value 'fr-upgm-expiry'.
001736           15 from-upgm-expiry         pic x(01).
001738           15 filler                   pic x(15) value spaces.
001740           15 filler                   pic x(16)
001742              value 'fr-upgm-wait'.
001744           15 from-upgm-wait-interval  pic +999,999,999.
001746           15 filler                   pic x(04) value spaces.
001748           15 filler                   pic x(16)
001750              value 'fr-upgm-persis'.
001752           15 from-upgm-persistent     pic x(01).
001754           15 filler                   pic x(15) value spaces.
001756           15 filler                   pic x(16)
001758              value 'fr-upgm-msgid'.
001760           15 from-upgm-msgid          pic x(24).
001762           15 filler                   pic x(08) value spaces.
001764           15 filler                   pic x(16)
001766              value 'fr-upgm-correlid'.
001768           15 from-upgm-correlid       pic x(24).
001770           15 filler                   pic x(08) value spaces.
001772           15 filler                   pic x(16)
001774              value 'up-mode'.
001776           15 from-upgm-processing-mode
001778                                       pic x(04).
001780           15 filler                   pic x(12) value spaces.
001782           15 filler                   pic x(16)
001784              value 'up-abend-program'.
001786           15 from-upgm-abend-program  pic x(08).
001788           15 filler                   pic x(08) value spaces.
001790           15 filler                   pic x(16)
001792              value 'up-abend-code'.
001794           15 from-upgm-abend-code     pic x(04).
001796           15 filler                   pic x(12) value spaces.
001798           15 filler                   pic x(16)
001800              value 'up-return-code'.
001802           15 from-upgm-return-code    pic +9(04).
001804           15 filler                   pic x(11) value spaces.
001806           15 filler                   pic x(16)
001808              value 'up-reason'.
001810           15 from-upgm-reason         pic x(04).
001812           15 filler                   pic x(12) value spaces.
001814           15 filler                   pic x(16)
001816              value 'up-msg'.
001818           15 from-upgm-msg            pic x(256).
001820           15 filler                   pic x(16) value spaces.
001822     05 ws-trif-t.
001824        10 trif-t.
001826           15 filler                   pic x(16)
001828              value 'Stru TRIF'.
001830           15 filler                   pic x(16)
001832              value 'tp-inv-mode'.
001834           15 amb-tp-invocation-mode   pic x(01).
001836           15 filler                   pic x(15) value spaces.
001838           15 filler                   pic x(16)
001840              value 'tp-sched'.
001842           15 amb-tp-psb-scheduled-mode
001844                                       pic x(01).
001846           15 filler                   pic x(15) value spaces.
001848           15 filler                   pic x(16)
001850              value 'tp-addr-count'.
001852           15 amb-tp-addr-count        pic +999,999,999.
001854           15 filler                   pic x(04) value spaces.
001856           15 filler                   pic x(16)
001858              value 'tp-calling'.
001860           15 amb-tp-calling-program-id
001862                                       pic x(08).
001864           15 filler                   pic x(08) value spaces.
001866           15 filler                   pic x(16)
001868              value 'tp-filler-28'.
001870           15 amb-tp-filler-28         pic x(28).
001872           15 filler                   pic x(04) value spaces.
001874           15 filler                   pic x(16)
001876              value 'version'.
001878           15 version                  pic +999,999,999.
001880           15 filler                   pic x(04) value spaces.
001882           15 filler                   pic x(16)
001884              value 'struclen'.
001886           15 struclen                 pic +999,999,999.
001888           15 filler                   pic x(04) value spaces.
001890           15 filler                   pic x(16)
001892              value 'this-pntr'.
001894           15 this-pntr                usage pointer.
001896           15 filler                   pic x(12) value spaces.
001898           15 filler                   pic x(16)
001900              value 'ebiz-name'.
001902           15 ebiz-name                pic x(08).
001904           15 filler                   pic x(08) value spaces.
001906           15 filler                   pic x(16)
001908              value 'upgm-name'.
001910           15 upgm-name                pic x(08).
001912           15 filler                   pic x(08) value spaces.
001914           15 filler                   pic x(16)
001916              value 'useridx'.
001918           15 useridx                  pic x(08).
001920           15 filler                   pic x(08) value spaces.
001922           15 filler                   pic x(16)
001924              value 'trace-level'.
001926           15 trace-level              pic +9(01).
001928           15 filler                   pic x(14) value spaces.
001930           15 filler                   pic x(16)
001932              value 'trace-queue'.
001934           15 trace-queue-name         pic x(16).
001936           15 filler                   pic x(16)
001938              value 'copybook-mode'.
001940           15 copybook-mode            pic x(04).
001942           15 filler                   pic x(12) value spaces.
001944           15 filler                   pic x(16)
001946              value 'tf-upgm-bfr-off'.
001948           15 to-from-upgm-bfr-offset  pic +999,999,999.
001950           15 filler                   pic x(04) value spaces.
001952           15 filler                   pic x(16)
001954              value 'tf-upgm-bfr-len'.
001956           15 to-from-upgm-bfr-full-lenf
001958                                       pic +999,999,999.
001960           15 filler                   pic x(04) value spaces.
001962           15 filler                   pic x(16)
001964              value 'tf-upgm-act-len'.
001966           15 to-from-upgm-bfr-used-lenf
001968                                       pic +999,999,999.
001970           15 filler                   pic x(04) value spaces.
001972           15 filler                   pic x(16)
001974              value 'tf-upgm-bfr-pntr'.
001976           15 to-from-upgm-bfr-pntr    usage pointer.
001978           15 filler                   pic x(12) value spaces.
001980           15 filler                   pic x(16)
001982              value 'to-upgm-bfr-pntr'.
001984           15 to-upgm-bfr-pntr         usage pointer.
001986           15 filler                   pic x(12) value spaces.
001988           15 filler                   pic x(16)
001990              value 'to-upgm-bfr-len'.
001992           15 to-upgm-bfr-full-lenf    pic +999,999,999.
001994           15 filler                   pic x(04) value spaces.
001996           15 filler                   pic x(16)
001998              value 'to-upgm-act-len'.
002000           15 to-upgm-bfr-used-lenf    pic +999,999,999.
002002           15 filler                   pic x(04) value spaces.
002004           15 filler                   pic x(16)
002006              value 'fr-upgm-bfr-pntr'.
002008           15 from-upgm-bfr-pntr       usage pointer.
002010           15 filler                   pic x(12) value spaces.
002012           15 filler                   pic x(16)
002014              value 'fr-upgm-bfr-len'.
002016           15 from-upgm-bfr-full-lenf  pic +999,999,999.
002018           15 filler                   pic x(04) value spaces.
002020           15 filler                   pic x(16)
002022              value 'fr-upgm-act-len'.
002024           15 from-upgm-bfr-used-lenf  pic +999,999,999.
002026           15 filler                   pic x(04) value spaces.
002028           15 filler                   pic x(16)
002030              value 'fr-upgm-amode'.
002032           15 from-upgm-processing-mode
002034                                       pic x(04).
002036           15 filler                   pic x(12) value spaces.
002038           15 filler                   pic x(16)
002040              value 'fr-upgm-abend'.
002042           15 from-upgm-abend-code     pic x(04).
002044           15 filler                   pic x(12) value spaces.
002046           15 filler                   pic x(16)
002048              value 'fr-upgm-abend-p'.
002050           15 from-upgm-abend-program  pic x(08).
002052           15 filler                   pic x(08) value spaces.
002054           15 filler                   pic x(16)
002056              value 'fr-upgm-return'.
002058           15 from-upgm-return-code    pic +9(04).
002060           15 filler                   pic x(11) value spaces.
002062           15 filler                   pic x(16)
002064              value 'fr-upgm-reason'.
002066           15 from-upgm-reason         pic x(04).
002068           15 filler                   pic x(12) value spaces.
002070           15 filler                   pic x(16)
002072              value 'fr-upgm-msg'.
002074           15 from-upgm-msg            pic x(256).
002076           15 filler                   pic x(16) value spaces.
002078           15 filler                   pic x(16)
002080              value 'tp-addr-table'.
002082           15 amb-tp-addr-table        pic x(80).
002084           15 filler                   pic x(16) value spaces.
002086 01  ws-cics-recs-t.
002088     05 filler                         pic x(01) value spaces.
002090     05 ws-asktime-t.
002092        10 asktime-t.
002094           15 filler                   pic x(16)
002096              value 'Exec ASKTIME'.
002098           15 asktime-status           pic x(06).
002100              88 asktime-after-88            value 'after '.
002102              88 asktime-before-88           value 'before'.
002104              88 asktime-error-88            value 'error '.
002106           15 filler                   pic x(10) value space.
002108           15 filler                   pic x(16)
002110              value 'resp'.
002112           15 asktime-resp             pic +999,999,999.
002114           15 filler                   pic x(04) value spaces.
002116           15 filler                   pic x(16)
002118              value 'resp2'.
002120           15 asktime-resp2            pic +999,999,999.
002122           15 filler                   pic x(04) value spaces.
002124           15 filler                   pic x(16)
002126              value 'resource'.
002128           15 asktime-abstime          pic +9(15).
002130     05 ws-formattime-t.
002132        10 formattime-t.
002134           15 filler                   pic x(16)
002136              value 'Exec FORMATTIME'.
002138           15 formattime-status        pic x(06).
002140              88 formattime-after-88         value 'after '.
002142              88 formattime-before-88        value 'before'.
002144              88 formattime-error-88         value 'error '.
002146           15 filler                   pic x(10) value space.
002148           15 filler                   pic x(16)
002150              value 'resp'.
002152           15 formattime-resp          pic +999,999,999.
002154           15 filler                   pic x(04) value spaces.
002156           15 filler                   pic x(16)
002158              value 'resp2'.
002160           15 formattime-resp2         pic +999,999,999.
002162           15 filler                   pic x(04) value spaces.
002164           15 filler                   pic x(16)
002166              value 'resource'.
002168           15 asktime-abstime          pic +9(15).
002170           15 filler                   pic x(16)
002172              value 'yyyymmdd'.
002174           15 formattime-yyyymmdd      pic x(10).
002176           15 filler                   pic x(06) value spaces.
002178           15 filler                   pic x(16)
002180              value 'hhmmss'.
002182           15 formattime-hhmmss        pic x(06).
002184           15 filler                   pic x(10) value spaces.
002186           15 filler                   pic x(16)
002188              value 'yyddd'.
002190           15 formattime-yyddd         pic x(05).
002192           15 filler                   pic x(11) value spaces.
002194     05 ws-return-t.
002196        10 return-t.
002198           15 filler                   pic x(16)
002200              value 'Exec RETURN'.
002202           15 return-status            pic x(06).
002204              88 return-after-88             value 'after '.
002206              88 return-before-88            value 'before'.
002208              88 return-error-88             value 'error '.
002210           15 filler                   pic x(10) value space.
002212           15 filler                   pic x(16)
002214              value 'resp'.
002216           15 return-resp              pic +999,999,999.
002218           15 filler                   pic x(04) value spaces.
002220           15 filler                   pic x(16)
002222              value 'resp2'.
002224           15 return-resp2             pic +999,999,999.
002226           15 filler                   pic x(04) value spaces.
002228     05 ws-to-upgm-bfr-t.
002230        10 tpgm.
002232           15 filler                   pic x(16)
002234              value 'Stru TPGM'.
002236           15 filler                   pic x(16)
002238              value 'address'.
002240           15 addressx                 pic x(04).
002242           15 filler                   pic x(12) value spaces.
002244           15 filler                   pic x(16)
002246              value 'start-position'.
002248           15 start-position           pic +999,999,999.
002250           15 filler                   pic x(04) value spaces.
002252           15 filler                   pic x(16)
002254              value 'end-position'.
002256           15 end-position             pic +999,999,999.
002258           15 filler                   pic x(04) value spaces.
002260           15 filler                   pic x(16)
002262              value 'full-length'.
002264           15 full-length              pic +999,999,999.
002266           15 filler                   pic x(04) value spaces.
002268           15 filler                   pic x(16)
002270              value 'on next line'.
002272     05 ws-from-upgm-bfr-t.
002274        10 fupg.
002276           15 filler                   pic x(16)
002278              value 'Stru FUPG'.
002280           15 filler                   pic x(16)
002282              value 'address'.
002284           15 addressx                 pic x(04).
002286           15 filler                   pic x(12) value spaces.
002288           15 filler                   pic x(16)
002290              value 'start-position'.
002292           15 start-position           pic +999,999,999.
002294           15 filler                   pic x(04) value spaces.
002296           15 filler                   pic x(16)
002298              value 'end-position'.
002300           15 end-position             pic +999,999,999.
002302           15 filler                   pic x(04) value spaces.
002304           15 filler                   pic x(16)
002306              value 'full-length'.
002308           15 full-length              pic +999,999,999.
002310           15 filler                   pic x(04) value spaces.
002312           15 filler                   pic x(16)
002314              value 'on next line'.
002316 01  ws-mq-recs-t.
002318     05 ws-mqclose-t.
002320        10 mqclose-t.
002322           15 filler                   pic x(16)
002324             value 'Call MQCLOSE'.
002326            15 mqclose-status          pic x(06).
002328              88 mqclose-after-88            value 'after '.
002330              88 mqclose-before-88           value 'before'.
002332              88 mqclose-error-88            value 'error '.
002334           15 filler                   pic x(10) value spaces.
002336           15 filler                   pic x(16)
002338              value 'Hconn'.
002340           15 mqclose-hconn            pic +999,999,999.
002342           15 filler                   pic x(04) value spaces.
002344           15 filler                   pic x(16)
002346              value 'Hobj'.
002348           15 mqclose-q-handle         pic +999,999,999.
002350           15 filler                   pic x(04) value spaces.
002352           15 filler                   pic x(16)
002354              value 'Options'.
002356           15 mqclose-options          pic +999,999,999.
002358           15 filler                   pic x(04) value spaces.
002360           15 filler                   pic x(16)
002362              value 'CompCode'.
002364           15 mqclose-comp-code        pic +999,999,999.
002366           15 filler                   pic x(04) value spaces.
002368           15 filler                   pic x(16)
002370              value 'Reason'.
002372           15 mqclose-reason           pic +999,999,999.
002374           15 filler                   pic x(04) value spaces.
002376     05 ws-mqget-t.
002378        10 mqget-t.
002380           15 filler                   pic x(16)
002382             value 'Call MQGET'.
002384           15 mqget-status             pic x(06).
002386              88 mqget-after-88              value 'after '.
002388              88 mqget-before-88             value 'before'.
002390              88 mqget-error-88              value 'error '.
002392           15 filler                   pic x(10) value spaces.
002394           15 filler                   pic x(16)
002396              value 'Hconn'.
002398           15 mqget-hconn              pic +999,999,999.
002400           15 filler                   pic x(04) value spaces.
002402           15 filler                   pic x(16)
002404              value 'Hobj'.
002406           15 mqget-q-handle           pic +999,999,999.
002408           15 filler                   pic x(04) value spaces.
002410           15 filler                   pic x(32)
002412              value 'MsgDesc         next trace rec'.
002414           15 filler                   pic x(32)
002416              value 'GetMsgOpts      next trace rec'.
002418           15 filler                   pic x(16)
002420              value 'BufferLength'.
002422           15 mqget-buffer-lenf        pic +999,999,999.
002424           15 filler                   pic x(04) value spaces.
002426           15 filler                   pic x(32)
002428              value 'Buffer          next trace rec'.
002430           15 filler                   pic x(16)
002432              value 'Datalength'.
002434           15 mqget-data-lenf          pic +999,999,999.
002436           15 filler                   pic x(04) value spaces.
002438           15 filler                   pic x(16)
002440              value 'CompCode'.
002442           15 mqget-comp-code          pic +999,999,999.
002444           15 filler                   pic x(04) value spaces.
002446           15 filler                   pic x(16)
002448              value 'Reason'.
002450           15 mqget-reason             pic +999,999,999.
002452           15 filler                   pic x(04) value spaces.
002454     05 ws-mqopen-t.
002456        10 mqopen-t.
002458           15 filler                   pic x(16)
002460             value 'Call MQOPEN'.
002462           15 mqopen-status            pic x(06).
002464              88 mqopen-after-88             value 'after '.
002466              88 mqopen-before-88            value 'before'.
002468              88 mqopen-error-88             value 'error '.
002470           15 filler                   pic x(10) value spaces.
002472           15 filler                   pic x(16)
002474              value 'Hconn'.
002476           15 mqopen-hconn             pic +999,999,999.
002478           15 filler                   pic x(04) value spaces.
002480           15 filler                   pic x(32)
002482              value 'ObjDesc         next trace rec'.
002484           15 filler                   pic x(16)
002486              value 'Options'.
002488           15 mqopen-options           pic +999,999,999.
002490           15 filler                   pic x(04) value spaces.
002492           15 filler                   pic x(16)
002494              value 'Hobj'.
002496           15 mqopen-q-handle          pic +999,999,999.
002498           15 filler                   pic x(04) value spaces.
002500           15 filler                   pic x(16)
002502              value 'CompCode'.
002504           15 mqopen-comp-code         pic +999,999,999.
002506           15 filler                   pic x(04) value spaces.
002508           15 filler                   pic x(16)
002510              value 'Reason'.
002512           15 mqopen-reason            pic +999,999,999.
002514           15 filler                   pic x(04) value spaces.
002516     05 ws-mqput1-t.
002518        10 mqput1-t.
002520           15 filler                   pic x(16)
002522             value 'Call MQPUT1'.
002524           15 mqput1-status            pic x(06).
002526              88 mqput1-after-88             value 'after '.
002528              88 mqput1-before-88            value 'before'.
002530              88 mqput1-error-88             value 'error '.
002532           15 filler                   pic x(10) value spaces.
002534           15 filler                   pic x(16)
002536              value 'Hconn'.
002538           15 mqput1-hconn             pic +999,999,999.
002540           15 filler                   pic x(04) value spaces.
002542           15 filler                   pic x(32)
002544              value 'ObjDesc         next trace rec'.
002546           15 filler                   pic x(32)
002548              value 'MsgDesc         next trace rec'.
002550           15 filler                   pic x(32)
002552              value 'PutMsgOpts      next trace rec'.
002554           15 filler                   pic x(16)
002556              value 'BufferLength'.
002558           15 mqput1-buffer-lenf       pic +999,999,999.
002560           15 filler                   pic x(04) value spaces.
002562           15 filler                   pic x(32)
002564              value 'MsgDesc         next trace rec'.
002566           15 filler                   pic x(16)
002568              value 'CompCode'.
002570           15 mqput1-comp-code         pic +999,999,999.
002572           15 filler                   pic x(04) value spaces.
002574           15 filler                   pic x(16)
002576              value 'Reason'.
002578           15 mqput1-reason            pic +999,999,999.
002580           15 filler                   pic x(04) value spaces.
002582     05 ws-cmqodv-t.
002584        10 mqod-trace.
002586           15 filler                   pic x(16)
002588             value 'Stru CMQODV'.
002590           15 filler                   pic x(16)
002592              value 'strucid'.
002594           15 mqod-strucid             pic x(04).
002596           15 filler                   pic x(12) value spaces.
002598           15 filler                   pic x(16)
002600              value 'version'.
002602           15 mqod-version             pic +999,999,999.
002604           15 filler                   pic x(04) value spaces.
002606           15 filler                   pic x(16)
002608              value 'objecttype'.
002610           15 mqod-objecttype          pic +999,999,999.
002612           15 filler                   pic x(04) value spaces.
002614           15 filler                   pic x(16)
002616              value 'objectname'.
002618           15 mqod-objectname          pic x(48).
002620           15 filler                   pic x(16) value spaces.
002622           15 filler                   pic x(16)
002624              value 'objectqmgrname'.
002626           15 mqod-objectqmgrname      pic x(48).
002628           15 filler                   pic x(16) value spaces.
002630           15 filler                   pic x(16)
002632              value 'dynamicqname'.
002634           15 mqod-dynamicqname        pic x(48).
002636           15 filler                   pic x(16) value spaces.
002638           15 filler                   pic x(16)
002640              value 'alternateuserid'.
002642           15 mqod-alternateuserid     pic x(12).
002644           15 filler                   pic x(04) value spaces.
002646           15 filler                   pic x(16)
002648              value 'recspresent'.
002650           15 mqod-recspresent         pic +999,999,999.
002652           15 filler                   pic x(04) value spaces.
002654           15 filler                   pic x(16)
002656              value 'knowndestcount'.
002658           15 mqod-knowndestcount      pic +999,999,999.
002660           15 filler                   pic x(04) value spaces.
002662           15 filler                   pic x(16)
002664              value 'unknowndestcount'.
002666           15 mqod-unknowndestcount    pic +999,999,999.
002668           15 filler                   pic x(04) value spaces.
002670           15 filler                   pic x(16)
002672              value 'invaliddestcount'.
002674           15 mqod-invaliddestcount    pic x(04).
002676           15 filler                   pic x(12) value spaces.
002678           15 filler                   pic x(16)
002680              value 'objectrecoffset'.
002682           15 mqod-objectrecoffset     pic +999,999,999.
002684           15 filler                   pic x(04) value spaces.
002686           15 filler                   pic x(16)
002688              value 'responserecoffse'.
002690           15 mqod-responserecoffset   pic +999,999,999.
002692           15 filler                   pic x(04) value spaces.
002694           15 filler                   pic x(16)
002696              value 'objectrecptr'.
002698           15 mqod-objectrecptr        usage pointer.
002700           15 filler                   pic x(12) value spaces.
002702           15 filler                   pic x(16)
002704              value 'responserecptr'.
002706           15 mqod-responserecptr      usage pointer.
002708           15 filler                   pic x(12) value spaces.
002710           15 filler                   pic x(16)
002712              value 'alternatesecurit'.
002714           15 mqod-alternatesecurityid pic x(40).
002716           15 filler                   pic x(08) value spaces.
002718           15 filler                   pic x(16)
002720              value 'resolvedqname'.
002722           15 mqod-resolvedqname       pic x(48).
002724           15 filler                   pic x(16) value spaces.
002726           15 filler                   pic x(16)
002728              value 'resolvedqmgrname'.
002730           15 mqod-resolvedqmgrname    pic x(48).
002732           15 filler                   pic x(16) value spaces.
002734     05 ws-cmqmdv-t.
002736        10 mqmd-trace.
002738           15 filler                   pic x(16)
002740             value 'Stru CMQPMOV'.
002742           15 filler                   pic x(16)
002744              value 'strucid'.
002746           15 mqmd-strucid             pic x(04).
002748           15 filler                   pic x(12) value spaces.
002750           15 filler                   pic x(16)
002752              value 'version'.
002754           15 mqmd-version             pic +999,999,999.
002756           15 filler                   pic x(04) value spaces.
002758           15 filler                   pic x(16)
002760              value 'report'.
002762           15 mqmd-report              pic +999,999,999.
002764           15 filler                   pic x(04) value spaces.
002766           15 filler                   pic x(16)
002768              value 'msgtype'.
002770           15 mqmd-msgtype             pic +999,999,999.
002772           15 filler                   pic x(04) value spaces.
002774           15 filler                   pic x(16)
002776              value 'expiry'.
002778           15 mqmd-expiry              pic +999,999,999.
002780           15 filler                   pic x(04) value spaces.
002782           15 filler                   pic x(16)
002784              value 'feedback'.
002786           15 mqmd-feedback            pic +999,999,999.
002788           15 filler                   pic x(04) value spaces.
002790           15 filler                   pic x(16)
002792              value 'encoding'.
002794           15 mqmd-encoding            pic +999,999,999.
002796           15 filler                   pic x(04) value spaces.
002798           15 filler                   pic x(16)
002800              value 'codedcharsetid'.
002802           15 mqmd-codedcharsetid      pic +999,999,999.
002804           15 filler                   pic x(04) value spaces.
002806           15 filler                   pic x(16)
002808              value 'format'.
002810           15 mqmd-format              pic x(08).
002812           15 filler                   pic x(08) value spaces.
002814           15 filler                   pic x(16)
002816              value 'priority'.
002818           15 mqmd-priority            pic +999,999,999.
002820           15 filler                   pic x(04) value spaces.
002822           15 filler                   pic x(16)
002824              value 'persistence'.
002826           15 mqmd-persistence         pic +999,999,999.
002828           15 filler                   pic x(04) value spaces.
002830           15 filler                   pic x(16)
002832              value 'msgid'.
002834           15 mqmd-msgid               pic x(24).
002836           15 filler                   pic x(08) value spaces.
002838           15 filler                   pic x(16)
002840              value 'correlid'.
002842           15 mqmd-correlid            pic x(24).
002844           15 filler                   pic x(08) value spaces.
002846           15 filler                   pic x(16)
002848              value 'backoutcount'.
002850           15 mqmd-backoutcount        pic +999,999,999.
002852           15 filler                   pic x(04) value spaces.
002854           15 filler                   pic x(16)
002856              value 'replytoq'.
002858           15 mqmd-replytoq            pic x(48).
002860           15 filler                   pic x(16) value spaces.
002862           15 filler                   pic x(16)
002864              value 'replytoqmgr'.
002866           15 mqmd-replytoqmgr         pic x(48).
002868           15 filler                   pic x(16) value spaces.
002870           15 filler                   pic x(16)
002872              value 'useridentifier'.
002874           15 mqmd-useridentifier      pic x(12).
002876           15 filler                   pic x(04) value spaces.
002878           15 filler                   pic x(16)
002880              value 'accountingtoken'.
002882           15 mqmd-accountingtoken     pic x(32).
002884           15 filler                   pic x(16) value spaces.
002886           15 filler                   pic x(16)
002888              value 'applidentitydata'.
002890           15 mqmd-applidentitydata    pic x(32).
002892           15 filler                   pic x(16) value spaces.
002894           15 filler                   pic x(16)
002896              value 'putappltype'.
002898           15 mqmd-putappltype         pic +999,999,999.
002900           15 filler                   pic x(04) value spaces.
002902           15 filler                   pic x(16)
002904              value 'putapplname'.
002906           15 mqmd-putapplname         pic x(28).
002908           15 filler                   pic x(04) value spaces.
002910           15 filler                   pic x(16)
002912              value 'putdate'.
002914           15 mqmd-putdate             pic x(08).
002916           15 filler                   pic x(08) value spaces.
002918           15 filler                   pic x(16)
002920              value 'puttime'.
002922           15 mqmd-puttime             pic x(08).
002924           15 filler                   pic x(08) value spaces.
002926           15 filler                   pic x(16)
002928              value 'applorigindata'.
002930           15 mqmd-applorigindata      pic x(04).
002932           15 filler                   pic x(12) value spaces.
002934     05 ws-cmqgmov-t.
002936        10 cmqgmov-t.
002938           15 filler                   pic x(16)
002940             value 'Stru CMQGMOV'.
002942           15 filler                   pic x(16)
002944              value 'strucid'.
002946           15 mqgmo-strucid            pic x(04).
002948           15 filler                   pic x(12) value spaces.
002950           15 filler                   pic x(16)
002952              value 'version'.
002954           15 mqgmo-version            pic +999,999,999.
002956           15 filler                   pic x(04) value spaces.
002958           15 filler                   pic x(16)
002960              value 'options'.
002962           15 mqgmo-options            pic +999,999,999.
002964           15 filler                   pic x(04) value spaces.
002966           15 filler                   pic x(16)
002968              value 'waitinterval'.
002970           15 mqgmo-waitinterval       pic +999,999,999.
002972           15 filler                   pic x(04) value spaces.
002974           15 filler                   pic x(16)
002976              value 'signal1'.
002978           15 mqgmo-signal1            pic +999,999,999.
002980           15 filler                   pic x(04) value spaces.
002982           15 filler                   pic x(16)
002984              value 'signal2'.
002986           15 mqgmo-signal2            pic +999,999,999.
002988           15 filler                   pic x(04) value spaces.
002990           15 filler                   pic x(16)
002992              value 'resolvedqname'.
002994           15 mqgmo-resolvedqname      pic x(48).
002996           15 filler                   pic x(16) value spaces.
002998           15 filler                   pic x(16)
003000              value 'matchoptions'.
003002           15 mqgmo-matchoptions       pic +999,999,999.
003004           15 filler                   pic x(04) value spaces.
003006           15 filler                   pic x(16)
003008              value 'groupstatus'.
003010           15 mqgmo-groupstatus        pic x(01).
003012           15 filler                   pic x(15) value spaces.
003014           15 filler                   pic x(16)
003016              value 'segmentstatus'.
003018           15 mqgmo-segmentstatus      pic x(01).
003020           15 filler                   pic x(15) value spaces.
003022           15 filler                   pic x(16)
003024              value 'segmentation'.
003026           15 mqgmo-segmentation       pic x(01).
003028           15 filler                   pic x(15) value spaces.
003030           15 filler                   pic x(16)
003032              value 'reserved1'.
003034           15 mqgmo-reserved1          pic x(01).
003036           15 filler                   pic x(15) value spaces.
003038           15 filler                   pic x(16)
003040              value 'msgtoken'.
003042           15 mqgmo-msgtoken           pic x(16).
003044           15 filler                   pic x(16)
003046              value 'returnedlength'.
003048           15 mqgmo-returnedlength     pic +999,999,999.
003050           15 filler                   pic x(04) value spaces.
003052     05 ws-cmqpmol-t.
003054        10 cmqpmol-t.
003056           15 filler                   pic x(16)
003058             value 'Stru CMQPMOL'.
003060           15 filler                   pic x(16)
003062              value 'strucid'.
003064           15 mqpmo-strucid            pic x(04).
003066           15 filler                   pic x(12) value spaces.
003068           15 filler                   pic x(16)
003070              value 'version'.
003072           15 mqpmo-version            pic +999,999,999.
003074           15 filler                   pic x(04) value spaces.
003076           15 filler                   pic x(16)
003078              value 'options'.
003080           15 mqpmo-options            pic +999,999,999.
003082           15 filler                   pic x(04) value spaces.
003084           15 filler                   pic x(16)
003086              value 'timeout'.
003088           15 mqpmo-timeout            pic +999,999,999.
003090           15 filler                   pic x(04) value spaces.
003092           15 filler                   pic x(16)
003094              value 'context'.
003096           15 mqpmo-context            pic +999,999,999.
003098           15 filler                   pic x(04) value spaces.
003100           15 filler                   pic x(16)
003102              value 'knowndestcount'.
003104           15 mqpmo-knowndestcount     pic +999,999,999.
003106           15 filler                   pic x(04) value spaces.
003108           15 filler                   pic x(16)
003110              value 'unknowndestcount'.
003112           15 mqpmo-unknowndestcount   pic +999,999,999.
003114           15 filler                   pic x(04) value spaces.
003116           15 filler                   pic x(16)
003118              value 'invaliddestcount'.
003120           15 mqpmo-invaliddestcount   pic +999,999,999.
003122           15 filler                   pic x(04) value spaces.
003124           15 filler                   pic x(16)
003126              value 'resolvedqname'.
003128           15 mqpmo-resolvedqname      pic x(48).
003130           15 filler                   pic x(16) value spaces.
003132           15 filler                   pic x(16)
003134              value 'resolvedqmgrname'.
003136           15 mqpmo-resolvedqmgrname   pic x(48).
003138           15 filler                   pic x(16) value spaces.
003140     05 ws-cmqpmov-t.
003142        10 cmqpmov-t.
003144           15 filler                   pic x(16)
003146             value 'Stru CMQPMOV'.
003148           15 filler                   pic x(16)
003150              value 'strucid'.
003152           15 mqpmo-strucid            pic x(04).
003154           15 filler                   pic x(12) value spaces.
003156           15 filler                   pic x(16)
003158              value 'version'.
003160           15 mqpmo-version            pic +999,999,999.
003162           15 filler                   pic x(04) value spaces.
003164           15 filler                   pic x(16)
003166              value 'options'.
003168           15 mqpmo-options            pic +999,999,999.
003170           15 filler                   pic x(04) value spaces.
003172           15 filler                   pic x(16)
003174              value 'timeout'.
003176           15 mqpmo-timeout            pic +999,999,999.
003178           15 filler                   pic x(04) value spaces.
003180           15 filler                   pic x(16)
003182              value 'context'.
003184           15 mqpmo-context            pic +999,999,999.
003186           15 filler                   pic x(04) value spaces.
003188           15 filler                   pic x(16)
003190              value 'knowndestcount'.
003192           15 mqpmo-knowndestcount     pic +999,999,999.
003194           15 filler                   pic x(04) value spaces.
003196           15 filler                   pic x(16)
003198              value 'unknowndestcount'.
003200           15 mqpmo-unknowndestcount   pic +999,999,999.
003202           15 filler                   pic x(04) value spaces.
003204           15 filler                   pic x(16)
003206              value 'invaliddestcount'.
003208           15 mqpmo-invaliddestcount   pic +999,999,999.
003210           15 filler                   pic x(04) value spaces.
003212           15 filler                   pic x(16)
003214              value 'resolvedqname'.
003216           15 mqpmo-resolvedqname      pic x(48).
003218           15 filler                   pic x(16) value spaces.
003220           15 filler                   pic x(16)
003222              value 'resolvedqmgrname'.
003224           15 mqpmo-resolvedqmgrname   pic x(48).
003226           15 filler                   pic x(16) value spaces.
003228 01  ws-amb-recs-t.
003230     05 ws-to-from-upgm-t.
003232         10 to-from-upgm-rec-1-t.
003234            15 filler                  pic x(16)
003236               value 'Stru TOFR'.
003238            15 filler                  pic x(16)
003240               value 'tofr-upgm-offset'.
003242            15 to-from-upgm-bfr-offset pic +999,999,999.
003244            15 filler                  pic x(04) value spaces.
003246            15 filler                  pic x(16)
003248               value 'tofr-upgm-lenf'.
003250            15 to-from-upgm-bfr-full-lenf
003252                                       pic +999,999,999.
003254            15 filler                  pic x(04) value spaces.
003256            15 filler                  pic x(16)
003258               value 'tofr-upgm-lenf'.
003260            15 to-from-upgm-bfr-used-lenf
003262                                       pic +999,999,999.
003264            15 filler                  pic x(04) value spaces.
003266            15 filler                  pic x(16)
003268               value 'to-upgm-offset'.
003270            15 to-upgm-bfr-offset      pic +999,999,999.
003272            15 filler                  pic x(04) value spaces.
003274            15 filler                  pic x(16)
003276               value 'to-upgm-lenf'.
003278            15 to-upgm-bfr-full-lenf   pic +999,999,999.
003280            15 filler                  pic x(04) value spaces.
003282            15 filler                  pic x(16)
003284               value 'to-upgm-lenf'.
003286            15 to-upgm-bfr-used-lenf   pic +999,999,999.
003288            15 filler                  pic x(04) value spaces.
003290            15 filler                  pic x(16)
003292               value 'from-upgm-offset'.
003294            15 from-upgm-bfr-offset    pic +999,999,999.
003296            15 filler                  pic x(04) value spaces.
003298            15 filler                  pic x(16)
003300               value 'from-upgm-lenf'.
003302            15 from-upgm-bfr-full-lenf pic +999,999,999.
003304            15 filler                  pic x(04) value spaces.
003306            15 filler                  pic x(16)
003308               value 'from-upgm-lenf'.
003310            15 from-upgm-bfr-used-lenf pic +999,999,999.
003312            15 filler                  pic x(04) value spaces.
003314 01  ws-footprint-pos                  pic s9(8) comp.
003316 01  ws-footprint-rulefile-ctr         pic s9(8) comp.
003318 01  ws-footprint-rulefile-table.
003320     05  ws-footprint-rulefile-row     occurs 18.
003322         15  ws-footprint-rulefile     pic X(80).
003324 LINKAGE SECTION.
003326 01  dfhcommarea.
003328     05 filler                         pic x(01)
003330                                       occurs 1 to 32767
003332                                       depending on eibcalen.
003334 01  lk-nwif.
003336     03 nwif.
003338*       1,160 bytes in this group
003340        05 nwif-fields.
003342*          16 bytes in this group
003344*          Next field should start on a fullword boundary
003346           10 this-pntr                usage pointer.
003348           10 strucid                  pic x(04).
003350           10 version                  pic s9(08) comp.
003352           10 struclen                 pic s9(08) comp.
003354        05 micro-focus-fields.
003356*          172 bytes in this group
003358           10 mq03-alt-name            pic x(08).
003360           10 trace-level              pic 9(01).
003362           10 trace-level-unused       pic x(03).
003364           10 trace-queue-name         pic x(16).
003366           10 useridx                  pic x(08).
003368           10 ebiz-name                pic x(08).
003370           10 upgm-name                pic x(08).
003372           10 copybook-mode            pic x(04).
003374              88 copybook-mode-is-unk-88     value 'unk '.
003376              88 copybook-mode-is-sam-88     value 'sam '.
003378              88 copybook-mode-is-sep-88     value 'sep '.
003380              88 copybook-mode-is-amb-88     value 'amb '.
003382           10 processing-mode          pic x(04).
003384              88 mode-is-ld-88               value 'lcom'.
003386              88 mode-is-rc-88               value 'rcom'.
003388              88 mode-is-cics-88             value 'cics'.
003390              88 mode-is-ims-88              value 'ims'.
003392           10 security-status          pic x(04).
003394              88 mode-is-security-ok-88      value 'ok'.
003396              88 mode-is-security-error-88   value 'sece'.
003398           10 mf-processing-mode       pic x(04).
003400              88 mf-mode-is-normal-88        value spaces.
003402              88 mf-mode-is-error-88         value 'erro'.
003404           10 mf-abend-program         pic x(08).
003406           10 mf-abend-code            pic x(04).
003408           10 mf-return-code           pic 9(04).
003410           10 mf-reason                pic x(04).
003412           10 mf-msg                   pic x(80).
003414           10 filler                   pic x(04).
003416        05 mqtm-fields.
003418*          128 bytes in this group
003420           10 mqtm-userdata            pic x(128).
003422        05 req-msg-fields.
003424*          196 bytes in this group
003426*          Next field should start on a fullword boundary
003428           10 req-msg-pntr             usage pointer.
003430           10 req-msg-hdr-lenf         pic s9(08) comp.
003432           10 req-msg-hdr-ext-lenf     pic s9(08) comp.
003434           10 req-fmt-hdr-lenf         pic s9(08) comp.
003436           10 req-ebiz-hdr-lenf        pic s9(08) comp.
003438           10 req-ebiz-data-full-lenf  pic s9(08) comp.
003440           10 req-ebiz-data-used-lenf  pic s9(08) comp.
003442           10 req-msg-total-full-lenf  pic s9(08) comp.
003444           10 req-msg-total-used-lenf  pic s9(08) comp.
003446           10 req-msg-mq.
003448              15 req-qmgr-name         pic x(48).
003450              15 req-qname             pic x(48).
003452              15 req-queue-nbr         pic x(04).
003454              15 req-expiry            pic s9(08) comp.
003456              15 req-wait-interval     pic s9(08) comp.
003458              15 req-persistent        pic x(04).
003460              15 req-msgid             pic x(24).
003462              15 req-correlid          pic x(24).
003464        05 rep-msg-fields.
003466*          200 bytes in this group
003468*          Next field should start on a fullword boundary
003470           10 rep-msg-pntr             usage pointer.
003472           10 rep-msg-lenf             pic s9(08) comp.
003474           10 rep-msg-hdr-lenf         pic s9(08) comp.
003476           10 rep-fmt-hdr-lenf         pic s9(08) comp.
003478           10 rep-ebiz-hdr-lenf        pic s9(08) comp.
003480           10 rep-ebiz-data-full-lenf  pic s9(08) comp.
003482           10 rep-ebiz-data-used-lenf  pic s9(08) comp.
003484           10 rep-msg-total-full-lenf  pic s9(08) comp.
003486           10 rep-msg-total-used-lenf  pic s9(08) comp.
003488           10 rep-msg-mq.
003490              15 rep-qmgr-name         pic x(48).
003492              15 rep-qname             pic x(48).
003494              15 rep-queue-nbr         pic x(04).
003496              15 rep-expiry            pic s9(08) comp.
003498              15 rep-wait-interval     pic s9(08) comp.
003500              15 rep-persistent        pic x(04).
003502              15 rep-msgid             pic x(24).
003504              15 rep-correlid          pic x(24).
003506           10 filler                   pic x(04).
003508        05 to-upgm-fields.
003510*          176 bytes in this group
003512*          Next field should start on a fullword boundary
003514           10 to-upgm-bfr-pntr         usage pointer.
003516           10 to-upgm-bfr-full-lenf    pic s9(08) comp.
003518           10 to-upgm-bfr-used-lenf    pic s9(08) comp.
003520           10 to-upgm-mq.
003522              15 to-upgm-qmgr-name     pic x(48).
003524              15 to-upgm-qname         pic x(48).
003526              15 to-upgm-queue-nbr     pic x(04).
003528              15 to-upgm-expiry        pic s9(08) comp.
003530              15 to-upgm-wait-interval pic s9(08) comp.
003532              15 to-upgm-persistent    pic x(04).
003534              15 to-upgm-msgid         pic x(24).
003536              15 to-upgm-correlid      pic x(24).
003538           10 filler                   pic x(04).
003540        05 from-upgm-fields.
003542*          272 bytes in this group
003544*          Next field should start on a fullword boundary
003546           10 from-upgm-bfr-pntr       usage pointer.
003548           10 from-upgm-bfr-full-lenf  pic s9(08) comp.
003550           10 from-upgm-bfr-used-lenf  pic s9(08) comp.
003552           10 from-upgm-mq.
003554              15 from-upgm-qmgr-name   pic x(48).
003556              15 from-upgm-qname       pic x(48).
003558              15 from-upgm-queue-nbr   pic x(04).
003560              15 from-upgm-expiry      pic s9(08) comp.
003562              15 from-upgm-wait-interval
003564                                       pic s9(08) comp.
003566              15 from-upgm-persistent  pic x(04).
003568              15 from-upgm-msgid       pic x(24).
003570              15 from-upgm-correlid    pic x(24).
003572           10 from-upgm-fields-aux.
003574              15 from-upgm-processing-mode
003576                                       pic x(04).
003578                 88 from-upgm-mode-is-normal-88  value spaces.
003580                 88 from-upgm-mode-is-error-88   value 'erro'.
003582              15 from-upgm-abend-program
003584                                       pic x(04).
003586              15 from-upgm-abend-code  pic x(04).
003588              15 from-upgm-return-code pic 9(04).
003590              15 from-upgm-reason      pic x(04).
003592              15 from-upgm-msg         pic x(80).
003594
003596 01  lk-trif.
003598     05 trif.
003600*       316 bytes in this group
003602        10 amb-tp-header.
003604*           40 bytes in this group
003606           15 amb-tp-invocation-mode   pic x(01).
003608              88 amb-tp-transid-invoked      value 'T'.
003610              88 amb-tp-program-invoked      value 'P'.
003612              88 amb-tp-screen-invoked       value 'S'.
003614              88 amb-tp-link-invoked         value 'L'.
003616              88 amb-tp-largedata-invoked    value 'D'.
003618           15 amb-tp-psb-scheduled-mode
003620                                       pic x(01).
003622           15 amb-tp-addr-count        pic s9(04) comp.
003624           15 amb-tp-calling-program-id
003626                                       pic x(08).
003628           15 amb-tp-filler-28         pic x(28).
003630*       Start of fields associated with tp-user-len
003632*       Next field should start on a fullword boundary
003634        10 trif-fields.
003636*          64 bytes in this group
003638           15 this-pntr                usage pointer.
003640           15 strucid                  pic x(04).
003642           15 version                  pic s9(09) comp.
003644           15 struclen                 pic s9(09) comp.
003646           15 ebiz-name                pic x(08).
003648           15 upgm-name                pic x(08).
003650           15 useridx                  pic x(08).
003652           15 trace-level              pic 9(01).
003654           15 trace-level-unused       pic x(03).
003656           15 trace-queue-name         pic x(16).
003658           15 copybook-mode            pic x(04).
003660              88 copybook-mode-is-unk-88     value 'unk '.
003662              88 copybook-mode-is-sam-88     value 'sam '.
003664              88 copybook-mode-is-sep-88     value 'sep '.
003666              88 copybook-mode-is-amb-88     value 'amb '.
003668        10 to-upgm-fields.
003670*           12 bytes in this group
003672*           Next field should start on a fullword boundary
003674           15 to-upgm-bfr-pntr         usage pointer.
003676           15 to-upgm-bfr-full-lenf    pic s9(08) comp.
003678*    *************************************************************
003680*    if the input record in the ebiz program contains
003682*    occurs depending on clauses the to-upgm-bfr-used-lenf
003684*    will be <= to-upgm-bfr-full-lenf based on the current
003686*    size of this record in the ebiz program
003688*    *************************************************************
003690           15 to-upgm-bfr-used-lenf    pic s9(08) comp.
003692              10 from-upgm-fields.
003694*           12 bytes in this group
003696*           Next field should start on a fullword boundary
003698           15 from-upgm-bfr-pntr       usage pointer.
003700           15 from-upgm-bfr-full-lenf  pic s9(08) comp.
003702*    *************************************************************
003704*    if the output record in the user program contains
003706*    occurs depending on clauses the from-upgm-bfr-used-lenf
003708*    will be <= from-upgm-bfr-full-lenf based on the current
003710*    size of this record in the ebiz program
003712*    *************************************************************
003714           15 from-upgm-bfr-used-lenf  pic s9(08) comp.
003716        10 from-upgm-fields-aux.
003718*          108 bytes in this group
003720           15 from-upgm-processing-mode
003722                                       pic x(04).
003724              88 from-upgm-mode-is-normal-88 value spaces.
003726              88 from-upgm-mode-is-error-88  value 'erro'.
003728           15 from-upgm-abend-code     pic x(04).
003730           15 from-upgm-abend-program  pic x(08).
003732           15 from-upgm-return-code    pic 9(04).
003734           15 from-upgm-reason         pic x(04).
003736           15 from-upgm-msg            pic x(80).
003738           15 filler                   pic x(04).
003740* End of fields associated with tp-user-len
003742        10 amb-tp-trailer.
003744*          80 bytes in this group
003746           15 amb-tp-addr-table.
003748              20 amb-tp-addr           usage is pointer
003750                                       occurs 20 times.
003752
003754 01  lk-to-upgm-bfr                    pic x(01).
003756
003758 01  lk-from-upgm-bfr                  pic x(01).
003760
003762 01  lk-nwif-t.
003764     03 nwif.
003766*       1,160 bytes in this group
003768        05 nwif-fields.
003770*          16 bytes in this group
003772*          Next field should start on a fullword boundary
003774           10 this-pntr                usage pointer.
003776           10 strucid                  pic x(04).
003778           10 version                  pic s9(08) comp.
003780           10 struclen                 pic s9(08) comp.
003782        05 micro-focus-fields.
003784*          172 bytes in this group
003786           10 mq03-alt-name            pic x(08).
003788           10 trace-level              pic 9(01).
003790           10 trace-level-unused       pic x(03).
003792           10 trace-queue-name         pic x(16).
003794           10 useridx                  pic x(08).
003796           10 ebiz-name                pic x(08).
003798           10 upgm-name                pic x(08).
003800           10 copybook-mode            pic x(04).
003802              88 copybook-mode-is-unk-88     value 'unk '.
003804              88 copybook-mode-is-sam-88     value 'sam '.
003806              88 copybook-mode-is-sep-88     value 'sep '.
003808              88 copybook-mode-is-amb-88     value 'amb '.
003810           10 processing-mode          pic x(04).
003812              88 mode-is-ld-88               value 'lcom'.
003814              88 mode-is-rc-88               value 'rcom'.
003816              88 mode-is-cics-88             value 'cics'.
003818              88 mode-is-ims-88              value 'ims'.
003820           10 security-status          pic x(04).
003822              88 mode-is-security-ok-88      value 'ok'.
003824              88 mode-is-security-error-88   value 'sece'.
003826           10 mf-processing-mode       pic x(04).
003828              88 mf-mode-is-normal-88        value spaces.
003830              88 mf-mode-is-error-88         value 'erro'.
003832           10 mf-abend-program         pic x(08).
003834           10 mf-abend-code            pic x(04).
003836           10 mf-return-code           pic 9(04).
003838           10 mf-reason                pic x(04).
003840           10 mf-msg                   pic x(80).
003842           10 filler                   pic x(04).
003844        05 mqtm-fields.
003846*          128 bytes in this group
003848           10 mqtm-userdata            pic x(128).
003850        05 req-msg-fields.
003852*          196 bytes in this group
003854*          Next field should start on a fullword boundary
003856           10 req-msg-pntr             usage pointer.
003858           10 req-msg-hdr-lenf         pic s9(08) comp.
003860           10 req-msg-hdr-ext-lenf     pic s9(08) comp.
003862           10 req-fmt-hdr-lenf         pic s9(08) comp.
003864           10 req-ebiz-hdr-lenf        pic s9(08) comp.
003866           10 req-ebiz-data-full-lenf  pic s9(08) comp.
003868           10 req-ebiz-data-used-lenf  pic s9(08) comp.
003870           10 req-msg-total-full-lenf  pic s9(08) comp.
003872           10 req-msg-total-used-lenf  pic s9(08) comp.
003874           10 req-msg-mq.
003876              15 req-qmgr-name         pic x(48).
003878              15 req-qname             pic x(48).
003880              15 req-queue-nbr         pic x(04).
003882              15 req-expiry            pic s9(08) comp.
003884              15 req-wait-interval     pic s9(08) comp.
003886              15 req-persistent        pic x(04).
003888              15 req-msgid             pic x(24).
003890              15 req-correlid          pic x(24).
003892        05 rep-msg-fields.
003894*          200 bytes in this group
003896*          Next field should start on a fullword boundary
003898           10 rep-msg-pntr             usage pointer.
003900           10 rep-msg-lenf             pic s9(08) comp.
003902           10 rep-msg-hdr-lenf         pic s9(08) comp.
003904           10 rep-fmt-hdr-lenf         pic s9(08) comp.
003906           10 rep-ebiz-hdr-lenf        pic s9(08) comp.
003908           10 rep-ebiz-data-full-lenf  pic s9(08) comp.
003910           10 rep-ebiz-data-used-lenf  pic s9(08) comp.
003912           10 rep-msg-total-full-lenf  pic s9(08) comp.
003914           10 rep-msg-total-used-lenf  pic s9(08) comp.
003916           10 rep-msg-mq.
003918              15 rep-qmgr-name         pic x(48).
003920              15 rep-qname             pic x(48).
003922              15 rep-queue-nbr         pic x(04).
003924              15 rep-expiry            pic s9(08) comp.
003926              15 rep-wait-interval     pic s9(08) comp.
003928              15 rep-persistent        pic x(04).
003930              15 rep-msgid             pic x(24).
003932              15 rep-correlid          pic x(24).
003934           10 filler                   pic x(04).
003936        05 to-upgm-fields.
003938*          176 bytes in this group
003940*          Next field should start on a fullword boundary
003942           10 to-upgm-bfr-pntr         usage pointer.
003944           10 to-upgm-bfr-full-lenf    pic s9(08) comp.
003946           10 to-upgm-bfr-used-lenf    pic s9(08) comp.
003948           10 to-upgm-mq.
003950              15 to-upgm-qmgr-name     pic x(48).
003952              15 to-upgm-qname         pic x(48).
003954              15 to-upgm-queue-nbr     pic x(04).
003956              15 to-upgm-expiry        pic s9(08) comp.
003958              15 to-upgm-wait-interval pic s9(08) comp.
003960              15 to-upgm-persistent    pic x(04).
003962              15 to-upgm-msgid         pic x(24).
003964              15 to-upgm-correlid      pic x(24).
003966           10 filler                   pic x(04).
003968        05 from-upgm-fields.
003970*          272 bytes in this group
003972*          Next field should start on a fullword boundary
003974           10 from-upgm-bfr-pntr       usage pointer.
003976           10 from-upgm-bfr-full-lenf  pic s9(08) comp.
003978           10 from-upgm-bfr-used-lenf  pic s9(08) comp.
003980           10 from-upgm-mq.
003982              15 from-upgm-qmgr-name   pic x(48).
003984              15 from-upgm-qname       pic x(48).
003986              15 from-upgm-queue-nbr   pic x(04).
003988              15 from-upgm-expiry      pic s9(08) comp.
003990              15 from-upgm-wait-interval
003992                                       pic s9(08) comp.
003994              15 from-upgm-persistent  pic x(04).
003996              15 from-upgm-msgid       pic x(24).
003998              15 from-upgm-correlid    pic x(24).
004000           10 from-upgm-fields-aux.
004002              15 from-upgm-processing-mode
004004                                       pic x(04).
004006                 88 from-upgm-mode-is-normal-88  value spaces.
004008                 88 from-upgm-mode-is-error-88   value 'erro'.
004010              15 from-upgm-abend-program
004012                                       pic x(04).
004014              15 from-upgm-abend-code  pic x(04).
004016              15 from-upgm-return-code pic 9(04).
004018              15 from-upgm-reason      pic x(04).
004020              15 from-upgm-msg         pic x(80).
004022
004024 01  lk-trif-t.
004026     05 trif.
004028*       316 bytes in this group
004030        10 amb-tp-header.
004032*           40 bytes in this group
004034           15 amb-tp-invocation-mode   pic x(01).
004036              88 amb-tp-transid-invoked      value 'T'.
004038              88 amb-tp-program-invoked      value 'P'.
004040              88 amb-tp-screen-invoked       value 'S'.
004042              88 amb-tp-link-invoked         value 'L'.
004044              88 amb-tp-largedata-invoked    value 'D'.
004046           15 amb-tp-psb-scheduled-mode
004048                                       pic x(01).
004050           15 amb-tp-addr-count        pic s9(04) comp.
004052           15 amb-tp-calling-program-id
004054                                       pic x(08).
004056           15 amb-tp-filler-28         pic x(28).
004058*       Start of fields associated with tp-user-len
004060*       Next field should start on a fullword boundary
004062        10 trif-fields.
004064*          64 bytes in this group
004066           15 this-pntr                usage pointer.
004068           15 strucid                  pic x(04).
004070           15 version                  pic s9(09) comp.
004072           15 struclen                 pic s9(09) comp.
004074           15 ebiz-name                pic x(08).
004076           15 upgm-name                pic x(08).
004078           15 useridx                  pic x(08).
004080           15 trace-level              pic 9(01).
004082           15 trace-level-unused       pic x(03).
004084           15 trace-queue-name         pic x(16).
004086           15 copybook-mode            pic x(04).
004088              88 copybook-mode-is-unk-88     value 'unk '.
004090              88 copybook-mode-is-sam-88     value 'sam '.
004092              88 copybook-mode-is-sep-88     value 'sep '.
004094              88 copybook-mode-is-amb-88     value 'amb '.
004096        10 to-upgm-fields.
004098*           12 bytes in this group
004100*           Next field should start on a fullword boundary
004102           15 to-upgm-bfr-pntr         usage pointer.
004104           15 to-upgm-bfr-full-lenf    pic s9(08) comp.
004106*    *************************************************************
004108*    if the input record in the ebiz program contains
004110*    occurs depending on clauses the to-upgm-bfr-used-lenf
004112*    will be <= to-upgm-bfr-full-lenf based on the current
004114*    size of this record in the ebiz program
004116*    *************************************************************
004118           15 to-upgm-bfr-used-lenf    pic s9(08) comp.
004120              10 from-upgm-fields.
004122*           12 bytes in this group
004124*           Next field should start on a fullword boundary
004126           15 from-upgm-bfr-pntr       usage pointer.
004128           15 from-upgm-bfr-full-lenf  pic s9(08) comp.
004130*    *************************************************************
004132*    if the output record in the user program contains
004134*    occurs depending on clauses the from-upgm-bfr-used-lenf
004136*    will be <= from-upgm-bfr-full-lenf based on the current
004138*    size of this record in the ebiz program
004140*    *************************************************************
004142           15 from-upgm-bfr-used-lenf  pic s9(08) comp.
004144        10 from-upgm-fields-aux.
004146*          108 bytes in this group
004148           15 from-upgm-processing-mode
004150                                       pic x(04).
004152              88 from-upgm-mode-is-normal-88 value spaces.
004154              88 from-upgm-mode-is-error-88  value 'erro'.
004156           15 from-upgm-abend-code     pic x(04).
004158           15 from-upgm-abend-program  pic x(08).
004160           15 from-upgm-return-code    pic 9(04).
004162           15 from-upgm-reason         pic x(04).
004164           15 from-upgm-msg            pic x(80).
004166           15 filler                   pic x(04).
004168* End of fields associated with tp-user-len
004170        10 amb-tp-trailer.
004172*          80 bytes in this group
004174           15 amb-tp-addr-table.
004176              20 amb-tp-addr           usage is pointer
004178                                       occurs 20 times.
004180
004182 PROCEDURE DIVISION.
004184 
004186 000-mq03-main section.
004188     if ws-mf-ti-trace-level >= 1
004190       move 71 to ws-mf-ti-msg-nbr
004192       move '000-mq03-main' to ws-mf-ti-data-rec(1:13)
004194       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
004196       move 13 to ws-mf-ti-user-data-len
004198       perform mf-ti-write
004200     end-if
004202     if eibcalen =   2000
004204       and dfhcommarea (1:ws-footprint-header-len) = 'footprint re
004206-          'quest'
004208       perform ebiz-footprint-request-check
004210     end-if
004212     perform 100-nwif-setup
004214     perform 120-trif-setup
004216     perform 200-trace-setup
004218     perform 300-general-setup
004220     perform 400-getmain-to-upgm-bfr
004222     perform 500-populate-trif-from-nwif
004224     perform 600-mqopen-to-upgm-queue
004226     perform 700-mqget-to-upgm-bfr
004228     perform 800-mqclose-to-upgm-queue
004230     perform 900-link-to-user-program
004232     perform 1000-freemain-to-upgm-bfr
004234     perform 1200-mqput1-upgm-out-bfr
004236     perform 1300-freemain-from-upgm-bfr
004238     perform 9000-return-goback
004240     exit
004242     .
004244 
004246 100-nwif-setup section.
004248     if ws-mf-ti-trace-level >= 1
004250       move 71 to ws-mf-ti-msg-nbr
004252       move '100-nwif-setup' to ws-mf-ti-data-rec(1:14)
004254       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
004256       move 14 to ws-mf-ti-user-data-len
004258       perform mf-ti-write
004260     end-if
004262     if eibcalen
004264        = length                       of lk-nwif
004266        and dfhcommarea(5:4)
004268        = ws-nwif-strucid              of ws-static-fields
004270       set  address                    of lk-nwif
004272         to address                    of dfhcommarea
004274       set  address                    of lk-nwif-t
004276         to address                    of lk-nwif
004278       perform 200-trace-setup
004280       if ws-mf-ti-trace-level >= 4
004282         move ws-footprint
004284           to footprint-data           of ws-footprint-t
004286         set  ws-mf-ti-user-data-pntr  of ws-mf-ti-record
004288           to address                  of ws-footprint-t
004290         move seventy-five             of ws-static-fields
004292           to ws-mf-ti-msg-nbr         of ws-mf-ti-record
004294         move length                   of ws-footprint-t
004296           to ws-mf-ti-user-data-len   of ws-mf-ti-record
004298         perform 7000-footprint-trace
004300         perform 7000-nwif-trace
004302       end-if
004304     else
004306       move spaces
004308         to ws-mf-ti-data-rec-r
004310       string
004312         invalid-dfhcommarea-msg       of ws-static-fields
004314         ws-this-program               of ws-static-fields
004316         delimited by size
004318         into ws-mf-ti-data-rec-data-r of ws-mf-ti-data-rec-r
004320       exec cics writeq ts
004322         queue    ( ws-default-traceq  of ws-static-fields    )
004324         from     ( ws-mf-ti-data-rec-r                       )
004326         length   ( length             of ws-mf-ti-data-rec-r )
004328         nohandle
004330       end-exec
004332       move dfhcommarea (1:eibcalen)
004334         to ws-mf-ti-data-rec-data-r   of ws-mf-ti-data-rec-r
004336       exec cics writeq ts
004338         queue    ( ws-default-traceq  of ws-static-fields    )
004340         from     ( ws-mf-ti-data-rec-r                       )
004342         length   ( length             of ws-mf-ti-data-rec-r )
004344         nohandle
004346       end-exec
004348       perform 9000-return-goback
004350     end-if
004352     exit
004354     .
004356 
004358 120-trif-setup section.
004360     if ws-mf-ti-trace-level >= 1
004362       move 71 to ws-mf-ti-msg-nbr
004364       move '120-trif-setup' to ws-mf-ti-data-rec(1:14)
004366       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
004368       move 14 to ws-mf-ti-user-data-len
004370       perform mf-ti-write
004372     end-if
004374     set  address                      of lk-trif
004376       to address                      of ws-trif
004378     set  address                      of lk-trif-t
004380       to address                      of lk-trif
004382     initialize lk-trif
004384     set  this-pntr                    of lk-trif
004386       to null
004388     set  to-upgm-bfr-pntr             of lk-trif
004390       to null
004392     set  from-upgm-bfr-pntr           of lk-trif
004394       to null
004396     perform varying offset-4          of ws-offset-fields
004398       from 1 by 1
004400       until         offset-4          of ws-offset-fields
004402         > 20
004404       set  amb-tp-addr                of lk-trif
004406                    (offset-4          of ws-offset-fields)
004408         to null
004410     end-perform
004412     exit
004414     .
004416 
004418 200-trace-setup section.
004420     if ws-mf-ti-trace-level >= 1
004422       move 71 to ws-mf-ti-msg-nbr
004424       move '200-trace-setup' to ws-mf-ti-data-rec(1:15)
004426       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
004428       move 15 to ws-mf-ti-user-data-len
004430       perform mf-ti-write
004432     end-if
004434     move trace-level                  of lk-nwif
004436       to mq03-trace-level             of ws-mq03-trace-misc
004438          ws-mf-ti-trace-level         of ws-mf-ti-record
004440     move trace-queue-name             of lk-nwif
004442       to mq03-trace-queue-name        of ws-mq03-trace-misc
004444          ws-mf-ti-queue-name-long     of ws-mf-ti-record
004446     perform mf-ti-setup
004448     exit
004450     .
004452 
004454 300-general-setup section.
004456     if ws-mf-ti-trace-level >= 1
004458       move 71 to ws-mf-ti-msg-nbr
004460       move '300-general-setup' to ws-mf-ti-data-rec(1:17)
004462       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
004464       move 17 to ws-mf-ti-user-data-len
004466       perform mf-ti-write
004468     end-if
004470     initialize ws-mqclose-misc
004472     initialize ws-mqget-misc
004474     initialize ws-mqopen-misc
004476     initialize ws-mqput1-misc
004478     exit
004480     .
004482 
004484 400-getmain-to-upgm-bfr section.
004486     if ws-mf-ti-trace-level >= 1
004488       move 71 to ws-mf-ti-msg-nbr
004490       move '400-getmain-to-upgm-bfr' to ws-mf-ti-data-rec(1:23)
004492       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
004494       move 23 to ws-mf-ti-user-data-len
004496       perform mf-ti-write
004498     end-if
004500     set  keep-trying-getmain-88       of ws-getmain-misc
004502       to true
004504     move zero
004506       to getmain-trys-cntr            of ws-getmain-misc
004508     move 'lk-to-upgm-bfr'
004510       to getmain-set                  of ws-getmain-misc
004512     set  getmain-pntr                 of ws-getmain-misc
004514       to null
004516     move to-upgm-bfr-used-lenf        of lk-nwif
004518       to getmain-flength              of ws-getmain-misc
004520     if ws-mf-ti-trace-level >= 4
004522       move spaces
004524         to textx                      of ws-info-t
004526       move to-upgm-bfr-full-lenf      of lk-nwif
004528         to info-len-1                 of ws-info-misc
004530       string
004532         'to-upgm-bfr-full-lenf '
004534          info-len-1                   of ws-info-misc
004536          delimited by size
004538          into textx                   of ws-info-t
004540       end-string
004542       perform 7000-info-trace
004544       move spaces
004546         to textx                      of ws-info-t
004548       move to-upgm-bfr-used-lenf      of lk-nwif
004550         to info-len-1                 of ws-info-misc
004552       string
004554         'to-upgm-bfr-used-lenf '
004556          info-len-1                   of ws-info-misc
004558          delimited by size
004560          into textx                   of ws-info-t
004562       end-string
004564       perform 7000-info-trace
004566       move spaces
004568         to textx                      of ws-info-t
004570       move getmain-flength            of ws-getmain-misc
004572         to info-len-1                 of ws-info-misc
004574       string
004576         'getmain-flength '
004578          info-len-1                   of ws-info-misc
004580          delimited by size
004582          into textx                   of ws-info-t
004584       end-string
004586       perform 7000-info-trace
004588     end-if
004590     perform with test before
004592       until stop-trying-getmain-88    of ws-getmain-misc
004594       set  getmain-before-88
004596         to true
004598       add 1
004600         to getmain-trys-cntr          of ws-getmain-misc
004602       set  getmain-before-88
004604         to true
004606       move zero
004608         to getmain-resp               of ws-getmain-misc
004610       move zero
004612         to getmain-resp2              of ws-getmain-misc
004614       if ws-mf-ti-trace-level >= 4
004616         perform 7000-getmain-trace
004618       end-if
004620       exec cics getmain
004622         resp     ( getmain-resp       of ws-getmain-misc )
004624         resp2    ( getmain-resp2      of ws-getmain-misc )
004626         set      ( address            of lk-to-upgm-bfr  )
004628         flength  ( getmain-flength    of ws-getmain-misc )
004630         nohandle
004632       end-exec
004634       set  getmain-after-88
004636         to true
004638       if getmain-resp                 of ws-getmain-misc
004640         = dfhresp ( normal )
004642         set getmain-pntr              of ws-getmain-misc
004644           to address                  of lk-to-upgm-bfr
004646       end-if
004648       evaluate true
004650         when getmain-resp             of ws-getmain-misc
004652           = dfhresp ( normal )
004654           set  stop-trying-getmain-88 of ws-getmain-misc
004656             to true
004658           set  getmain-pntr           of ws-getmain-misc
004660             to address                of lk-to-upgm-bfr
004662         when getmain-resp             of ws-getmain-misc
004664           = dfhresp ( lengerr )
004666           set  stop-trying-getmain-88 of ws-getmain-misc
004668             to true
004670           move ws-this-program        of ws-static-fields
004672             to mf-abend-program       of lk-nwif
004674           move getmain-to-lengerr     of ws-mq03-abends
004676             to mf-abend-code          of lk-nwif
004678           perform 8000-getmain-error
004680         when getmain-resp             of ws-getmain-misc
004682           = dfhresp ( nostg )
004684           if getmain-trys-cntr        of ws-getmain-misc
004686             > ws-getmain-trys-max
004688             set  stop-trying-getmain-88
004690                                       of ws-getmain-misc
004692               to true
004694             set  getmain-error-88
004696               to true
004698             move ws-this-program      of ws-static-fields
004700               to mf-abend-program     of lk-nwif
004702             move getmain-to-nostg     of ws-mq03-abends
004704               to mf-abend-code        of lk-nwif
004706             perform 8000-getmain-error
004708           end-if
004710       end-evaluate
004712       if ws-mf-ti-trace-level >= 4
004714         perform 7000-getmain-trace
004716       end-if
004718     end-perform
004720     exit
004722     .
004724 
004726 500-populate-trif-from-nwif section.
004728     if ws-mf-ti-trace-level >= 1
004730       move 71 to ws-mf-ti-msg-nbr
004732       move '500-populate-trif-from-nwif' to 
004734           ws-mf-ti-data-rec(1:27)
004736       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
004738       move 27 to ws-mf-ti-user-data-len
004740       perform mf-ti-write
004742     end-if
004744     set amb-tp-largedata-invoked      of lk-trif
004746       to true
004748     move  ebiz-name                   of lk-nwif
004750       to amb-tp-calling-program-id    of lk-trif
004752     set  this-pntr                    of ws-trif
004754       to address                      of ws-trif
004756     move ws-trif-strucid              of ws-static-fields
004758       to strucid                      of ws-trif
004760     move 1
004762       to version                      of ws-trif
004764     move length                       of ws-trif
004766       to struclen                     of ws-trif
004768     move ebiz-name                    of lk-nwif
004770       to ebiz-name                    of ws-trif
004772     move upgm-name                    of lk-nwif
004774       to upgm-name                    of ws-trif
004776     move useridx                      of lk-nwif
004778       to useridx                      of ws-trif
004780     move trace-level                  of lk-nwif
004782       to trace-level                  of ws-trif
004784     move trace-queue-name             of lk-nwif
004786       to trace-queue-name             of ws-trif
004788     set  to-upgm-bfr-pntr             of ws-trif
004790       to address                      of lk-to-upgm-bfr
004792     move to-upgm-bfr-full-lenf        of lk-nwif
004794       to to-upgm-bfr-full-lenf        of ws-trif
004796     move to-upgm-bfr-used-lenf        of lk-nwif
004798       to to-upgm-bfr-used-lenf        of ws-trif
004800     move from-upgm-bfr-full-lenf      of lk-nwif
004802       to from-upgm-bfr-full-lenf      of ws-trif
004804     if ws-mf-ti-trace-level >= 4
004806       perform 7000-trif-trace
004808     end-if
004810     exit
004812     .
004814 
004816 600-mqopen-to-upgm-queue section.
004818     if ws-mf-ti-trace-level >= 1
004820       move 71 to ws-mf-ti-msg-nbr
004822       move '600-mqopen-to-upgm-queue' to ws-mf-ti-data-rec(1:24)
004824       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
004826       move 24 to ws-mf-ti-user-data-len
004828       perform mf-ti-write
004830     end-if
004832     move zero
004834       to mqopen-hconn                 of ws-mqopen-misc
004836     move from-upgm-qname              of lk-nwif
004838       to mqmd-replytoq                of ws-cmqmdv-copybook
004840     move mqot-q                       of ws-cmqv-copybook
004842       to mqod-objecttype              of ws-cmqodv-copybook
004844     move to-upgm-qname                of lk-nwif
004846       to mqod-objectname              of ws-cmqodv-copybook
004848     compute mqopen-options            of ws-mqopen-misc
004850       = mqoo-input-shared             of ws-cmqv-copybook
004852       + mqoo-fail-if-quiescing        of ws-cmqv-copybook
004854     set  mqopen-before-88             of ws-mqopen-t
004856       to true
004858     move mqcc-ok                      of ws-cmqv-copybook
004860       to mqopen-comp-code             of ws-mqopen-misc
004862     move mqcc-ok                      of ws-cmqv-copybook
004864       to mqopen-reason                of ws-mqopen-misc
004866     if ws-mf-ti-trace-level >= 4
004868       perform 7000-cmqodv-trace
004870       perform 7000-mqopen-trace
004872     end-if
004874     call 'mqopen'
004876       using mqopen-hconn              of ws-mqopen-misc
004878             mqod                      of ws-cmqodv-copybook
004880             mqopen-options            of ws-mqopen-misc
004882             mqopen-q-handle           of ws-mqopen-misc
004884             mqopen-comp-code          of ws-mqopen-misc
004886             mqopen-reason             of ws-mqopen-misc
004888     end-call
004890     set  mqopen-after-88              of ws-mqopen-t
004892       to true
004894     if mqopen-comp-code               of ws-mqopen-misc
004896       not = mqcc-ok                   of ws-cmqv-copybook
004898       move ws-this-program            of ws-static-fields
004900         to mf-abend-program           of lk-nwif
004902       move mqopen-failure             of ws-mq03-abends
004904         to mf-abend-code              of lk-nwif
004906       perform 8000-mqopen-error
004908     else
004910       continue
004912     end-if
004914     if ws-mf-ti-trace-level >= 4
004916       perform 7000-mqopen-trace
004918     end-if
004920      move mqopen-q-handle             of ws-mqopen-misc
004922       to mqget-q-handle               of ws-mqget-misc
004924          mqclose-q-handle             of ws-mqclose-misc
004926     exit
004928     .
004930 
004932 700-mqget-to-upgm-bfr section.
004934     if ws-mf-ti-trace-level >= 1
004936       move 71 to ws-mf-ti-msg-nbr
004938       move '700-mqget-to-upgm-bfr' to ws-mf-ti-data-rec(1:21)
004940       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
004942       move 21 to ws-mf-ti-user-data-len
004944       perform mf-ti-write
004946     end-if
004948     move to-upgm-bfr-used-lenf        of lk-nwif
004950       to mqget-buffer-lenf            of ws-mqget-misc
004952     move to-upgm-msgid                of lk-nwif
004954       to mqmd-msgid                   of ws-cmqmdv-copybook
004956     move to-upgm-correlid             of lk-nwif
004958       to mqmd-correlid                of ws-cmqmdv-copybook
004960     move to-upgm-wait-interval        of lk-nwif
004962       to mqgmo-waitinterval           of ws-cmqgmov-copybook
004964     if ws-mf-ti-trace-level >= 4
004966       move spaces
004968         to textx                      of ws-info-t
004970       move to-upgm-wait-interval      of lk-nwif
004972         to info-len-1                 of ws-info-misc
004974       string
004976         waitinterval-msg              of ws-static-fields
004978         info-len-1                    of ws-info-misc
004980         delimited by size
004982         into textx                    of ws-info-t
004984       end-string
004986       perform 7000-info-trace
004988     end-if
004990     move to-upgm-msgid                of lk-nwif
004992       to mqmd-msgid                   of ws-cmqmdv-copybook
004994     move to-upgm-correlid             of lk-nwif
004996       to mqmd-correlid                of ws-cmqmdv-copybook
004998     compute mqgmo-matchoptions        of ws-cmqgmov-copybook
005000       = mqmo-match-msg-id             of ws-cmqv-copybook
005002       + mqmo-match-correl-id          of ws-cmqv-copybook
005004     set  mqget-before-88              of ws-mqget-t
005006       to true
005008     move mqcc-ok                      of ws-cmqv-copybook
005010       to mqget-comp-code              of ws-mqget-misc
005012     move mqcc-ok                      of ws-cmqv-copybook
005014       to mqget-reason                 of ws-mqget-misc
005016     if ws-mf-ti-trace-level >= 4
005018       perform 7000-cmqmdv-trace
005020       perform 7000-cmqgmov-trace
005022       perform 7000-mqget-trace
005024     end-if
005026     call 'mqget'
005028       using mqget-hconn               of ws-mqget-misc
005030             mqget-q-handle            of ws-mqget-misc
005032             mqmd                      of ws-cmqmdv-copybook
005034             mqgmo                     of ws-cmqgmov-copybook
005036             mqget-buffer-lenf         of ws-mqget-misc
005038             lk-to-upgm-bfr
005040             mqget-data-lenf           of ws-mqget-misc
005042             mqget-comp-code           of ws-mqget-misc
005044             mqget-reason              of ws-mqget-misc
005046     end-call
005048     set  mqget-after-88               of ws-mqget-t
005050       to true
005052     evaluate true
005054       when mqget-comp-code            of ws-mqget-misc
005056         = mqcc-ok                     of ws-cmqv-copybook
005058         continue
005060       when other
005062         set  mqget-error-88           of ws-mqget-t
005064           to true
005066         move mqget-failure            of ws-mq03-abends
005068           to mf-abend-code            of lk-nwif
005070         perform 8000-mqget-error
005072     end-evaluate
005074     if ws-mf-ti-trace-level >= 4
005076       perform 7000-mqget-trace
005078       perform 7000-cmqmdv-trace
005080       perform 7000-cmqgmov-trace
005082     end-if
005084     if ws-mf-ti-trace-level >= 4
005086       perform 7000-to-upgm-bfr-trace
005088     end-if
005090     exit
005092     .
005094 
005096 800-mqclose-to-upgm-queue section.
005098     if ws-mf-ti-trace-level >= 1
005100       move 71 to ws-mf-ti-msg-nbr
005102       move '800-mqclose-to-upgm-queue' to ws-mf-ti-data-rec(1:25)
005104       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
005106       move 25 to ws-mf-ti-user-data-len
005108       perform mf-ti-write
005110     end-if
005112     set  mqclose-before-88            of ws-mqclose-t
005114       to true
005116     move mqcc-ok                      of ws-cmqv-copybook
005118       to mqclose-comp-code            of ws-mqclose-misc
005120     move mqcc-ok                      of ws-cmqv-copybook
005122       to mqclose-reason               of ws-mqclose-misc
005124     if ws-mf-ti-trace-level >= 4
005126       perform 7000-mqclose-trace
005128     end-if
005130     call 'mqclose'
005132       using mqclose-hconn             of ws-mqclose-misc
005134             mqclose-q-handle          of ws-mqclose-misc
005136             mqco-none                 of ws-cmqv-copybook
005138             mqclose-comp-code         of ws-mqclose-misc
005140             mqclose-reason            of ws-mqclose-misc
005142     end-call
005144     set  mqclose-after-88             of ws-mqclose-t
005146       to true
005148     if mqclose-comp-code              of ws-mqclose-misc
005150       not = mqcc-ok                   of ws-cmqv-copybook
005152       move mqclose-failure            of ws-mq03-abends
005154         to mf-abend-code              of lk-nwif
005156       perform 8000-mqclose-error
005158     else
005160       continue
005162     end-if
005164     if ws-mf-ti-trace-level >= 4
005166       perform 7000-mqclose-trace
005168     end-if
005170     exit
005172     .
005174 
005176 900-link-to-user-program section.
005178     if ws-mf-ti-trace-level >= 1
005180       move 71 to ws-mf-ti-msg-nbr
005182       move '900-link-to-user-program' to ws-mf-ti-data-rec(1:24)
005184       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
005186       move 24 to ws-mf-ti-user-data-len
005188       perform mf-ti-write
005190     end-if
005192     if ws-mf-ti-trace-level >= 4
005194       perform 7000-to-upgm-bfr-trace
005196       perform 7000-trif-trace
005198     end-if
005200     set  link-before-88
005202       to true
005204     move zero
005206       to link-resp                    of ws-link-misc
005208     move zero
005210       to link-resp2                   of ws-link-misc
005212     move upgm-name                    of lk-nwif
005214       to link-program                 of ws-link-misc
005216     move length                       of ws-trif
005218       to link-length                  of ws-link-misc
005220     move 'ws-trif'
005222       to link-commarea                of ws-link-misc
005224     if ws-mf-ti-trace-level >= 4
005226       perform 7000-to-upgm-bfr-trace
005228     end-if
005230     if ws-mf-ti-trace-level >= 4
005232       perform 7000-link-trace
005234     end-if
005236     exec cics link
005238       resp     ( link-resp            of ws-link-misc )
005240       resp2    ( link-resp2           of ws-link-misc )
005242       program  ( link-program         of ws-link-misc )
005244       length   ( link-length          of ws-link-misc )
005246       commarea ( ws-trif                              )
005248       nohandle
005250     end-exec
005252     set  link-after-88
005254       to true
005256     if link-resp                      of ws-link-misc
005258       = dfhresp ( normal )
005260       continue
005262     else
005264       set  link-error-88
005266         to true
005268       move link-failure               of ws-mq03-abends
005270         to mf-abend-code              of lk-nwif
005272       perform 8000-link-error
005274     end-if
005276     if ws-mf-ti-trace-level >= 4
005278       perform 7000-link-trace
005280     end-if
005282     if ws-mf-ti-trace-level >= 4
005284       perform 7000-trif-trace
005286     end-if
005288     perform user-issue-check
005290     set  address                      of lk-from-upgm-bfr
005292       to from-upgm-bfr-pntr           of lk-trif
005294     perform 1400-update-nwif
005296     if ws-mf-ti-trace-level >= 4
005298       perform 7000-from-upgm-bfr-trace
005300     end-if
005302     exit
005304     .
005306 
005308 user-issue-check section.
005310     if ws-mf-ti-trace-level >= 1
005312       move 71 to ws-mf-ti-msg-nbr
005314       move 'user-issue-check' to ws-mf-ti-data-rec(1:16)
005316       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
005318       move 16 to ws-mf-ti-user-data-len
005320       perform mf-ti-write
005322     end-if
005324     move from-upgm-processing-mode    of ws-trif
005326       to from-upgm-processing-mode    of lk-nwif
005328     move from-upgm-abend-code         of ws-trif
005330       to from-upgm-abend-code         of lk-nwif
005332     move from-upgm-abend-program      of ws-trif
005334       to from-upgm-abend-program      of lk-nwif
005336     move from-upgm-return-code        of ws-trif
005338       to from-upgm-return-code        of lk-nwif
005340     move from-upgm-reason             of ws-trif
005342       to from-upgm-reason             of lk-nwif
005344     move from-upgm-msg                of ws-trif
005346       to from-upgm-msg                of lk-nwif
005348     if from-upgm-abend-code           of lk-nwif
005350       > spaces
005352       perform process-user-issue
005354     end-if
005356     exit
005358     .
005360 
005362 process-user-issue section.
005364     if ws-mf-ti-trace-level >= 1
005366       move 71 to ws-mf-ti-msg-nbr
005368       move 'process-user-issue' to ws-mf-ti-data-rec(1:18)
005370       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
005372       move 18 to ws-mf-ti-user-data-len
005374       perform mf-ti-write
005376     end-if
005378     exit
005380     .
005382 
005384 1000-freemain-to-upgm-bfr section.
005386     if ws-mf-ti-trace-level >= 1
005388       move 71 to ws-mf-ti-msg-nbr
005390       move '1000-freemain-to-upgm-bfr' to ws-mf-ti-data-rec(1:25)
005392       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
005394       move 25 to ws-mf-ti-user-data-len
005396       perform mf-ti-write
005398     end-if
005400     set  freemain-before-88
005402       to true
005404     move 'lk-to-upgm-bfr'
005406       to freemain-data                of ws-freemain-misc
005408     if ws-mf-ti-trace-level >= 4
005410       perform 7000-freemain-trace
005412     end-if
005414     exec cics freemain
005416       resp     ( freemain-resp        of ws-freemain-misc )
005418       resp2    ( freemain-resp2       of ws-freemain-misc )
005420       data     ( lk-to-upgm-bfr                           )
005422       nohandle
005424     end-exec
005426     set  freemain-after-88
005428       to true
005430     if freemain-resp                  of ws-freemain-misc
005432       = dfhresp ( normal )
005434       continue
005436     else
005438       perform 8000-freemain-error
005440     end-if
005442     if ws-mf-ti-trace-level >= 4
005444       perform 7000-freemain-trace
005446     end-if
005448     exit
005450     .
005452 
005454 1200-mqput1-upgm-out-bfr section.
005456     if ws-mf-ti-trace-level >= 1
005458       move 71 to ws-mf-ti-msg-nbr
005460       move '1200-mqput1-upgm-out-bfr' to ws-mf-ti-data-rec(1:24)
005462       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
005464       move 24 to ws-mf-ti-user-data-len
005466       perform mf-ti-write
005468     end-if
005470     set  address                      of lk-from-upgm-bfr
005472       to from-upgm-bfr-pntr           of lk-trif
005474     if ws-mf-ti-trace-level >= 4
005476       perform 7000-trif-trace
005478       perform 7000-nwif-trace
005480       perform 7000-from-upgm-bfr-trace
005482     end-if
005484     move from-upgm-bfr-used-lenf      of lk-nwif
005486       to mqput1-buffer-lenf           of ws-mqput1-misc
005488     move mqhc-def-hconn               of ws-cmqv-copybook
005490       to mqput1-hconn                 of ws-mqput1-misc
005492     move from-upgm-qname              of lk-nwif
005494       to mqod-objectname              of ws-cmqodv-copybook
005496     move from-upgm-qname              of lk-nwif
005498       to mqmd-replytoq                of ws-cmqmdv-copybook
005500     move mqfmt-none                   of ws-cmqv-copybook
005502       to mqmd-format                  of ws-cmqmdv-copybook
005504     move mqci-none                    of ws-cmqv-copybook
005506       to mqmd-correlid                of ws-cmqmdv-copybook
005508     move mqmi-none                    of ws-cmqv-copybook
005510       to mqmd-msgid                   of ws-cmqmdv-copybook
005512     if from-upgm-persistent           of lk-nwif
005514       = '1'
005516       if ws-mf-ti-trace-level >= 4
005518         move persistent-msg           of ws-static-fields
005520           to textx                    of ws-info-t
005522         perform 7000-info-trace
005524       end-if
005526       move mqper-persistent           of ws-cmqv-copybook
005528         to mqmd-persistence           of ws-cmqmdv-copybook
005530     else
005532       if ws-mf-ti-trace-level >= 4
005534         move non-persistent-msg       of ws-static-fields
005536           to textx                    of ws-info-t
005538         perform 7000-info-trace
005540       end-if
005542       move mqper-not-persistent       of ws-cmqv-copybook
005544         to mqmd-persistence           of ws-cmqmdv-copybook
005546     end-if
005548     move from-upgm-expiry             of lk-nwif
005550       to mqmd-expiry                  of ws-cmqmdv-copybook
005552     compute mqpmo-options             of ws-cmqpmov-copybook
005554       = mqpmo-new-correl-id           of ws-cmqv-copybook
005556       + mqpmo-new-msg-id              of ws-cmqv-copybook
005558       + mqpmo-no-syncpoint            of ws-cmqv-copybook
005560     set  mqput1-before-88             of ws-mqput1-t
005562       to true
005564     move mqcc-ok                      of ws-cmqv-copybook
005566       to mqput1-comp-code             of ws-mqput1-misc
005568     move mqcc-ok                      of ws-cmqv-copybook
005570       to mqput1-reason                of ws-mqput1-misc
005572     if ws-mf-ti-trace-level >= 4
005574       perform 7000-cmqodv-trace
005576       perform 7000-cmqmdv-trace
005578       perform 7000-cmqpmol-trace
005580       perform 7000-mqput1-trace
005582     end-if
005584     call 'mqput1'
005586       using mqput1-hconn              of ws-mqput1-misc
005588             mqod                      of ws-cmqodv-copybook
005590             mqmd                      of ws-cmqmdv-copybook
005592             mqpmo                     of ws-cmqpmov-copybook
005594             mqput1-buffer-lenf        of ws-mqput1-misc
005596             lk-from-upgm-bfr
005598             mqput1-comp-code          of ws-mqput1-misc
005600             mqput1-reason             of ws-mqput1-misc
005602     end-call
005604     set  mqput1-after-88              of ws-mqput1-t
005606       to true
005608     evaluate true
005610       when mqput1-comp-code           of ws-mqput1-misc
005612         = mqcc-ok                     of ws-cmqv-copybook
005614         continue
005616       when other
005618         set  mqput1-error-88          of ws-mqput1-t
005620           to true
005622         move mqput1-failure           of ws-mq03-abends
005624           to mf-abend-code            of lk-nwif
005626         perform 8000-mqput1-error
005628     end-evaluate
005630     if ws-mf-ti-trace-level >= 4
005632       perform 7000-mqput1-trace
005634       perform 7000-cmqodv-trace
005636       perform 7000-cmqmdv-trace
005638       perform 7000-cmqpmol-trace
005640     end-if
005642     move mqmd-correlid                of ws-cmqmdv-copybook
005644       to from-upgm-correlid           of lk-nwif
005646     move mqmd-msgid                   of ws-cmqmdv-copybook
005648       to from-upgm-msgid              of lk-nwif
005650     exit
005652     .
005654 
005656 1300-freemain-from-upgm-bfr section.
005658     if ws-mf-ti-trace-level >= 1
005660       move 71 to ws-mf-ti-msg-nbr
005662       move '1300-freemain-from-upgm-bfr' to 
005664           ws-mf-ti-data-rec(1:27)
005666       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
005668       move 27 to ws-mf-ti-user-data-len
005670       perform mf-ti-write
005672     end-if
005674     set  freemain-before-88
005676       to true
005678     move 'lk-from-upgm-bfr'
005680       to freemain-data                of ws-freemain-misc
005682     perform 7000-freemain-trace
005684     exec cics freemain
005686       resp     ( freemain-resp        of ws-freemain-misc )
005688       resp2    ( freemain-resp2       of ws-freemain-misc )
005690       data     ( lk-from-upgm-bfr                         )
005692       nohandle
005694     end-exec
005696     set  freemain-after-88
005698       to true
005700     perform 7000-freemain-trace
005702     exit
005704     .
005706 
005708 1400-update-nwif section.
005710     if ws-mf-ti-trace-level >= 1
005712       move 71 to ws-mf-ti-msg-nbr
005714       move '1400-update-nwif' to ws-mf-ti-data-rec(1:16)
005716       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
005718       move 16 to ws-mf-ti-user-data-len
005720       perform mf-ti-write
005722     end-if
005724     set  to-upgm-bfr-pntr             of lk-nwif
005726       to to-upgm-bfr-pntr             of lk-trif
005728     set  from-upgm-bfr-pntr           of lk-nwif
005730       to from-upgm-bfr-pntr           of lk-trif
005732     move from-upgm-bfr-full-lenf      of lk-trif
005734       to from-upgm-bfr-full-lenf      of lk-nwif
005736     move from-upgm-bfr-used-lenf      of lk-trif
005738       to from-upgm-bfr-used-lenf      of lk-nwif
005740     move from-upgm-processing-mode    of lk-trif
005742       to from-upgm-processing-mode    of lk-nwif
005744     move from-upgm-abend-code         of lk-trif
005746       to from-upgm-abend-code         of lk-nwif
005748     move from-upgm-abend-program      of lk-trif
005750       to from-upgm-abend-program      of lk-nwif
005752     move from-upgm-return-code        of lk-trif
005754       to from-upgm-return-code        of lk-nwif
005756     move from-upgm-reason             of lk-trif
005758       to from-upgm-reason             of lk-nwif
005760     move from-upgm-msg                of lk-trif
005762       to from-upgm-msg                of lk-nwif
005764     if ws-mf-ti-trace-level >= 4
005766       set  address                    of lk-nwif-t
005768         to address                    of lk-nwif
005770       perform 7000-nwif-trace
005772     end-if
005774     exit
005776     .
005778 mf-ti-setup section.
005780     move mq03-trace-level             of ws-mq03-trace-misc
005782       to ws-mf-ti-trace-level
005784     move mq03-trace-queue-name        of ws-mq03-trace-misc
005786       to ws-mf-ti-queue-name-long
005788     if ws-mf-ti-trace-level           of ws-mf-ti-record
005790       > zero
005792       move 1
005794         to ws-mf-ti-major-version     of ws-mf-ti-record
005796       move zero
005798         to ws-mf-ti-minor-version     of ws-mf-ti-record
005800       move ws-trac-program            of ws-static-fields
005802         to ws-mf-ti-trace-program     of ws-mf-ti-record
005804       exec cics assign
005806         userid   (ws-mf-ti-userid     of ws-mf-ti-record)
005808         nohandle
005810       end-exec
005812       exec cics assign
005814         sysid    (ws-mf-ti-sysid      of ws-mf-ti-record)
005816         nohandle
005818       end-exec
005820       move eibtaskn                   of dfheiblk
005822         to ws-mf-ti-eibtaskn          of ws-mf-ti-record
005824       move ws-this-program            of ws-static-fields
005826         to ws-mf-ti-calling-program   of ws-mf-ti-record
005828       move ws-unknown-ebiz            of ws-static-fields
005830         to ws-mf-ti-ebiz-program      of ws-mf-ti-record
005832     end-if
005834     exit
005836     .
005838
005840 mf-ti-write section.
005842     call ws-mf-ti-trace-program
005844       using dfheiblk
005846             dfhcommarea
005848             ws-mf-ti-record
005850       on exception
005852         continue
005854     end-call
005856     exit
005858     .
005860 
005862 8000-freemain-error section.
005864     if ws-mf-ti-trace-level >= 1
005866       move 71 to ws-mf-ti-msg-nbr
005868       move '8000-freemain-error' to ws-mf-ti-data-rec(1:19)
005870       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
005872       move 19 to ws-mf-ti-user-data-len
005874       perform mf-ti-write
005876     end-if
005878     perform 7000-error-trace
005880     perform 7000-freemain-trace
005882     move freemain-resp                of ws-freemain-misc
005884       to freemain-resp-disp           of ws-freemain-misc
005886     move freemain-resp2               of ws-freemain-misc
005888       to freemain-resp2-disp          of ws-freemain-misc
005890     move spaces
005892       to mf-msg                       of lk-nwif
005894     string
005896       ws-this-program                 of ws-static-fields
005898       commax                          of ws-static-fields
005900       'FREEMAIN'
005902       commax                          of ws-static-fields
005904       freemain-resp-disp              of ws-freemain-misc
005906       commax                          of ws-static-fields
005908       freemain-resp2-disp             of ws-freemain-misc
005910       delimited by space
005912       into mf-msg                     of lk-nwif
005914     end-string
005916     perform 9000-return
005918     exit
005920     .
005922 
005924 8000-getmain-error section.
005926     if ws-mf-ti-trace-level >= 1
005928       move 71 to ws-mf-ti-msg-nbr
005930       move '8000-getmain-error' to ws-mf-ti-data-rec(1:18)
005932       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
005934       move 18 to ws-mf-ti-user-data-len
005936       perform mf-ti-write
005938     end-if
005940     perform 7000-error-trace
005942     perform 7000-getmain-trace
005944     move getmain-resp                 of ws-getmain-misc
005946       to getmain-resp-disp            of ws-getmain-misc
005948     move getmain-resp2                of ws-getmain-misc
005950       to getmain-resp2-disp           of ws-getmain-misc
005952     move getmain-flength              of ws-getmain-misc
005954       to getmain-flength-disp         of ws-getmain-misc
005956     move spaces
005958       to mf-msg                       of lk-nwif
005960     string
005962       ws-this-program                 of ws-static-fields
005964       commax                          of ws-static-fields
005966       'GETMAIN'
005968       commax                          of ws-static-fields
005970       getmain-resp-disp               of ws-getmain-misc
005972       commax                          of ws-static-fields
005974       getmain-resp2-disp              of ws-getmain-misc
005976       commax                          of ws-static-fields
005978       getmain-flength-disp            of ws-getmain-misc
005980       delimited by space
005982       into mf-msg                     of lk-nwif
005984     end-string
005986     perform 9000-return
005988     exit
005990     .
005992 
005994 8000-link-error section.
005996     if ws-mf-ti-trace-level >= 1
005998       move 71 to ws-mf-ti-msg-nbr
006000       move '8000-link-error' to ws-mf-ti-data-rec(1:15)
006002       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006004       move 15 to ws-mf-ti-user-data-len
006006       perform mf-ti-write
006008     end-if
006010     perform 7000-error-trace
006012     perform 7000-link-trace
006014     move link-resp                    of ws-link-misc
006016       to link-resp-disp               of ws-link-misc
006018     move link-resp2                   of ws-link-misc
006020       to link-resp2-disp              of ws-link-misc
006022     move spaces
006024       to mf-msg                       of lk-nwif
006026     string
006028       ws-this-program                 of ws-static-fields
006030       commax                          of ws-static-fields
006032       'LINK'
006034       commax                          of ws-static-fields
006036       link-resp-disp                  of ws-link-misc
006038       commax                          of ws-static-fields
006040       link-resp2-disp                 of ws-link-misc
006042       commax                          of ws-static-fields
006044       link-program                    of ws-link-misc
006046       delimited by space
006048       into mf-msg                     of lk-nwif
006050     end-string
006052     perform 9000-return
006054     exit
006056     .
006058 
006060 8000-return-error section.
006062     if ws-mf-ti-trace-level >= 1
006064       move 71 to ws-mf-ti-msg-nbr
006066       move '8000-return-error' to ws-mf-ti-data-rec(1:17)
006068       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006070       move 17 to ws-mf-ti-user-data-len
006072       perform mf-ti-write
006074     end-if
006076     perform 7000-error-trace
006078     perform 7000-return-trace
006080     perform 9000-return
006082     exit
006084     .
006086 
006088 8000-mqclose-error section.
006090     if ws-mf-ti-trace-level >= 1
006092       move 71 to ws-mf-ti-msg-nbr
006094       move '8000-mqclose-error' to ws-mf-ti-data-rec(1:18)
006096       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006098       move 18 to ws-mf-ti-user-data-len
006100       perform mf-ti-write
006102     end-if
006104     perform 7000-error-trace
006106     perform 7000-mqclose-trace
006108     move mqclose-comp-code            of ws-mqclose-misc
006110       to mqclose-comp-code-disp       of ws-mqclose-misc
006112     move mqclose-reason               of ws-mqclose-misc
006114       to mqclose-reason-disp          of ws-mqclose-misc
006116     move spaces
006118       to mf-msg                       of lk-nwif
006120     string
006122       ws-this-program                 of ws-static-fields
006124       commax                          of ws-static-fields
006126       'MQCLOSE'
006128       commax                          of ws-static-fields
006130       mqclose-comp-code-disp          of ws-mqclose-misc
006132       commax                          of ws-static-fields
006134       mqclose-reason-disp             of ws-mqclose-misc
006136       commax                          of ws-static-fields
006138       mqod-objectname                 of ws-cmqodv-copybook
006140       delimited by space
006142       into mf-msg                     of lk-nwif
006144     end-string
006146     perform 9000-return
006148     exit
006150     .
006152 
006154 8000-mqget-error section.
006156     if ws-mf-ti-trace-level >= 1
006158       move 71 to ws-mf-ti-msg-nbr
006160       move '8000-mqget-error' to ws-mf-ti-data-rec(1:16)
006162       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006164       move 16 to ws-mf-ti-user-data-len
006166       perform mf-ti-write
006168     end-if
006170     perform 7000-error-trace
006172     perform 7000-mqget-trace
006174     move mqget-comp-code              of ws-mqget-misc
006176       to mqget-comp-code-disp         of ws-mqget-misc
006178     move mqget-reason                 of ws-mqget-misc
006180       to mqget-reason-disp            of ws-mqget-misc
006182     move spaces
006184       to mf-msg                       of lk-nwif
006186     string
006188       ws-this-program                 of ws-static-fields
006190       commax                          of ws-static-fields
006192       'MQGET'
006194       commax                          of ws-static-fields
006196       mqget-comp-code-disp            of ws-mqget-misc
006198       commax                          of ws-static-fields
006200       mqget-reason-disp               of ws-mqget-misc
006202       commax                          of ws-static-fields
006204       mqod-objectname                 of ws-cmqodv-copybook
006206       delimited by space
006208       into mf-msg                     of lk-nwif
006210     end-string
006212     perform 9000-return
006214     exit
006216     .
006218 
006220 8000-mqput1-error section.
006222     if ws-mf-ti-trace-level >= 1
006224       move 71 to ws-mf-ti-msg-nbr
006226       move '8000-mqput1-error' to ws-mf-ti-data-rec(1:17)
006228       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006230       move 17 to ws-mf-ti-user-data-len
006232       perform mf-ti-write
006234     end-if
006236     perform 7000-error-trace
006238     perform 7000-mqput1-trace
006240     move mqput1-comp-code             of ws-mqput1-misc
006242       to mqput1-comp-code-disp        of ws-mqput1-misc
006244     move mqput1-reason                of ws-mqput1-misc
006246       to mqput1-reason-disp           of ws-mqput1-misc
006248     move spaces
006250       to mf-msg                       of lk-nwif
006252     string
006254       ws-this-program                 of ws-static-fields
006256       commax                          of ws-static-fields
006258       'MQPUT1'
006260       commax                          of ws-static-fields
006262       mqput1-comp-code-disp           of ws-mqput1-misc
006264       commax                          of ws-static-fields
006266       mqput1-reason-disp              of ws-mqput1-misc
006268       commax                          of ws-static-fields
006270       mqod-objectname                 of ws-cmqodv-copybook
006272       delimited by space
006274       into mf-msg                     of lk-nwif
006276     end-string
006278     perform 9000-return
006280     exit
006282     .
006284 
006286 8000-mqopen-error section.
006288     if ws-mf-ti-trace-level >= 1
006290       move 71 to ws-mf-ti-msg-nbr
006292       move '8000-mqopen-error' to ws-mf-ti-data-rec(1:17)
006294       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006296       move 17 to ws-mf-ti-user-data-len
006298       perform mf-ti-write
006300     end-if
006302     perform 7000-error-trace
006304     perform 7000-mqopen-trace
006306     move mqopen-comp-code             of ws-mqopen-misc
006308       to mqopen-comp-code-disp        of ws-mqopen-misc
006310     move mqopen-reason                of ws-mqopen-misc
006312       to mqopen-reason-disp           of ws-mqopen-misc
006314     move spaces
006316       to mf-msg                       of lk-nwif
006318     string
006320       ws-this-program                 of ws-static-fields
006322       commax                          of ws-static-fields
006324       'MQOPEN'
006326       commax                          of ws-static-fields
006328       mqopen-comp-code-disp           of ws-mqopen-misc
006330       commax                          of ws-static-fields
006332       mqopen-reason-disp              of ws-mqopen-misc
006334       delimited by space
006336       into mf-msg                     of lk-nwif
006338     end-string
006340     perform 9000-return
006342     exit
006344     .
006346 
006348 9000-return section.
006350     if ws-mf-ti-trace-level >= 1
006352       move 71 to ws-mf-ti-msg-nbr
006354       move '9000-return' to ws-mf-ti-data-rec(1:11)
006356       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006358       move 11 to ws-mf-ti-user-data-len
006360       perform mf-ti-write
006362     end-if
006364     exec cics return
006366     end-exec.
006368     exit
006370     .
006372 
006374 9000-return-goback section.
006376     if ws-mf-ti-trace-level >= 1
006378       move 71 to ws-mf-ti-msg-nbr
006380       move '9000-return-goback' to ws-mf-ti-data-rec(1:18)
006382       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006384       move 18 to ws-mf-ti-user-data-len
006386       perform mf-ti-write
006388     end-if
006390     if ws-mf-ti-trace-level >= 4
006392       set  address                    of lk-nwif-t
006394         to address                    of lk-nwif
006396       perform 7000-nwif-trace
006398     end-if
006400     exec cics return
006402     end-exec
006404     goback
006406     exit program
006408     .
006410 
006412 9000-handle-nike-abend section.
006414     if ws-mf-ti-trace-level >= 1
006416       move 71 to ws-mf-ti-msg-nbr
006418       move '9000-handle-nike-abend' to ws-mf-ti-data-rec(1:22)
006420       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006422       move 22 to ws-mf-ti-user-data-len
006424       perform mf-ti-write
006426     end-if
006428     exit
006430     .
006432 
006434 7000-footprint-trace section.
006436     if ws-mf-ti-trace-level >= 1
006438       move 71 to ws-mf-ti-msg-nbr
006440       move '7000-footprint-trace' to ws-mf-ti-data-rec(1:20)
006442       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006444       move 20 to ws-mf-ti-user-data-len
006446       perform mf-ti-write
006448     end-if
006450     move ws-footprint(17:83)
006452       to footprint-data               of ws-footprint-t
006454     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
006456       to address                      of ws-footprint-t
006458     move seventy-five                 of ws-static-fields
006460       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
006462     move length                       of ws-footprint-t
006464       to ws-mf-ti-user-data-len       of ws-mf-ti-record
006466     perform mf-ti-write
006468     exit
006470     .
006472 
006474 7000-info-trace section.
006476     if ws-mf-ti-trace-level >= 1
006478       move 71 to ws-mf-ti-msg-nbr
006480       move '7000-info-trace' to ws-mf-ti-data-rec(1:15)
006482       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006484       move 15 to ws-mf-ti-user-data-len
006486       perform mf-ti-write
006488     end-if
006490     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
006492       to address                      of ws-info-t
006494     move seventy-five                 of ws-static-fields
006496       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
006498     move length                       of ws-info-t
006500       to ws-mf-ti-user-data-len       of ws-mf-ti-record
006502     perform mf-ti-write
006504     exit
006506     .
006508 
006510 7000-error-trace section.
006512     if ws-mf-ti-trace-level >= 1
006514       move 71 to ws-mf-ti-msg-nbr
006516       move '7000-error-trace' to ws-mf-ti-data-rec(1:16)
006518       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006520       move 16 to ws-mf-ti-user-data-len
006522       perform mf-ti-write
006524     end-if
006526     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
006528       to address                      of ws-error-t
006530     move seventy-five                 of ws-static-fields
006532       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
006534     move length                       of ws-error-t
006536       to ws-mf-ti-user-data-len       of ws-mf-ti-record
006538     perform mf-ti-write
006540     exit
006542     .
006544 
006546 7000-section-trace section.
006548     if ws-mf-ti-trace-level >= 1
006550       move 71 to ws-mf-ti-msg-nbr
006552       move '7000-section-trace' to ws-mf-ti-data-rec(1:18)
006554       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006556       move 18 to ws-mf-ti-user-data-len
006558       perform mf-ti-write
006560     end-if
006562     if ws-mf-ti-trace-level >= 1
006564       move 71 to ws-mf-ti-msg-nbr
006566       move '7000-section-trace' to ws-mf-ti-data-rec(1:18)
006568       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006570       move 18 to ws-mf-ti-user-data-len
006572       perform mf-ti-write
006574     end-if
006576     exit
006578     .
006580 
006582 7000-cmqgmov-trace section.
006584     if ws-mf-ti-trace-level >= 1
006586       move 71 to ws-mf-ti-msg-nbr
006588       move '7000-cmqgmov-trace' to ws-mf-ti-data-rec(1:18)
006590       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006592       move 18 to ws-mf-ti-user-data-len
006594       perform mf-ti-write
006596     end-if
006598     move mqgmo-strucid                of ws-cmqgmov-copybook
006600       to mqgmo-strucid                of ws-cmqgmov-t
006602     move mqgmo-version                of ws-cmqgmov-copybook
006604       to mqgmo-version                of ws-cmqgmov-t
006606     move mqgmo-options                of ws-cmqgmov-copybook
006608       to mqgmo-options                of ws-cmqgmov-t
006610     move mqgmo-waitinterval           of ws-cmqgmov-copybook
006612       to mqgmo-waitinterval           of ws-cmqgmov-t
006614     move mqgmo-signal1                of ws-cmqgmov-copybook
006616       to mqgmo-signal1                of ws-cmqgmov-t
006618     move mqgmo-signal2                of ws-cmqgmov-copybook
006620       to mqgmo-signal2                of ws-cmqgmov-t
006622     move mqgmo-resolvedqname          of ws-cmqgmov-copybook
006624       to mqgmo-resolvedqname          of ws-cmqgmov-t
006626     move mqgmo-matchoptions           of ws-cmqgmov-copybook
006628       to mqgmo-matchoptions           of ws-cmqgmov-t
006630     move mqgmo-groupstatus            of ws-cmqgmov-copybook
006632       to mqgmo-groupstatus            of ws-cmqgmov-t
006634     move mqgmo-segmentstatus          of ws-cmqgmov-copybook
006636       to mqgmo-segmentstatus          of ws-cmqgmov-t
006638     move mqgmo-segmentation           of ws-cmqgmov-copybook
006640       to mqgmo-segmentation           of ws-cmqgmov-t
006642     move mqgmo-reserved1              of ws-cmqgmov-copybook
006644       to mqgmo-reserved1              of ws-cmqgmov-t
006646     move mqgmo-msgtoken               of ws-cmqgmov-copybook
006648       to mqgmo-msgtoken               of ws-cmqgmov-t
006650     move mqgmo-returnedlength         of ws-cmqgmov-copybook
006652       to mqgmo-returnedlength         of ws-cmqgmov-t
006654     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
006656       to address                      of ws-cmqgmov-t
006658     move seventy-five                 of ws-static-fields
006660       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
006662     move length                       of ws-cmqgmov-t
006664       to ws-mf-ti-user-data-len       of ws-mf-ti-record
006666     perform mf-ti-write
006668     exit
006670     .
006672 
006674 7000-cmqodv-trace section.
006676     if ws-mf-ti-trace-level >= 1
006678       move 71 to ws-mf-ti-msg-nbr
006680       move '7000-cmqodv-trace' to ws-mf-ti-data-rec(1:17)
006682       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006684       move 17 to ws-mf-ti-user-data-len
006686       perform mf-ti-write
006688     end-if
006690     move mqod-strucid                 of ws-cmqodv-copybook
006692       to mqod-strucid                 of ws-cmqodv-t
006694     move mqod-version                 of ws-cmqodv-copybook
006696       to mqod-version                 of ws-cmqodv-t
006698     move mqod-objecttype              of ws-cmqodv-copybook
006700       to mqod-objecttype              of ws-cmqodv-t
006702     move mqod-objectname              of ws-cmqodv-copybook
006704       to mqod-objectname              of ws-cmqodv-t
006706     move mqod-objectqmgrname          of ws-cmqodv-copybook
006708       to mqod-objectqmgrname          of ws-cmqodv-t
006710     move mqod-dynamicqname            of ws-cmqodv-copybook
006712       to mqod-dynamicqname            of ws-cmqodv-t
006714     move mqod-alternateuserid         of ws-cmqodv-copybook
006716       to mqod-alternateuserid         of ws-cmqodv-t
006718     move mqod-recspresent             of ws-cmqodv-copybook
006720       to mqod-recspresent             of ws-cmqodv-t
006722     move mqod-knowndestcount          of ws-cmqodv-copybook
006724       to mqod-knowndestcount          of ws-cmqodv-t
006726     move mqod-unknowndestcount        of ws-cmqodv-copybook
006728       to mqod-unknowndestcount        of ws-cmqodv-t
006730     move mqod-invaliddestcount        of ws-cmqodv-copybook
006732       to mqod-invaliddestcount        of ws-cmqodv-t
006734     move mqod-objectrecoffset         of ws-cmqodv-copybook
006736       to mqod-objectrecoffset         of ws-cmqodv-t
006738     move mqod-responserecoffset       of ws-cmqodv-copybook
006740       to mqod-responserecoffset       of ws-cmqodv-t
006742     set  mqod-objectrecptr            of ws-cmqodv-t
006744       to mqod-objectrecptr            of ws-cmqodv-copybook
006746     set  mqod-responserecptr          of ws-cmqodv-t
006748       to mqod-responserecptr          of ws-cmqodv-copybook
006750     move mqod-alternatesecurityid     of ws-cmqodv-copybook
006752       to mqod-alternatesecurityid     of ws-cmqodv-t
006754     move mqod-resolvedqname           of ws-cmqodv-copybook
006756       to mqod-resolvedqname           of ws-cmqodv-t
006758     move mqod-resolvedqmgrname        of ws-cmqodv-copybook
006760       to mqod-resolvedqmgrname        of ws-cmqodv-t
006762     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
006764       to address                      of ws-cmqodv-t
006766     move seventy-five                 of ws-static-fields
006768       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
006770     move length                       of ws-cmqodv-t
006772       to ws-mf-ti-user-data-len       of ws-mf-ti-record
006774     perform mf-ti-write
006776     exit
006778     .
006780 
006782 7000-cmqmdv-trace section.
006784     if ws-mf-ti-trace-level >= 1
006786       move 71 to ws-mf-ti-msg-nbr
006788       move '7000-cmqmdv-trace' to ws-mf-ti-data-rec(1:17)
006790       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006792       move 17 to ws-mf-ti-user-data-len
006794       perform mf-ti-write
006796     end-if
006798     move mqmd-strucid                 of ws-cmqmdv-copybook
006800       to mqmd-strucid                 of ws-cmqmdv-t
006802     move mqmd-version                 of ws-cmqmdv-copybook
006804       to mqmd-version                 of ws-cmqmdv-t
006806     move mqmd-report                  of ws-cmqmdv-copybook
006808       to mqmd-report                  of ws-cmqmdv-t
006810     move mqmd-msgtype                 of ws-cmqmdv-copybook
006812       to mqmd-msgtype                 of ws-cmqmdv-t
006814     move mqmd-expiry                  of ws-cmqmdv-copybook
006816       to mqmd-expiry                  of ws-cmqmdv-t
006818     move mqmd-feedback                of ws-cmqmdv-copybook
006820       to mqmd-feedback                of ws-cmqmdv-t
006822     move mqmd-encoding                of ws-cmqmdv-copybook
006824       to mqmd-encoding                of ws-cmqmdv-t
006826     move mqmd-codedcharsetid          of ws-cmqmdv-copybook
006828       to mqmd-codedcharsetid          of ws-cmqmdv-t
006830     move mqmd-format                  of ws-cmqmdv-copybook
006832       to mqmd-format                  of ws-cmqmdv-t
006834     move mqmd-priority                of ws-cmqmdv-copybook
006836       to mqmd-priority                of ws-cmqmdv-t
006838     move mqmd-persistence             of ws-cmqmdv-copybook
006840       to mqmd-persistence             of ws-cmqmdv-t
006842     move mqmd-msgid                   of ws-cmqmdv-copybook
006844       to mqmd-msgid                   of ws-cmqmdv-t
006846     move mqmd-correlid                of ws-cmqmdv-copybook
006848       to mqmd-correlid                of ws-cmqmdv-t
006850     move mqmd-backoutcount            of ws-cmqmdv-copybook
006852       to mqmd-backoutcount            of ws-cmqmdv-t
006854     move mqmd-replytoq                of ws-cmqmdv-copybook
006856       to mqmd-replytoq                of ws-cmqmdv-t
006858     move mqmd-replytoqmgr             of ws-cmqmdv-copybook
006860       to mqmd-replytoqmgr             of ws-cmqmdv-t
006862     move mqmd-useridentifier          of ws-cmqmdv-copybook
006864       to mqmd-useridentifier          of ws-cmqmdv-t
006866     move mqmd-accountingtoken         of ws-cmqmdv-copybook
006868       to mqmd-accountingtoken         of ws-cmqmdv-t
006870     move mqmd-applidentitydata        of ws-cmqmdv-copybook
006872       to mqmd-applidentitydata        of ws-cmqmdv-t
006874     move mqmd-putappltype             of ws-cmqmdv-copybook
006876       to mqmd-putappltype             of ws-cmqmdv-t
006878     move mqmd-putapplname             of ws-cmqmdv-copybook
006880       to mqmd-putapplname             of ws-cmqmdv-t
006882     move mqmd-putdate                 of ws-cmqmdv-copybook
006884       to mqmd-putdate                 of ws-cmqmdv-t
006886     move mqmd-puttime                 of ws-cmqmdv-copybook
006888       to mqmd-puttime                 of ws-cmqmdv-t
006890     move mqmd-applorigindata          of ws-cmqmdv-copybook
006892       to mqmd-applorigindata          of ws-cmqmdv-t
006894     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
006896       to address                      of ws-cmqmdv-t
006898     move seventy-five                 of ws-static-fields
006900       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
006902     move length                       of ws-cmqmdv-t
006904       to ws-mf-ti-user-data-len       of ws-mf-ti-record
006906     perform mf-ti-write
006908     exit
006910     .
006912 
006914 7000-cmqpmol-trace section.
006916     if ws-mf-ti-trace-level >= 1
006918       move 71 to ws-mf-ti-msg-nbr
006920       move '7000-cmqpmol-trace' to ws-mf-ti-data-rec(1:18)
006922       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
006924       move 18 to ws-mf-ti-user-data-len
006926       perform mf-ti-write
006928     end-if
006930     move mqpmo-strucid                of ws-cmqpmol-copybook
006932       to mqpmo-strucid                of ws-cmqpmol-t
006934     move mqpmo-version                of ws-cmqpmol-copybook
006936       to mqpmo-version                of ws-cmqpmol-t
006938     move mqpmo-options                of ws-cmqpmol-copybook
006940       to mqpmo-options                of ws-cmqpmol-t
006942     move mqpmo-timeout                of ws-cmqpmol-copybook
006944       to mqpmo-timeout                of ws-cmqpmol-t
006946     move mqpmo-context                of ws-cmqpmol-copybook
006948       to mqpmo-context                of ws-cmqpmol-t
006950     move mqpmo-knowndestcount         of ws-cmqpmol-copybook
006952       to mqpmo-knowndestcount         of ws-cmqpmol-t
006954     move mqpmo-unknowndestcount       of ws-cmqpmol-copybook
006956       to mqpmo-unknowndestcount       of ws-cmqpmol-t
006958     move mqpmo-invaliddestcount       of ws-cmqpmol-copybook
006960       to mqpmo-invaliddestcount       of ws-cmqpmol-t
006962     move mqpmo-resolvedqname          of ws-cmqpmol-copybook
006964       to mqpmo-resolvedqname          of ws-cmqpmol-t
006966     move mqpmo-resolvedqmgrname       of ws-cmqpmol-copybook
006968       to mqpmo-resolvedqmgrname       of ws-cmqpmol-t
006970     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
006972       to address                      of ws-cmqpmol-t
006974     move seventy-five                 of ws-static-fields
006976       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
006978     move length                       of ws-cmqpmol-t
006980       to ws-mf-ti-user-data-len       of ws-mf-ti-record
006982     perform mf-ti-write
006984     exit
006986     .
006988 
006990 7000-cmqpmov-trace section.
006992     if ws-mf-ti-trace-level >= 1
006994       move 71 to ws-mf-ti-msg-nbr
006996       move '7000-cmqpmov-trace' to ws-mf-ti-data-rec(1:18)
006998       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007000       move 18 to ws-mf-ti-user-data-len
007002       perform mf-ti-write
007004     end-if
007006     move mqpmo-strucid                of ws-cmqpmov-copybook
007008       to mqpmo-strucid                of ws-cmqpmov-t
007010     move mqpmo-version                of ws-cmqpmov-copybook
007012       to mqpmo-version                of ws-cmqpmov-t
007014     move mqpmo-options                of ws-cmqpmov-copybook
007016       to mqpmo-options                of ws-cmqpmov-t
007018     move mqpmo-timeout                of ws-cmqpmov-copybook
007020       to mqpmo-timeout                of ws-cmqpmov-t
007022     move mqpmo-context                of ws-cmqpmov-copybook
007024       to mqpmo-context                of ws-cmqpmov-t
007026     move mqpmo-knowndestcount         of ws-cmqpmov-copybook
007028       to mqpmo-knowndestcount         of ws-cmqpmov-t
007030     move mqpmo-unknowndestcount       of ws-cmqpmov-copybook
007032       to mqpmo-unknowndestcount       of ws-cmqpmov-t
007034     move mqpmo-invaliddestcount       of ws-cmqpmov-copybook
007036       to mqpmo-invaliddestcount       of ws-cmqpmov-t
007038     move mqpmo-resolvedqname          of ws-cmqpmov-copybook
007040       to mqpmo-resolvedqname          of ws-cmqpmov-t
007042     move mqpmo-resolvedqmgrname       of ws-cmqpmov-copybook
007044       to mqpmo-resolvedqmgrname       of ws-cmqpmov-t
007046     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
007048       to address                      of ws-cmqpmov-t
007050     move seventy-five                 of ws-static-fields
007052       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
007054     move length                       of ws-cmqpmov-t
007056       to ws-mf-ti-user-data-len       of ws-mf-ti-record
007058     perform mf-ti-write
007060     exit
007062     .
007064 
007066 7000-nwif-trace section.
007068     if ws-mf-ti-trace-level >= 1
007070       move 71 to ws-mf-ti-msg-nbr
007072       move '7000-nwif-trace' to ws-mf-ti-data-rec(1:15)
007074       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007076       move 15 to ws-mf-ti-user-data-len
007078       perform mf-ti-write
007080     end-if
007082     set  this-pntr                    of ws-nwif-t
007084       to this-pntr                    of lk-nwif-t
007086     move struclen                     of lk-nwif-t
007088       to struclen                     of ws-nwif-t
007090     move version                      of lk-nwif-t
007092       to version                      of ws-nwif-t
007094     move mq03-alt-name                of lk-nwif-t
007096       to mq03-alt-name                of ws-nwif-t
007098     move trace-level                  of lk-nwif-t
007100       to trace-level                  of ws-nwif-t
007102     move trace-queue-name             of lk-nwif-t
007104       to trace-queue-name             of ws-nwif-t
007106     move useridx                      of lk-nwif-t
007108       to useridx                      of ws-nwif-t
007110     move ebiz-name                    of lk-nwif-t
007112       to ebiz-name                    of ws-nwif-t
007114     move upgm-name                    of lk-nwif-t
007116       to upgm-name                    of ws-nwif-t
007118     move copybook-mode                of lk-nwif-t
007120       to copybook-mode                of ws-nwif-t
007122     move processing-mode              of lk-nwif-t
007124       to processing-mode              of ws-nwif-t
007126     move security-status              of lk-nwif-t
007128       to security-status              of ws-nwif-t
007130     move mf-processing-mode           of lk-nwif-t
007132       to mf-processing-mode           of ws-nwif-t
007134     move mf-abend-program             of lk-nwif-t
007136       to mf-abend-program             of ws-nwif-t
007138     move mf-abend-code                of lk-nwif-t
007140       to mf-abend-code                of ws-nwif-t
007142     move mf-return-code               of lk-nwif-t
007144       to mf-return-code               of ws-nwif-t
007146     move mf-reason                    of lk-nwif-t
007148       to mf-reason                    of ws-nwif-t
007150     move mf-msg                       of lk-nwif-t
007152       to mf-msg                       of ws-nwif-t
007154     move mqtm-userdata                of lk-nwif-t
007156       to mqtm-userdata                of ws-nwif-t
007158     set  req-msg-pntr                 of ws-nwif-t
007160       to req-msg-pntr                 of lk-nwif-t
007162     move req-msg-hdr-lenf             of lk-nwif-t
007164       to req-msg-hdr-lenf             of ws-nwif-t
007166     move req-msg-hdr-ext-lenf         of lk-nwif-t
007168       to req-msg-hdr-ext-lenf         of ws-nwif-t
007170     move req-fmt-hdr-lenf             of lk-nwif-t
007172       to req-fmt-hdr-lenf             of ws-nwif-t
007174     move req-ebiz-hdr-lenf            of lk-nwif-t
007176       to req-ebiz-hdr-lenf            of ws-nwif-t
007178     move req-ebiz-data-full-lenf      of lk-nwif-t
007180       to req-ebiz-data-full-lenf      of ws-nwif-t
007182     move req-ebiz-data-used-lenf      of lk-nwif-t
007184       to req-ebiz-data-used-lenf      of ws-nwif-t
007186     move req-msg-total-full-lenf      of lk-nwif-t
007188       to req-msg-total-full-lenf      of ws-nwif-t
007190     move req-msg-total-used-lenf      of lk-nwif-t
007192       to req-msg-total-used-lenf      of ws-nwif-t
007194     move req-qmgr-name                of lk-nwif-t
007196       to req-qmgr-name                of ws-nwif-t
007198     move req-qname                    of lk-nwif-t
007200       to req-qname                    of ws-nwif-t
007202     move req-queue-nbr                of lk-nwif-t
007204       to req-queue-nbr                of ws-nwif-t
007206     move req-expiry                   of lk-nwif-t
007208       to req-expiry                   of ws-nwif-t
007210     move req-wait-interval            of lk-nwif-t
007212       to req-wait-interval            of ws-nwif-t
007214     move req-persistent               of lk-nwif-t
007216       to req-persistent               of ws-nwif-t
007218     move req-msgid                    of lk-nwif-t
007220       to req-msgid                    of ws-nwif-t
007222     move req-correlid                 of lk-nwif-t
007224       to req-correlid                 of ws-nwif-t
007226     set  rep-msg-pntr                 of ws-nwif-t
007228       to rep-msg-pntr                 of lk-nwif-t
007230     move rep-msg-hdr-lenf             of lk-nwif-t
007232       to rep-msg-hdr-lenf             of ws-nwif-t
007234     move rep-fmt-hdr-lenf             of lk-nwif-t
007236       to rep-fmt-hdr-lenf             of ws-nwif-t
007238     move rep-ebiz-hdr-lenf            of lk-nwif-t
007240       to rep-ebiz-hdr-lenf            of ws-nwif-t
007242     move rep-ebiz-data-full-lenf      of lk-nwif-t
007244       to rep-ebiz-data-full-lenf      of ws-nwif-t
007246     move rep-ebiz-data-used-lenf      of lk-nwif-t
007248       to rep-ebiz-data-used-lenf      of ws-nwif-t
007250     move rep-msg-total-full-lenf      of lk-nwif-t
007252       to rep-msg-total-full-lenf      of ws-nwif-t
007254     move rep-msg-total-used-lenf      of lk-nwif-t
007256       to rep-msg-total-used-lenf      of ws-nwif-t
007258     move rep-qmgr-name                of lk-nwif-t
007260       to rep-qmgr-name                of ws-nwif-t
007262     move rep-qname                    of lk-nwif-t
007264       to rep-qname                    of ws-nwif-t
007266     move rep-queue-nbr                of lk-nwif-t
007268       to rep-queue-nbr                of ws-nwif-t
007270     move rep-expiry                   of lk-nwif-t
007272       to rep-expiry                   of ws-nwif-t
007274     move rep-wait-interval            of lk-nwif-t
007276       to rep-wait-interval            of ws-nwif-t
007278     move rep-persistent               of lk-nwif-t
007280       to rep-persistent               of ws-nwif-t
007282     move rep-msgid                    of lk-nwif-t
007284       to rep-msgid                    of ws-nwif-t
007286     move rep-correlid                 of lk-nwif-t
007288       to rep-correlid                 of ws-nwif-t
007290     set  to-upgm-bfr-pntr             of ws-nwif-t
007292       to to-upgm-bfr-pntr             of lk-nwif-t
007294     move to-upgm-bfr-full-lenf        of lk-nwif-t
007296       to to-upgm-bfr-full-lenf        of ws-nwif-t
007298     move to-upgm-bfr-used-lenf        of lk-nwif-t
007300       to to-upgm-bfr-used-lenf        of ws-nwif-t
007302     move to-upgm-qmgr-name            of lk-nwif-t
007304       to to-upgm-qmgr-name            of ws-nwif-t
007306     move to-upgm-qname                of lk-nwif-t
007308       to to-upgm-qname                of ws-nwif-t
007310     move to-upgm-queue-nbr            of lk-nwif-t
007312       to to-upgm-queue-nbr            of ws-nwif-t
007314     move to-upgm-expiry               of lk-nwif-t
007316       to to-upgm-expiry               of ws-nwif-t
007318     move to-upgm-wait-interval        of lk-nwif-t
007320       to to-upgm-wait-interval        of ws-nwif-t
007322     move to-upgm-persistent           of lk-nwif-t
007324       to to-upgm-persistent           of ws-nwif-t
007326     move to-upgm-msgid                of lk-nwif-t
007328       to to-upgm-msgid                of ws-nwif-t
007330     move to-upgm-correlid             of lk-nwif-t
007332       to to-upgm-correlid             of ws-nwif-t
007334     set  from-upgm-bfr-pntr           of ws-nwif-t
007336       to from-upgm-bfr-pntr           of lk-nwif-t
007338     move from-upgm-bfr-full-lenf      of lk-nwif-t
007340       to from-upgm-bfr-full-lenf      of ws-nwif-t
007342     move from-upgm-bfr-used-lenf      of lk-nwif-t
007344       to from-upgm-bfr-used-lenf      of ws-nwif-t
007346     move from-upgm-qmgr-name          of lk-nwif-t
007348       to from-upgm-qmgr-name          of ws-nwif-t
007350     move from-upgm-qname              of lk-nwif-t
007352       to from-upgm-qname              of ws-nwif-t
007354     move from-upgm-queue-nbr          of lk-nwif-t
007356       to from-upgm-queue-nbr          of ws-nwif-t
007358     move from-upgm-expiry             of lk-nwif-t
007360       to from-upgm-expiry             of ws-nwif-t
007362     move from-upgm-wait-interval      of lk-nwif-t
007364       to from-upgm-wait-interval      of ws-nwif-t
007366     move from-upgm-persistent         of lk-nwif-t
007368       to from-upgm-persistent         of ws-nwif-t
007370     move from-upgm-msgid              of lk-nwif-t
007372       to from-upgm-msgid              of ws-nwif-t
007374     move from-upgm-correlid           of lk-nwif-t
007376       to from-upgm-correlid           of ws-nwif-t
007378     move from-upgm-processing-mode    of lk-nwif-t
007380       to from-upgm-processing-mode    of ws-nwif-t
007382     move from-upgm-abend-program      of lk-nwif-t
007384       to from-upgm-abend-program      of ws-nwif-t
007386     move from-upgm-abend-code         of lk-nwif-t
007388       to from-upgm-abend-code         of ws-nwif-t
007390     move from-upgm-return-code        of lk-nwif-t
007392       to from-upgm-return-code        of ws-nwif-t
007394     move from-upgm-reason             of lk-nwif-t
007396       to from-upgm-reason             of ws-nwif-t
007398     move from-upgm-msg                of lk-nwif-t
007400       to from-upgm-msg                of ws-nwif-t
007402     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
007404       to address                      of ws-nwif-t
007406     move seventy-five                 of ws-static-fields
007408       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
007410     move length                       of ws-nwif-t
007412       to ws-mf-ti-user-data-len       of ws-mf-ti-record
007414     perform mf-ti-write
007416     exit
007418     .
007420 
007422 7000-trif-trace section.
007424     if ws-mf-ti-trace-level >= 1
007426       move 71 to ws-mf-ti-msg-nbr
007428       move '7000-trif-trace' to ws-mf-ti-data-rec(1:15)
007430       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007432       move 15 to ws-mf-ti-user-data-len
007434       perform mf-ti-write
007436     end-if
007438     move version                      of lk-trif
007440       to version                      of trif-t
007442     move amb-tp-invocation-mode       of lk-trif
007444       to amb-tp-invocation-mode       of trif-t
007446     move amb-tp-psb-scheduled-mode    of lk-trif
007448       to amb-tp-psb-scheduled-mode    of trif-t
007450     move amb-tp-addr-count            of lk-trif
007452       to amb-tp-addr-count            of trif-t
007454     move amb-tp-calling-program-id    of lk-trif
007456       to amb-tp-calling-program-id    of trif-t
007458     move amb-tp-filler-28             of lk-trif
007460       to amb-tp-filler-28             of trif-t
007462     move struclen                     of lk-trif
007464       to struclen                     of trif-t
007466     set  this-pntr                    of trif-t
007468       to this-pntr                    of lk-trif
007470     move ebiz-name                    of lk-trif
007472       to ebiz-name                    of trif-t
007474     move upgm-name                    of lk-trif
007476       to upgm-name                    of trif-t
007478     move copybook-mode                of lk-trif
007480       to copybook-mode                of trif-t
007482     move useridx                      of lk-trif
007484       to useridx                      of trif-t
007486     move trace-level                  of lk-trif
007488       to trace-level                  of trif-t
007490     move trace-queue-name             of lk-trif
007492       to trace-queue-name             of trif-t
007494     set  to-upgm-bfr-pntr             of trif-t
007496       to to-upgm-bfr-pntr             of lk-trif
007498     move to-upgm-bfr-full-lenf        of lk-trif
007500       to to-upgm-bfr-full-lenf        of trif-t
007502     move to-upgm-bfr-used-lenf        of lk-trif
007504       to to-upgm-bfr-used-lenf        of trif-t
007506     set  from-upgm-bfr-pntr           of trif-t
007508       to from-upgm-bfr-pntr           of lk-trif
007510     move from-upgm-bfr-full-lenf      of lk-trif
007512       to from-upgm-bfr-full-lenf      of trif-t
007514     move from-upgm-bfr-used-lenf      of lk-trif
007516       to from-upgm-bfr-used-lenf      of trif-t
007518     move from-upgm-processing-mode    of lk-trif
007520       to from-upgm-processing-mode    of trif-t
007522     move from-upgm-abend-code         of lk-trif
007524       to from-upgm-abend-code         of trif-t
007526     move from-upgm-abend-program      of lk-trif
007528       to from-upgm-abend-program      of trif-t
007530     move from-upgm-return-code        of lk-trif
007532       to from-upgm-return-code        of trif-t
007534     move from-upgm-reason             of lk-trif
007536       to from-upgm-reason             of trif-t
007538     move from-upgm-msg                of lk-trif
007540       to from-upgm-msg                of trif-t
007542     move amb-tp-addr-table            of lk-trif
007544       to amb-tp-addr-table            of trif-t
007546     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
007548       to address                      of ws-trif-t
007550     move seventy-five                 of ws-static-fields
007552       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
007554     move length                       of ws-trif-t
007556       to ws-mf-ti-user-data-len       of ws-mf-ti-record
007558     perform mf-ti-write
007560     exit
007562     .
007564 
007566 7000-asktime-trace section.
007568     if ws-mf-ti-trace-level >= 1
007570       move 71 to ws-mf-ti-msg-nbr
007572       move '7000-asktime-trace' to ws-mf-ti-data-rec(1:18)
007574       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007576       move 18 to ws-mf-ti-user-data-len
007578       perform mf-ti-write
007580     end-if
007582     move asktime-resp                 of ws-asktime-misc
007584       to asktime-resp                 of ws-asktime-t
007586     move asktime-resp2                of ws-asktime-misc
007588       to asktime-resp2                of ws-asktime-t
007590     move asktime-abstime              of ws-asktime-misc
007592       to asktime-abstime              of ws-asktime-t
007594     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
007596       to address                      of ws-asktime-t
007598     move seventy-five                 of ws-static-fields
007600       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
007602     move length                       of ws-asktime-t
007604       to ws-mf-ti-user-data-len       of ws-mf-ti-record
007606     perform mf-ti-write
007608     exit
007610     .
007612 
007614 7000-freemain-trace section.
007616     if ws-mf-ti-trace-level >= 1
007618       move 71 to ws-mf-ti-msg-nbr
007620       move '7000-freemain-trace' to ws-mf-ti-data-rec(1:19)
007622       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007624       move 19 to ws-mf-ti-user-data-len
007626       perform mf-ti-write
007628     end-if
007630     if ws-mf-ti-trace-level >= 4
007632       move freemain-resp of ws-freemain-misc to 
007634           ws-mf-ti-num1-disp
007636       move freemain-resp2 of ws-freemain-misc to 
007638           ws-mf-ti-num2-disp
007640       move 1 to ws-mf-ti-string-len
007642       string 'freemain -'
007644              ' resp: ' ws-mf-ti-num1-disp delimited by size
007646              ', resp2: ' ws-mf-ti-num2-disp delimited by size
007648              ', data: ' delimited by size
007650              freemain-data of ws-freemain-misc
007652               delimited by space
007654         into ws-mf-ti-data-rec
007656         with pointer ws-mf-ti-string-len
007658       subtract 1 from ws-mf-ti-string-len
007660       move 75 to ws-mf-ti-msg-nbr
007662       set ws-mf-ti-user-data-pntr
007664         to address of ws-mf-ti-data-rec (1:1)
007666       move ws-mf-ti-string-len to ws-mf-ti-user-data-len
007668       perform mf-ti-write
007670     end-if
007672     exit
007674     .
007676 
007678 7000-formattime-trace section.
007680     if ws-mf-ti-trace-level >= 1
007682       move 71 to ws-mf-ti-msg-nbr
007684       move '7000-formattime-trace' to ws-mf-ti-data-rec(1:21)
007686       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007688       move 21 to ws-mf-ti-user-data-len
007690       perform mf-ti-write
007692     end-if
007694     move formattime-resp              of ws-formattime-misc
007696       to formattime-resp              of ws-formattime-t
007698     move formattime-resp2             of ws-formattime-misc
007700       to formattime-resp2             of ws-formattime-t
007702     move formattime-yyyymmdd          of ws-formattime-misc
007704       to formattime-yyyymmdd          of ws-formattime-t
007706     move formattime-hhmmss            of ws-formattime-misc
007708       to formattime-hhmmss            of ws-formattime-t
007710     move formattime-yyddd             of ws-formattime-misc
007712       to formattime-yyddd             of ws-formattime-t
007714     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
007716       to address                      of ws-formattime-t
007718     move seventy-five                 of ws-static-fields
007720       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
007722     move length                       of ws-formattime-t
007724       to ws-mf-ti-user-data-len       of ws-mf-ti-record
007726     perform mf-ti-write
007728     exit
007730     .
007732 
007734 7000-getmain-trace section.
007736     if ws-mf-ti-trace-level >= 1
007738       move 71 to ws-mf-ti-msg-nbr
007740       move '7000-getmain-trace' to ws-mf-ti-data-rec(1:18)
007742       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007744       move 18 to ws-mf-ti-user-data-len
007746       perform mf-ti-write
007748     end-if
007750     if ws-mf-ti-trace-level >= 4
007752       move getmain-resp of ws-getmain-misc to ws-mf-ti-num1-disp
007754       move getmain-resp2  of ws-getmain-misc to 
007756           ws-mf-ti-num2-disp
007758       move getmain-flength  of ws-getmain-misc to 
007760           getmain-flength-disp
007762       move 1 to ws-mf-ti-string-len
007764       string 'getmain -' delimited by size
007766              ' resp: ' ws-mf-ti-num1-disp delimited by size
007768              ', resp2: ' ws-mf-ti-num2-disp delimited by size
007770              ', flength: ' getmain-flength-disp delimited by size
007772              ', set: '  delimited by size
007774              getmain-set of ws-getmain-misc delimited by space
007776         into ws-mf-ti-data-rec
007778         with pointer ws-mf-ti-string-len
007780       subtract 1 from ws-mf-ti-string-len
007782       move 75 to ws-mf-ti-msg-nbr
007784       set ws-mf-ti-user-data-pntr
007786         to address of ws-mf-ti-data-rec (1:1)
007788       move ws-mf-ti-string-len to ws-mf-ti-user-data-len
007790       perform mf-ti-write
007792     end-if
007794     exit
007796     .
007798 
007800 7000-link-trace section.
007802     if ws-mf-ti-trace-level >= 1
007804       move 71 to ws-mf-ti-msg-nbr
007806       move '7000-link-trace' to ws-mf-ti-data-rec(1:15)
007808       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007810       move 15 to ws-mf-ti-user-data-len
007812       perform mf-ti-write
007814     end-if
007816     if ws-mf-ti-trace-level >= 4
007818       move link-resp of ws-link-misc to ws-mf-ti-num1-disp
007820       move link-resp2 of ws-link-misc to ws-mf-ti-num2-disp
007822       move link-length of ws-link-misc to ws-mf-ti-num3-disp
007824       move 1 to ws-mf-ti-string-len
007826       string 'link ' delimited by size
007828              link-status delimited by space
007830              ', resp: ' ws-mf-ti-num1-disp delimited by size
007832              ', resp2: ' ws-mf-ti-num2-disp delimited by size
007834              ', length: ' ws-mf-ti-num3-disp delimited by size
007836              ', program: '  delimited by size
007838              link-program of ws-link-misc delimited by space
007840              ', commarea: '  delimited by size
007842              link-commarea of ws-link-misc delimited by space
007844         into ws-mf-ti-data-rec
007846         with pointer ws-mf-ti-string-len
007848       subtract 1 from ws-mf-ti-string-len
007850       move 75 to ws-mf-ti-msg-nbr
007852       set ws-mf-ti-user-data-pntr
007854         to address of ws-mf-ti-data-rec (1:1)
007856       move ws-mf-ti-string-len to ws-mf-ti-user-data-len
007858       perform mf-ti-write
007860     end-if
007862     exit
007864     .
007866 
007868 7000-return-trace section.
007870     if ws-mf-ti-trace-level >= 1
007872       move 71 to ws-mf-ti-msg-nbr
007874       move '7000-return-trace' to ws-mf-ti-data-rec(1:17)
007876       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007878       move 17 to ws-mf-ti-user-data-len
007880       perform mf-ti-write
007882     end-if
007884     move return-resp                  of ws-return-misc
007886       to return-resp                  of ws-return-t
007888     move return-resp2                 of ws-return-misc
007890       to return-resp2                 of ws-return-t
007892     set  ws-mf-ti-user-data-pntr      of ws-mf-ti-record
007894       to address                      of ws-return-t
007896     move seventy-five                 of ws-static-fields
007898       to ws-mf-ti-msg-nbr             of ws-mf-ti-record
007900     move length                       of ws-return-t
007902       to ws-mf-ti-user-data-len       of ws-mf-ti-record
007904     perform mf-ti-write
007906     exit
007908     .
007910 
007912 7000-mqclose-trace section.
007914     if ws-mf-ti-trace-level >= 1
007916       move 71 to ws-mf-ti-msg-nbr
007918       move '7000-mqclose-trace' to ws-mf-ti-data-rec(1:18)
007920       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
007922       move 18 to ws-mf-ti-user-data-len
007924       perform mf-ti-write
007926     end-if
007928     if ws-mf-ti-trace-level >= 4
007930       move mqclose-hconn of ws-mqclose-misc to 
007932           ws-mf-ti-handle1-disp
007934       move mqclose-options of ws-mqclose-misc to 
007936           ws-mf-ti-num1-disp
007938       move mqclose-q-handle of ws-mqclose-misc to 
007940           ws-mf-ti-handle2-disp
007942       move mqclose-comp-code of ws-mqclose-misc to 
007944           ws-mf-ti-num2-disp
007946       move mqclose-reason of ws-mqclose-misc to 
007948           ws-mf-ti-num3-disp
007950       move 1 to ws-mf-ti-string-len
007952       string 'mqclose -'
007954              ' hconn: ' ws-mf-ti-handle1-disp
007956              ', options: ' ws-mf-ti-num1-disp
007958              ', handle: ' ws-mf-ti-handle2-disp
007960              ', compcode: ' ws-mf-ti-num2-disp
007962              ', reason: ' ws-mf-ti-num3-disp
007964              delimited by size
007966         into ws-mf-ti-data-rec
007968         with pointer ws-mf-ti-string-len
007970       subtract 1 from ws-mf-ti-string-len
007972       move 75 to ws-mf-ti-msg-nbr
007974       set ws-mf-ti-user-data-pntr
007976         to address of ws-mf-ti-data-rec (1:1)
007978       move ws-mf-ti-string-len to ws-mf-ti-user-data-len
007980       perform mf-ti-write
007982     end-if
007984     exit
007986     .
007988 
007990 7000-mqget-trace section.
007992     if ws-mf-ti-trace-level >= 1
007994       move 71 to ws-mf-ti-msg-nbr
007996       move '7000-mqget-trace' to ws-mf-ti-data-rec(1:16)
007998       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008000       move 16 to ws-mf-ti-user-data-len
008002       perform mf-ti-write
008004     end-if
008006     if ws-mf-ti-trace-level >= 4
008008       move mqget-hconn of ws-mqget-misc to ws-mf-ti-handle1-disp
008010       move mqget-q-handle of ws-mqget-misc to 
008012           ws-mf-ti-handle2-disp
008014       move mqget-comp-code of ws-mqget-misc to ws-mf-ti-num2-disp
008016       move mqget-reason of ws-mqget-misc to ws-mf-ti-num3-disp
008018       move mqget-buffer-lenf of ws-mqget-misc to 
008020           ws-mf-ti-length-1-disp
008022       move mqget-data-lenf of ws-mqget-misc to 
008024           ws-mf-ti-length-2-disp
008026       move 1 to ws-mf-ti-string-len
008028       string 'mqget -'
008030              ' hconn: ' ws-mf-ti-handle1-disp
008032              ', handle: ' ws-mf-ti-handle2-disp
008034              ', buffer length: ' ws-mf-ti-length-1-disp
008036              ', data length: ' ws-mf-ti-length-2-disp
008038              ', compcode: ' ws-mf-ti-num2-disp
008040              ', reason: ' ws-mf-ti-num3-disp
008042              delimited by size
008044         into ws-mf-ti-data-rec
008046         with pointer ws-mf-ti-string-len
008048       subtract 1 from ws-mf-ti-string-len
008050       move 75 to ws-mf-ti-msg-nbr
008052       set ws-mf-ti-user-data-pntr
008054         to address of ws-mf-ti-data-rec (1:1)
008056       move ws-mf-ti-string-len to ws-mf-ti-user-data-len
008058       perform mf-ti-write
008060     end-if
008062     exit
008064     .
008066 
008068 7000-mqopen-trace section.
008070     if ws-mf-ti-trace-level >= 1
008072       move 71 to ws-mf-ti-msg-nbr
008074       move '7000-mqopen-trace' to ws-mf-ti-data-rec(1:17)
008076       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008078       move 17 to ws-mf-ti-user-data-len
008080       perform mf-ti-write
008082     end-if
008084     if ws-mf-ti-trace-level >= 4
008086       move mqopen-hconn of ws-mqopen-misc to 
008088           ws-mf-ti-handle1-disp
008090       move mqopen-options of ws-mqopen-misc to ws-mf-ti-num1-disp
008092       move mqopen-q-handle of ws-mqopen-misc to 
008094           ws-mf-ti-handle2-disp
008096       move mqopen-comp-code of ws-mqopen-misc to 
008098           ws-mf-ti-num2-disp
008100       move mqopen-reason of ws-mqopen-misc to ws-mf-ti-num3-disp
008102       move 1 to ws-mf-ti-string-len
008104       string 'mqopen -'
008106              ' hconn: ' ws-mf-ti-handle1-disp
008108              ', options: ' ws-mf-ti-num1-disp
008110              ', handle: ' ws-mf-ti-handle2-disp
008112              ', compcode: ' ws-mf-ti-num2-disp
008114              ', reason: ' ws-mf-ti-num3-disp
008116              delimited by size
008118         into ws-mf-ti-data-rec
008120         with pointer ws-mf-ti-string-len
008122       subtract 1 from ws-mf-ti-string-len
008124       move 75 to ws-mf-ti-msg-nbr
008126       set ws-mf-ti-user-data-pntr
008128         to address of ws-mf-ti-data-rec (1:1)
008130       move ws-mf-ti-string-len to ws-mf-ti-user-data-len
008132       perform mf-ti-write
008134     end-if
008136     exit
008138     .
008140 
008142 7000-mqput1-trace section.
008144     if ws-mf-ti-trace-level >= 1
008146       move 71 to ws-mf-ti-msg-nbr
008148       move '7000-mqput1-trace' to ws-mf-ti-data-rec(1:17)
008150       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008152       move 17 to ws-mf-ti-user-data-len
008154       perform mf-ti-write
008156     end-if
008158     if ws-mf-ti-trace-level >= 4
008160       move mqput1-hconn of ws-mqput1-misc to 
008162           ws-mf-ti-handle1-disp
008164       move mqput1-buffer-lenf of ws-mqput1-misc to 
008166           getmain-flength-disp
008168       move mqput1-comp-code of ws-mqput1-misc to 
008170           ws-mf-ti-num1-disp
008172       move mqput1-reason of ws-mqput1-misc to ws-mf-ti-num2-disp
008174       move 1 to ws-mf-ti-string-len
008176       string 'mqput1 -'
008178              ' hconn: ' ws-mf-ti-handle1-disp
008180              ', buffer length: ' getmain-flength-disp
008182              ', compcode: ' ws-mf-ti-num1-disp
008184              ', reason: ' ws-mf-ti-num2-disp
008186              delimited by size
008188         into ws-mf-ti-data-rec
008190         with pointer ws-mf-ti-string-len
008192       subtract 1 from ws-mf-ti-string-len
008194       move 75 to ws-mf-ti-msg-nbr
008196       set ws-mf-ti-user-data-pntr
008198         to address of ws-mf-ti-data-rec (1:1)
008200       move ws-mf-ti-string-len to ws-mf-ti-user-data-len
008202       perform mf-ti-write
008204     end-if
008206     exit
008208     .
008210 
008212 7000-to-upgm-bfr-trace section.
008214     if ws-mf-ti-trace-level >= 1
008216       move 71 to ws-mf-ti-msg-nbr
008218       move '7000-to-upgm-bfr-trace' to ws-mf-ti-data-rec(1:22)
008220       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008222       move 22 to ws-mf-ti-user-data-len
008224       perform mf-ti-write
008226     end-if
008228     set  pntr-p
008230       to address                      of lk-to-upgm-bfr
008232     move to-upgm-bfr-used-lenf        of lk-nwif
008234       to ws-mf-ti-length-1-disp
008236     evaluate true
008238       when to-upgm-bfr-used-lenf      of lk-nwif
008240         < 1001
008242         move pntr-x
008244           to addressx                 of ws-to-upgm-bfr-t
008246         move 1
008248           to start-position           of ws-to-upgm-bfr-t
008250         move to-upgm-bfr-used-lenf    of lk-nwif
008252           to end-position             of ws-to-upgm-bfr-t
008254         move to-upgm-bfr-used-lenf    of lk-nwif
008256           to full-length              of ws-to-upgm-bfr-t
008258         move length                   of ws-to-upgm-bfr-t
008260           to ws-mf-ti-user-data-len   of ws-mf-ti-record
008262         set  ws-mf-ti-user-data-pntr  of ws-mf-ti-record
008264           to address                  of ws-to-upgm-bfr-t
008266         perform mf-ti-write
008268         move to-upgm-bfr-used-lenf    of lk-nwif
008270           to ws-mf-ti-user-data-len   of ws-mf-ti-record
008272         set  ws-mf-ti-user-data-pntr  of ws-mf-ti-record
008274           to address                  of lk-to-upgm-bfr
008276         move seventy-five             of ws-static-fields
008278           to ws-mf-ti-msg-nbr
008280         perform mf-ti-write
008282       when other
008284         move 1
008286           to offset-1                 of ws-misc-fields
008288         move pntr-x
008290           to addressx                 of ws-to-upgm-bfr-t
008292         move 1
008294           to start-position           of ws-to-upgm-bfr-t
008296         move 1000
008298           to end-position             of ws-to-upgm-bfr-t
008300         move to-upgm-bfr-used-lenf    of lk-nwif
008302           to full-length              of ws-to-upgm-bfr-t
008304         move seventy-five             of ws-static-fields
008306           to ws-mf-ti-msg-nbr         of ws-mf-ti-record
008308         move length                   of ws-to-upgm-bfr-t
008310           to ws-mf-ti-user-data-len   of ws-mf-ti-record
008312         set  ws-mf-ti-user-data-pntr  of ws-mf-ti-record
008314           to address                  of ws-to-upgm-bfr-t
008316         perform mf-ti-write
008318         move 1000
008320           to ws-mf-ti-user-data-len   of ws-mf-ti-record
008322         set  ws-mf-ti-user-data-pntr  of ws-mf-ti-record
008324           to address                  of lk-to-upgm-bfr
008326         move seventy-five             of ws-static-fields
008328           to ws-mf-ti-msg-nbr         of ws-mf-ti-record
008330         perform mf-ti-write
008332         compute offset-1              of ws-misc-fields
008334           = to-upgm-bfr-used-lenf     of lk-nwif
008336           - 999
008338         set pntr-p
008340           to address                  of lk-to-upgm-bfr(
008342              offset-1                 of ws-misc-fields:1)
008344         move pntr-x
008346           to addressx                 of ws-to-upgm-bfr-t
008348         move offset-1                 of ws-misc-fields
008350           to start-position           of ws-to-upgm-bfr-t
008352         move to-upgm-bfr-used-lenf    of lk-nwif
008354           to end-position             of ws-to-upgm-bfr-t
008356         move to-upgm-bfr-used-lenf    of lk-nwif
008358           to full-length              of ws-to-upgm-bfr-t
008360         move seventy-five             of ws-static-fields
008362           to ws-mf-ti-msg-nbr         of ws-mf-ti-record
008364         move length                   of ws-to-upgm-bfr-t
008366           to ws-mf-ti-user-data-len   of ws-mf-ti-record
008368         set  ws-mf-ti-user-data-pntr  of ws-mf-ti-record
008370           to address                  of ws-to-upgm-bfr-t
008372         perform mf-ti-write
008374         move 1000
008376           to ws-mf-ti-user-data-len   of ws-mf-ti-record
008378         set  ws-mf-ti-user-data-pntr  of ws-mf-ti-record
008380           to address                  of lk-to-upgm-bfr
008382              (offset-1                of ws-misc-fields:1)
008384         perform mf-ti-write
008386     end-evaluate
008388     exit
008390     .
008392 
008394 7000-from-upgm-bfr-trace section.
008396     if ws-mf-ti-trace-level >= 1
008398       move 71 to ws-mf-ti-msg-nbr
008400       move '7000-from-upgm-bfr-trace' to ws-mf-ti-data-rec(1:24)
008402       set ws-mf-ti-user-data-pntr to address of ws-mf-ti-data-rec
008404       move 24 to ws-mf-ti-user-data-len
008406       perform mf-ti-write
008408     end-if
008410     set  pntr-p
008412       to address                      of lk-from-upgm-bfr
008414     move from-upgm-bfr-used-lenf      of lk-nwif
008416       to ws-mf-ti-length-1-disp
008418     evaluate true
008420       when from-upgm-bfr-used-lenf    of lk-nwif
008422         < 1001
008424         move pntr-x
008426           to addressx                 of ws-from-upgm-bfr-t
008428         move 1
008430           to start-position           of ws-from-upgm-bfr-t
008432         move from-upgm-bfr-used-lenf  of lk-nwif
008434           to end-position             of ws-from-upgm-bfr-t
008436         move from-upgm-bfr-used-lenf  of lk-nwif
008438           to full-length              of ws-from-upgm-bfr-t
008440         move length                   of ws-from-upgm-bfr-t
008442           to ws-mf-ti-user-data-len   of ws-mf-ti-record
008444         set  ws-mf-ti-user-data-pntr  of ws-mf-ti-record
008446           to address                  of ws-from-upgm-bfr-t
008448         perform mf-ti-write
008450         move from-upgm-bfr-used-lenf  of lk-nwif
008452           to ws-mf-ti-user-data-len   of ws-mf-ti-record
008454         set  ws-mf-ti-user-data-pntr  of ws-mf-ti-record
008456           to address                  of lk-from-upgm-bfr
008458         move seventy-five             of ws-static-fields
008460           to ws-mf-ti-msg-nbr         of ws-mf-ti-record
008462         perform mf-ti-write
008464       when other
008466         move 1
008468           to offset-1                 of ws-misc-fields
008470         move pntr-x
008472           to addressx                 of ws-from-upgm-bfr-t
008474         move 1
008476           to start-position           of ws-from-upgm-bfr-t
008478         move 1000
008480           to end-position             of ws-from-upgm-bfr-t
008482         move from-upgm-bfr-used-lenf  of lk-nwif
008484           to full-length              of ws-from-upgm-bfr-t
008486         move seventy-five             of ws-static-fields
008488           to ws-mf-ti-msg-nbr         of ws-mf-ti-record
008490         move length                   of ws-from-upgm-bfr-t
008492           to ws-mf-ti-user-data-len   of ws-mf-ti-record
008494         set  ws-mf-ti-user-data-pntr  of ws-mf-ti-record
008496           to address                  of ws-from-upgm-bfr-t
008498         perform mf-ti-write
008500         move 1000
008502           to ws-mf-ti-user-data-len   of ws-mf-ti-record
008504         set  ws-mf-ti-user-data-pntr  of ws-mf-ti-record
008506           to address                  of lk-from-upgm-bfr
008508         move seventy-five             of ws-static-fields
008510           to ws-mf-ti-msg-nbr         of ws-mf-ti-record
008512         perform mf-ti-write
008514         compute offset-1              of ws-misc-fields
008516           = from-upgm-bfr-used-lenf   of lk-nwif
008518           - 999
008520         set pntr-p
008522           to address                  of lk-from-upgm-bfr(
008524              offset-1                 of ws-misc-fields:1)
008526         move pntr-x
008528           to addressx                 of ws-from-upgm-bfr-t
008530         move offset-1                 of ws-misc-fields
008532           to start-position           of ws-from-upgm-bfr-t
008534         move from-upgm-bfr-used-lenf  of lk-nwif
008536           to end-position             of ws-from-upgm-bfr-t
008538         move from-upgm-bfr-used-lenf  of lk-nwif
008540           to full-length              of ws-from-upgm-bfr-t
008542         move seventy-five             of ws-static-fields
008544           to ws-mf-ti-msg-nbr         of ws-mf-ti-record
008546         move length                   of ws-from-upgm-bfr-t
008548           to ws-mf-ti-user-data-len   of ws-mf-ti-record
008550         set  ws-mf-ti-user-data-pntr  of ws-mf-ti-record
008552           to address                  of ws-from-upgm-bfr-t
008554         perform mf-ti-write
008556         move 1000
008558           to ws-mf-ti-user-data-len   of ws-mf-ti-record
008560         set  ws-mf-ti-user-data-pntr  of ws-mf-ti-record
008562           to address                  of lk-from-upgm-bfr
008564              (offset-1                of ws-misc-fields:1)
008566         perform mf-ti-write
008568     end-evaluate
008570     exit
008572     .
008574 ebiz-footprint-request-check section.
008576     move 0 to ws-footprint-rulefile-ctr
008578     move 84 to ws-footprint-pos
008580     move 'generated:   2022-04-20 23:04:10'
008582       to dfhcommarea (ws-footprint-pos:80)
008584     add 80 to ws-footprint-pos
008586     add 1 to ws-footprint-rulefile-ctr
008588     move 'mer0mq03.igl 2019-02-08 13:14:37          949994'
008590        to ws-footprint-rulefile (ws-footprint-rulefile-ctr)
008592     move ws-footprint-rulefile (ws-footprint-rulefile-ctr)
008594         to dfhcommarea( ws-footprint-pos:80)
008596     add 80 to ws-footprint-pos
008598     add 1 to ws-footprint-rulefile-ctr
008600     move 'mersetup.igl 2015-12-08 13:52:44          727343'
008602        to ws-footprint-rulefile (ws-footprint-rulefile-ctr)
008604     move ws-footprint-rulefile (ws-footprint-rulefile-ctr)
008606         to dfhcommarea( ws-footprint-pos:80)
008608     add 80 to ws-footprint-pos
008610     add 1 to ws-footprint-rulefile-ctr
008612     move 'merfoot.igl  2019-02-08 13:14:37          949994'
008614        to ws-footprint-rulefile (ws-footprint-rulefile-ctr)
008616     move ws-footprint-rulefile (ws-footprint-rulefile-ctr)
008618         to dfhcommarea( ws-footprint-pos:80)
008620     add 80 to ws-footprint-pos
008622     add 1 to ws-footprint-rulefile-ctr
008624     move 'release.igl  2019-02-12 16:12:34          950598'
008626        to ws-footprint-rulefile (ws-footprint-rulefile-ctr)
008628     move ws-footprint-rulefile (ws-footprint-rulefile-ctr)
008630         to dfhcommarea( ws-footprint-pos:80)
008632     add 80 to ws-footprint-pos
008634     add 1 to ws-footprint-rulefile-ctr
008636     move 'merntrac.igl 2018-12-09 18:44:39          727692'
008638        to ws-footprint-rulefile (ws-footprint-rulefile-ctr)
008640     move ws-footprint-rulefile (ws-footprint-rulefile-ctr)
008642         to dfhcommarea( ws-footprint-pos:80)
008644     add 80 to ws-footprint-pos
008646     add 1 to ws-footprint-rulefile-ctr
008648     move 'mer0macs.igl 2019-02-08 13:14:37          949994'
008650        to ws-footprint-rulefile (ws-footprint-rulefile-ctr)
008652     move ws-footprint-rulefile (ws-footprint-rulefile-ctr)
008654         to dfhcommarea( ws-footprint-pos:80)
008656     add 80 to ws-footprint-pos
008658     move 83 to ws-footprint-pos
008660     move ws-footprint(17:)
008662         to dfhcommarea(1:ws-footprint-pos)
008664     exec cics return
008666     end-exec
008668     exit
008670     .
